<!DOCTYPE html>
<!-- saved from url=(0039)https://www.zhihu.com/question/34652589 -->
<html lang="zh" data-hairline="true" data-theme="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="google-site-verification" content="FTeR0c8arOPKh8c5DYh_9uu98_zJbaWw53J-Sch9MTg"><meta data-react-helmet="true" name="description" property="og:description" content="app程序入口中为主线程准备好了消息队列而根据Looper.loop()源码可知里面是一个死循环在遍历消息队列取消…"><link rel="shortcut icon" type="image/x-icon" href="https://static.zhihu.com/static/favicon.ico"><link rel="search" type="application/opensearchdescription+xml" href="https://static.zhihu.com/static/search.xml" title="知乎"><link rel="dns-prefetch" href="https://static.zhimg.com/"><link rel="dns-prefetch" href="https://pic1.zhimg.com/"><link rel="dns-prefetch" href="https://pic2.zhimg.com/"><link rel="dns-prefetch" href="https://pic3.zhimg.com/"><link rel="dns-prefetch" href="https://pic4.zhimg.com/"><link href="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/app.317b294b81c6934fdb86.css" rel="stylesheet"><link href="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/question-routes.147cbaba1a2e8238857e.css" rel="stylesheet"><script defer="" crossorigin="anonymous" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/init.js.下载" data-sentry-config="{&quot;dsn&quot;:&quot;https://65e244586890460588f00f2987137aa8@crash2.zhihu.com/193&quot;,&quot;sampleRate&quot;:0.1,&quot;release&quot;:&quot;1966-64235bb1&quot;,&quot;ignoreErrorNames&quot;:[&quot;NetworkError&quot;,&quot;SecurityError&quot;],&quot;ignoreErrors&quot;:[&quot;origin message&quot;,&quot;Network request failed&quot;,&quot;Loading chunk&quot;,&quot;这个系统不支持该功能。&quot;,&quot;Can&#39;t find variable: webkit&quot;,&quot;Can&#39;t find variable: $&quot;,&quot;内存不足&quot;,&quot;out of memory&quot;,&quot;DOM Exception 18&quot;,&quot;The operation is insecure&quot;,&quot;[object Event]&quot;,&quot;[object FileError]&quot;,&quot;[object DOMError]&quot;,&quot;[object Object]&quot;,&quot;拒绝访问。&quot;,&quot;Maximum call stack size exceeded&quot;,&quot;UploadError&quot;,&quot;无法 fetch&quot;,&quot;draft-js&quot;,&quot;缺少 JavaScript 对象&quot;,&quot;componentWillEnter&quot;,&quot;componentWillLeave&quot;,&quot;componentWillAppear&quot;,&quot;getInlineStyleAt&quot;,&quot;getCharacterList&quot;],&quot;whitelistUrls&quot;:[&quot;static.zhihu.com&quot;]}"></script><link rel="stylesheet" type="text/css" href="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/richinput.fcb2b23b621ba0e1867e.css"><script charset="utf-8" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/main.richinput.1de81589d28a5d965ac8.js.下载"></script><link rel="stylesheet" type="text/css" href="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/modals.c93442489f530ff4cf26.css"><script charset="utf-8" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/main.modals.de612a09f7ab29ab2263.js.下载"></script></head><body class="Entry-body"><div id="root"><div data-zop-usertoken="{&quot;urlToken&quot;:&quot;eink-zhih&quot;}"><div class="LoadingBar"></div><div><header role="banner" class="Sticky AppHeader is-fixed" data-za-module="TopNavBar" style="width: 1903px; top: 0px; left: 0px;"><div class="AppHeader-inner"><a href="https://www.zhihu.com/" aria-label="知乎"><svg viewBox="0 0 200 91" class="Icon ZhihuLogo ZhihuLogo--blue Icon--logo" width="64" height="30" aria-hidden="true" style="height: 30px; width: 64px;"><title></title><g><path d="M53.29 80.035l7.32.002 2.41 8.24 13.128-8.24h15.477v-67.98H53.29v67.978zm7.79-60.598h22.756v53.22h-8.73l-8.718 5.473-1.587-5.46-3.72-.012v-53.22zM46.818 43.162h-16.35c.545-8.467.687-16.12.687-22.955h15.987s.615-7.05-2.68-6.97H16.807c1.09-4.1 2.46-8.332 4.1-12.708 0 0-7.523 0-10.085 6.74-1.06 2.78-4.128 13.48-9.592 24.41 1.84-.2 7.927-.37 11.512-6.94.66-1.84.785-2.08 1.605-4.54h9.02c0 3.28-.374 20.9-.526 22.95H6.51c-3.67 0-4.863 7.38-4.863 7.38H22.14C20.765 66.11 13.385 79.24 0 89.62c6.403 1.828 12.784-.29 15.937-3.094 0 0 7.182-6.53 11.12-21.64L43.92 85.18s2.473-8.402-.388-12.496c-2.37-2.788-8.768-10.33-11.496-13.064l-4.57 3.627c1.363-4.368 2.183-8.61 2.46-12.71H49.19s-.027-7.38-2.372-7.38zm128.752-.502c6.51-8.013 14.054-18.302 14.054-18.302s-5.827-4.625-8.556-1.27c-1.874 2.548-11.51 15.063-11.51 15.063l6.012 4.51zm-46.903-18.462c-2.814-2.577-8.096.667-8.096.667s12.35 17.2 12.85 17.953l6.08-4.29s-8.02-11.752-10.83-14.33zM199.99 46.5c-6.18 0-40.908.292-40.953.292v-31.56c1.503 0 3.882-.124 7.14-.376 12.773-.753 21.914-1.25 27.427-1.504 0 0 3.817-8.496-.185-10.45-.96-.37-7.24 1.43-7.24 1.43s-51.63 5.153-72.61 5.64c.5 2.756 2.38 5.336 4.93 6.11 4.16 1.087 7.09.53 15.36.277 7.76-.5 13.65-.76 17.66-.76v31.19h-41.71s.88 6.97 7.97 7.14h33.73v22.16c0 4.364-3.498 6.87-7.65 6.6-4.4.034-8.15-.36-13.027-.566.623 1.24 1.977 4.496 6.035 6.824 3.087 1.502 5.054 2.053 8.13 2.053 9.237 0 14.27-5.4 14.027-14.16V53.93h38.235c3.026 0 2.72-7.432 2.72-7.432z" fill-rule="evenodd"></path></g></svg></a><ul role="navigation" class="Tabs AppHeader-Tabs"><li role="tab" class="Tabs-item AppHeader-Tab Tabs-item--noMeta"><a class="Tabs-link AppHeader-TabsLink" href="https://www.zhihu.com/" data-za-not-track-link="true">首页</a></li><li role="tab" class="Tabs-item AppHeader-Tab Tabs-item--noMeta"><a class="Tabs-link AppHeader-TabsLink" href="https://www.zhihu.com/explore" data-za-not-track-link="true">发现</a></li><li role="tab" class="Tabs-item AppHeader-Tab Tabs-item--noMeta"><a class="Tabs-link AppHeader-TabsLink" href="https://www.zhihu.com/question/waiting" data-za-not-track-link="true">等你来答</a></li></ul><div class="SearchBar" role="search" data-za-module="PresetWordItem"><div class="SearchBar-toolWrapper"><form class="SearchBar-tool"><div><div class="Popover"><div class="SearchBar-input Input-wrapper Input-wrapper--grey"><input type="text" maxlength="100" autocomplete="off" role="combobox" aria-expanded="false" aria-autocomplete="list" aria-activedescendant="AutoComplete6--1" id="Popover5-toggle" aria-haspopup="true" aria-owns="Popover5-content" class="Input" placeholder="人类登月 50 周年" value=""><div class="Input-after"><button aria-label="搜索" type="button" class="Button SearchBar-searchIcon Button--primary"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Search" fill="currentColor" viewBox="0 0 24 24" width="18" height="18"><path d="M17.068 15.58a8.377 8.377 0 0 0 1.774-5.159 8.421 8.421 0 1 0-8.42 8.421 8.38 8.38 0 0 0 5.158-1.774l3.879 3.88c.957.573 2.131-.464 1.488-1.49l-3.879-3.878zm-6.647 1.157a6.323 6.323 0 0 1-6.316-6.316 6.323 6.323 0 0 1 6.316-6.316 6.323 6.323 0 0 1 6.316 6.316 6.323 6.323 0 0 1-6.316 6.316z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></form></div><button type="button" class="Button SearchBar-askButton Button--primary Button--blue">提问</button></div><div class="AppHeader-userInfo"><div class="Popover PushNotifications AppHeader-notifications"><button type="button" id="Popover24-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover24-content" class="Button PushNotifications-icon Button--plain"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Bell" fill="currentColor" viewBox="0 0 24 24" width="22" height="22"><path d="M4.523 15.076l.804-6.757a6.753 6.753 0 0 1 4.945-5.7 1.823 1.823 0 0 1 3.623 0 6.753 6.753 0 0 1 4.945 5.7l.804 6.757a2.293 2.293 0 0 0 1.712 2.108 1.093 1.093 0 0 1-.297 2.15H3.108a1.093 1.093 0 0 1-.297-2.15 2.293 2.293 0 0 0 1.712-2.108zM12.083 23a2.758 2.758 0 0 1-2.753-2.509.229.229 0 0 1 .232-.24h5.043a.229.229 0 0 1 .232.24 2.759 2.759 0 0 1-2.753 2.51z"></path></svg></span></button></div><div><div class="Popover Messages AppHeader-messages"><button type="button" id="Popover25-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover25-content" class="Button Messages-icon Button--plain"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comments" fill="currentColor" viewBox="0 0 24 24" width="22" height="22"><path d="M11 2c5.571 0 9 4.335 9 8 0 6-6.475 9.764-11.481 8.022-.315-.07-.379-.124-.78.078-1.455.54-2.413.921-3.525 1.122-.483.087-.916-.25-.588-.581 0 0 .677-.417.842-1.904.064-.351-.14-.879-.454-1.171A8.833 8.833 0 0 1 2 10c0-3.87 3.394-8 9-8zm10.14 9.628c.758.988.86 2.009.86 3.15 0 1.195-.619 3.11-1.368 3.938-.209.23-.354.467-.308.722.12 1.073.614 1.501.614 1.501.237.239-.188.562-.537.5-.803-.146-1.495-.42-2.546-.811-.29-.146-.336-.106-.563-.057-2.043.711-4.398.475-6.083-.927 5.965-.524 8.727-3.03 9.93-8.016z" fill-rule="evenodd"></path></svg></span><span class="Messages-count">1</span></button></div></div><div class="AppHeader-profile"><div class="Popover AppHeader-menu"><button type="button" id="Popover26-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover26-content" class="Button AppHeader-profileEntry Button--plain"><img class="Avatar AppHeader-profileAvatar" width="30" height="30" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/da8e974dc_is.jpg" srcset="https://pic4.zhimg.com/da8e974dc_im.jpg 2x"></button></div><div class="Popover AppHeaderProfileMenu-creatorHintPopover"><div class="AppHeaderProfileMenu-creatorHintToggler" id="Popover27-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover27-content"></div></div></div></div></div><div class="PageHeader"><div class="QuestionHeader-content"><div class="QuestionHeader-main"><h1 class="QuestionHeader-title">Android中为什么主线程不会因为Looper.loop()里的死循环卡死？</h1></div><div class="QuestionHeader-side" data-za-detail-view-path-module="ToolBar" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Question&quot;,&quot;token&quot;:&quot;34652589&quot;}}}"><div class="QuestionButtonGroup"><button type="button" class="Button FollowButton Button--primary Button--grey">已关注</button><button type="button" class="Button Button--blue"><svg viewBox="0 0 12 12" class="Icon QuestionButton-icon Button-icon Icon--modify" width="14" height="16" aria-hidden="true" style="height: 16px; width: 14px;"><title></title><g><path d="M.423 10.32L0 12l1.667-.474 1.55-.44-2.4-2.33-.394 1.564zM10.153.233c-.327-.318-.85-.31-1.17.018l-.793.817 2.49 2.414.792-.814c.318-.328.312-.852-.017-1.17l-1.3-1.263zM3.84 10.536L1.35 8.122l6.265-6.46 2.49 2.414-6.265 6.46z" fill-rule="evenodd"></path></g></svg>写回答</button></div></div></div></div></header><div class="Sticky--holder" style="position: relative; top: 0px; right: 0px; bottom: 0px; left: 0px; display: block; float: none; margin: 0px; height: 52px;"></div></div><main role="main" class="App-main"><div class="QuestionPage" itemscope="" itemtype="http://schema.org/Question" data-za-detail-view-path-module="QuestionItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Question&quot;,&quot;token&quot;:&quot;34652589&quot;}}}"><meta itemprop="name" content="Android中为什么主线程不会因为Looper.loop()里的死循环卡死？"><meta itemprop="url" content="https://www.zhihu.com/question/34652589"><meta itemprop="keywords" content="Android 开发,Android 开发咨询,Android系统源码"><meta itemprop="answerCount" content="45"><meta itemprop="commentCount" content="1"><meta itemprop="dateCreated" content="2015-08-17T02:17:58.000Z"><meta itemprop="dateModified" content="2015-08-17T03:59:28.000Z"><meta itemprop="zhihu:visitsCount"><meta itemprop="zhihu:followerCount" content="1362"><script type="application/ld+json">
        {
          "@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
          "@id": "https://www.zhihu.com/question/34652589",
          "appid": "否",
          "pubDate": "2015-08-17T10:17:58",
          "upDate": "2015-08-17T11:59:28"
        }</script><div data-zop-question="{&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;topics&quot;:[{&quot;name&quot;:&quot;Android 开发&quot;,&quot;id&quot;:&quot;19555634&quot;},{&quot;name&quot;:&quot;Android 开发咨询&quot;,&quot;id&quot;:&quot;20020270&quot;},{&quot;name&quot;:&quot;Android系统源码&quot;,&quot;id&quot;:&quot;20044980&quot;}],&quot;id&quot;:34652589,&quot;isEditable&quot;:true}"><div class="QuestionStatus"></div><div class="QuestionHeader" data-za-detail-view-path-module="QuestionDescription" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Question&quot;,&quot;token&quot;:&quot;34652589&quot;}}}"><div class="QuestionHeader-content"><div class="QuestionHeader-main"><div class="QuestionHeader-tags"><div class="QuestionHeader-topics"><div class="Tag QuestionTopic" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;19555634&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/19555634" target="_blank"><div class="Popover"><div id="Popover7-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover7-content">Android 开发</div></div></a></span></div><div class="Tag QuestionTopic" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;20020270&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/20020270" target="_blank"><div class="Popover"><div id="Popover8-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover8-content">Android 开发咨询</div></div></a></span></div><div class="Tag QuestionTopic" data-za-detail-view-path-module="TopicItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Topic&quot;,&quot;token&quot;:&quot;20044980&quot;}}}"><span class="Tag-content"><a class="TopicLink" href="https://www.zhihu.com/topic/20044980" target="_blank"><div class="Popover"><div id="Popover9-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover9-content">Android系统源码</div></div></a></span></div></div></div><h1 class="QuestionHeader-title">Android中为什么主线程不会因为Looper.loop()里的死循环卡死？</h1><div><div class="QuestionHeader-detail"><div class="QuestionRichText QuestionRichText--expandable QuestionRichText--collapsed"><div><span class="RichText ztext" itemprop="text">app程序入口中为主线程准备好了消息队列 [图片] 而根据Looper.loop()源码可知里面是一个死循环在遍历消息队列取消息 [图片] 而且并也没看见哪里有相关代码为这个…</span><button type="button" class="Button QuestionRichText-more Button--plain">显示全部<svg viewBox="0 0 10 6" class="Icon QuestionRichText-more-icon Icon--arrow" width="10" height="16" aria-hidden="true" style="height: 16px; width: 10px;"><title></title><g><path d="M8.716.217L5.002 4 1.285.218C.99-.072.514-.072.22.218c-.294.29-.294.76 0 1.052l4.25 4.512c.292.29.77.29 1.063 0L9.78 1.27c.293-.29.293-.76 0-1.052-.295-.29-.77-.29-1.063 0z"></path></g></svg></button></div></div></div></div></div><div class="QuestionHeader-side"><div class="QuestionHeader-follow-status"><div class="QuestionFollowStatus"><div class="NumberBoard QuestionFollowStatus-counts NumberBoard--divider"><button type="button" class="Button NumberBoard-item Button--plain"><div class="NumberBoard-itemInner"><div class="NumberBoard-itemName">关注者</div><strong class="NumberBoard-itemValue" title="1362">1,362</strong></div></button><div class="NumberBoard-item"><div class="NumberBoard-itemInner"><div class="NumberBoard-itemName">被浏览</div><strong class="NumberBoard-itemValue" title="102439">102,439</strong></div></div></div></div></div></div></div><div class="QuestionHeader-footer"><div class="QuestionHeader-footer-inner"><div class="QuestionHeader-main QuestionHeader-footer-main"><div class="QuestionButtonGroup"><button type="button" class="Button FollowButton Button--primary Button--grey">取消关注</button><button type="button" class="Button Button--blue"><svg viewBox="0 0 12 12" class="Icon QuestionButton-icon Button-icon Icon--modify" width="14" height="16" aria-hidden="true" style="height: 16px; width: 14px;"><title></title><g><path d="M.423 10.32L0 12l1.667-.474 1.55-.44-2.4-2.33-.394 1.564zM10.153.233c-.327-.318-.85-.31-1.17.018l-.793.817 2.49 2.414.792-.814c.318-.328.312-.852-.017-1.17l-1.3-1.263zM3.84 10.536L1.35 8.122l6.265-6.46 2.49 2.414-6.265 6.46z" fill-rule="evenodd"></path></g></svg>写回答</button></div><div class="QuestionHeaderActions"><button type="button" class="Button Button--grey Button--withIcon Button--withLabel" style="margin-right: 16px;"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Invite Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M4 10V8a1 1 0 1 1 2 0v2h2a1 1 0 0 1 0 2H6v2a1 1 0 0 1-2 0v-2H2a1 1 0 0 1 0-2h2zm10.455 2c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm-7 6c0-2.66 4.845-4 7.272-4C17.155 14 22 15.34 22 18v1.375c0 .345-.28.625-.625.625H8.08a.625.625 0 0 1-.625-.625V18z" fill-rule="evenodd"></path></svg></span>邀请回答</button><div class="QuestionHeader-Comment"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>1 条评论</button></div><div class="Popover ShareMenu"><div class="ShareMenu-toggler" id="Popover10-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover10-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Report Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M19.947 3.129c-.633.136-3.927.639-5.697.385-3.133-.45-4.776-2.54-9.949-.888-.997.413-1.277 1.038-1.277 2.019L3 20.808c0 .3.101.54.304.718a.97.97 0 0 0 .73.304c.275 0 .519-.102.73-.304.202-.179.304-.418.304-.718v-6.58c4.533-1.235 8.047.668 8.562.864 2.343.893 5.542.008 6.774-.657.397-.178.596-.474.596-.887V3.964c0-.599-.42-.972-1.053-.835z" fill-rule="evenodd"></path></svg></span>举报</button><div class="Popover"><button aria-label="更多" type="button" id="Popover11-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover11-content" class="Button Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div><div class="QuestionHeader-actions"></div></div></div></div></div><div><div><div class="Sticky is-fixed" style="width: 1903px; top: 52px; left: 0px;"></div><div class="Sticky--holder" style="position: static; top: auto; right: auto; bottom: auto; left: auto; display: block; float: none; margin: 0px; height: 0px;"></div></div></div></div><div class="Question-main"><div class="Question-mainColumn"><div><div class="QuestionAnswers-statusWrapper"></div><div id="QuestionAnswers-answers" class="QuestionAnswers-answers" data-zop-feedlistmap="0,0,1,0" data-za-detail-view-path-module="ContentList" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:null}}"><div class="Card AnswersNavWrapper"><div class="ListShortcut"><div class="List"><div class="List-header"><h4 class="List-headerText"><span>45 个回答</span></h4><div class="List-headerOptions"><div class="Popover"><button role="combobox" aria-expanded="false" type="button" id="Popover12-toggle" aria-haspopup="true" aria-owns="Popover12-content" class="Button Select-button Select-plainButton Button--plain">默认排序<span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Select Select-arrow" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M12 16.183l2.716-2.966a.757.757 0 0 1 1.064.001.738.738 0 0 1 0 1.052l-3.247 3.512a.758.758 0 0 1-1.064 0L8.22 14.27a.738.738 0 0 1 0-1.052.758.758 0 0 1 1.063 0L12 16.183zm0-9.365L9.284 9.782a.758.758 0 0 1-1.064 0 .738.738 0 0 1 0-1.052l3.248-3.512a.758.758 0 0 1 1.065 0L15.78 8.73a.738.738 0 0 1 0 1.052.757.757 0 0 1-1.063.001L12 6.818z" fill-rule="evenodd"></path></svg></span></button></div></div></div><div><div class=""><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="0" data-zop="{&quot;authorName&quot;:&quot;Gityuan&quot;,&quot;itemId&quot;:90344494,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="90344494" itemprop="acceptedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="0" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;90344494&quot;,&quot;upvote_num&quot;:992,&quot;comment_num&quot;:66,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;c7de1694c846fe3b95895bc4ccb8df50&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Gityuan"><meta itemprop="image" content="https://pic1.zhimg.com/59e145e8b0d37770ef831324a77ba088_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/gityuan"><meta itemprop="zhihu:followerCount" content="6147"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover13-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover13-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/gityuan"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/59e145e8b0d37770ef831324a77ba088_xs.jpg" srcset="https://pic1.zhimg.com/59e145e8b0d37770ef831324a77ba088_l.jpg 2x" alt="Gityuan"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover14-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover14-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/gityuan">Gityuan</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">http://gityuan.com</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">992 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="992"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/90344494"><meta itemprop="dateCreated" content="2016-03-12T01:18:07.000Z"><meta itemprop="dateModified" content="2016-08-13T07:46:21.000Z"><meta itemprop="commentCount" content="66"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]"><p>要完全彻底理解这个问题，需要准备以下4方面的知识：Process/Thread，Android Binder IPC，Handler/Looper/MessageQueue消息机制，Linux pipe/epoll机制。</p><br><p><b>总结一下楼主主要有3个疑惑：</b></p><p>1.Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ </p><p>2.没看见哪里有相关代码为这个死循环准备了一个新线程去运转？ </p><p>3.Activity的生命周期这些方法这些都是在主线程里执行的吧，那这些生命周期方法是怎么实现在死循环体外能够执行起来的？</p><p>--------------------------------------------------------------------------------------------------------------------------------------<br>针对这些疑惑， <span><span class="UserLink"><div class="Popover"><div id="Popover40-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover40-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/50b28faaec835947511e005cd6734484" data-za-detail-view-id="1045">@hi大头鬼hi</a></div></div></span></span><span><span class="UserLink"><div class="Popover"><div id="Popover41-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover41-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/4897651cf72b010294463a1fd113af52" data-za-detail-view-id="1045">@Rocko</a></div></div></span></span><span><span class="UserLink"><div class="Popover"><div id="Popover42-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover42-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/53013cf8f04bf168814156e563beb935" data-za-detail-view-id="1045">@陈昱全</a></div></div></span></span> 大家回答都比较精炼，接下来我再更进一步详细地一一解答楼主的疑惑：</p><p><b>(1) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ </b></p><p>这里涉及线程，先说说说进程/线程，<b>进程：</b>每个app运行时前首先创建一个进程，该进程是由Zygote fork出来的，用于承载App上运行的各种Activity/Service等组件。进程对于上层应用来说是完全透明的，这也是google有意为之，让App程序都是运行在Android Runtime。大多数情况一个App就运行在一个进程中，除非在AndroidManifest.xml中配置Android:process属性，或通过native代码fork进程。</p><p><b>线程：</b>线程对应用来说非常常见，比如每次new Thread().start都会创建一个新的线程。该线程与App所在进程之间资源共享，从Linux角度来说进程与线程除了是否共享资源外，并没有本质的区别，都是一个task_struct结构体<b>，在CPU看来进程或线程无非就是一段可执行的代码，CPU采用CFS调度算法，保证每个task都尽可能公平的享有CPU时间片</b>。</p><p>有了这么准备，再说说死循环问题：</p><p>对于线程既然是一段可执行的代码，当可执行代码执行完成后，线程生命周期便该终止了，线程退出。而对于主线程，我们是绝不希望会被运行一段时间，自己就退出，那么如何保证能一直存活呢？<b>简单做法就是可执行代码是能一直执行下去的，死循环便能保证不会被退出，</b>例如，binder线程也是采用死循环的方法，通过循环方式不同与Binder驱动进行读写操作，当然并非简单地死循环，无消息时会休眠。但这里可能又引发了另一个问题，既然是死循环又如何去处理其他事务呢？通过创建新线程的方式。</p><p>真正会卡死主线程的操作是在回调方法onCreate/onStart/onResume等操作时间过长，会导致掉帧，甚至发生ANR，looper.loop本身不会导致应用卡死。</p><br><p><b>(2) 没看见哪里有相关代码为这个死循环准备了一个新线程去运转？ </b></p>事实上，会在进入死循环之前便创建了新binder线程，在代码ActivityThread.main()中：<br><div class="highlight"><pre><code class="language-java"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">....</span>

        <span class="c1">//创建Looper和MessageQueue对象，用于处理主线程的消息
</span><span class="c1"></span>        <span class="n">Looper</span><span class="o">.</span><span class="na">prepareMainLooper</span><span class="o">();</span>

        <span class="c1">//创建ActivityThread对象
</span><span class="c1"></span>        <span class="n">ActivityThread</span> <span class="n">thread</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ActivityThread</span><span class="o">();</span> 

        <span class="c1">//建立Binder通道 (创建新线程)
</span><span class="c1"></span>        <span class="n">thread</span><span class="o">.</span><span class="na">attach</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>

        <span class="n">Looper</span><span class="o">.</span><span class="na">loop</span><span class="o">();</span> <span class="c1">//消息循环运行
</span><span class="c1"></span>        <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="s">"Main thread loop unexpectedly exited"</span><span class="o">);</span>
    <span class="o">}</span></code></pre></div><p><b>thread.attach(false)；便会创建一个Binder线程（具体是指ApplicationThread，Binder的服务端，用于接收系统服务AMS发送来的事件），该Binder线程通过Handler将Message发送给主线程</b>，具体过程可查看 <a href="https://link.zhihu.com/?target=http%3A//gityuan.com/2016/03/06/start-service/" class=" wrap external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043">startService流程分析</a>，这里不展开说，简单说Binder用于进程间通信，采用C/S架构。关于binder感兴趣的朋友，可查看我回答的另一个知乎问题：<br><a href="https://www.zhihu.com/question/39440766/answer/89210950" class="internal" data-za-detail-view-id="1043">为什么Android要采用Binder作为IPC机制？ - Gityuan的回答</a></p><p>另外，<b>ActivityThread实际上并非线程</b>，不像HandlerThread类，ActivityThread并没有真正继承Thread类，只是往往运行在主线程，该人以线程的感觉，其实承载ActivityThread的主线程就是由Zygote fork而创建的进程。</p><p><b>主线程的死循环一直运行是不是特别消耗CPU资源呢？ </b>其实不然，这里就涉及到<b>Linux pipe/e</b><b>poll机制</b>，简单说就是在主线程的MessageQueue没有消息时，便阻塞在loop的queue.next()中的nativePollOnce()方法里，详情见<a href="https://link.zhihu.com/?target=http%3A//www.yuanhh.com/2015/12/26/handler-message-framework/%23next" class=" wrap external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043">Android消息机制1-Handler(Java层)</a>，此时主线程会释放CPU资源进入休眠状态，直到下个消息到达或者有事务发生，通过往pipe管道写端写入数据来唤醒主线程工作。这里采用的epoll机制，是一种IO多路复用机制，可以同时监控多个描述符，当某个描述符就绪(读或写就绪)，则立刻通知相应程序进行读或写操作，本质同步I/O，即读写是阻塞的。 <b>所以说，主线程大多数时候都是处于休眠状态，并不会消耗大量CPU资源。</b></p><br><p><b>(3) Activity的生命周期是怎么实现在死循环体外能够执行起来的？</b></p><p>ActivityThread的内部类H继承于Handler，通过handler消息机制，简单说Handler机制用于同一个进程的线程间通信。</p><p><b>Activity的生命周期都是依靠主线程的Looper.loop，当收到不同Message时则采用相应措施：</b><br>在H.handleMessage(msg)方法中，根据接收到不同的msg，执行相应的生命周期。</p><p>    比如收到msg=H.LAUNCH_ACTIVITY，则调用ActivityThread.handleLaunchActivity()方法，最终会通过反射机制，创建Activity实例，然后再执行Activity.onCreate()等方法；<br>    再比如收到msg=H.PAUSE_ACTIVITY，则调用ActivityThread.handlePauseActivity()方法，最终会执行Activity.onPause()等方法。 上述过程，我只挑核心逻辑讲，真正该过程远比这复杂。</p><p><b>主线程的消息又是哪来的呢？</b>当然是App进程中的其他线程通过Handler发送给主线程，请看接下来的内容：</p><br><p>--------------------------------------------------------------------------------------------------------------------------------------<br><b>最后，从进程与线程间通信的角度，</b><b>通过一张图</b><b>加深大家对App运行过程的理解：</b><br></p><figure><noscript>&amp;lt;img src="https://pic4.zhimg.com/50/7fb8728164975ac86a2b0b886de2b872_hd.jpg" data-rawwidth="890" data-rawheight="535" class="origin_image zh-lightbox-thumb" width="890" data-original="https://pic4.zhimg.com/7fb8728164975ac86a2b0b886de2b872_r.jpg"/&amp;gt;</noscript><img src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/7fb8728164975ac86a2b0b886de2b872_hd.jpg" data-rawwidth="890" data-rawheight="535" class="origin_image zh-lightbox-thumb lazy" width="890" data-original="https://pic4.zhimg.com/7fb8728164975ac86a2b0b886de2b872_r.jpg" data-actualsrc="https://pic4.zhimg.com/50/7fb8728164975ac86a2b0b886de2b872_hd.jpg"></figure><br><b>system_server进程是系统进程</b>，java framework框架的核心载体，里面运行了大量的系统服务，比如这里提供ApplicationThreadProxy（简称ATP），ActivityManagerService（简称AMS），这个两个服务都运行在system_server进程的不同线程中，由于ATP和AMS都是基于IBinder接口，都是binder线程，binder线程的创建与销毁都是由binder驱动来决定的。<p></p><p><b>App进程则是我们常说的应用程序</b>，主线程主要负责Activity/Service等组件的生命周期以及UI相关操作都运行在这个线程； 另外，每个App进程中至少会有两个binder线程 ApplicationThread(简称AT)和ActivityManagerProxy（简称AMP），除了图中画的线程，其中还有很多线程，比如signal catcher线程等，这里就不一一列举。</p><p>Binder用于不同进程之间通信，由一个进程的Binder客户端向另一个进程的服务端发送事务，比如图中线程2向线程4发送事务；而handler用于同一个进程中不同线程的通信，比如图中线程4向主线程发送消息。</p><b>结合图说说Activity生命周期，比如暂停Activity，流程如下：</b><br><ol><li>线程1的AMS中调用线程2的ATP；（由于同一个进程的线程间资源共享，可以相互直接调用，但需要注意多线程并发问题）<br></li><li>线程2通过binder传输到App进程的线程4；<br></li><li>线程4通过handler消息机制，将暂停Activity的消息发送给主线程；<br></li><li>主线程在looper.loop()中循环遍历消息，当收到暂停Activity的消息时，便将消息分发给ActivityThread.H.handleMessage()方法，再经过方法的调用，最后便会调用到Activity.onPause()，当onPause()处理完后，继续循环loop下去。<br></li></ol><br><br><p>--------------------------------- <b>欢迎关注我的微博：<a href="https://link.zhihu.com/?target=http%3A//weibo.com/gityuan" class=" wrap external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043">Gityuan</a></b>-----------------------------------------</p><b>如果大家觉得我回答得还行，还请大家随手 点赞、关注、收藏，如果觉得说得不好的，还往评论指正。</b></span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/90344494"><span data-tooltip="发布于 2016-03-12 09:18">编辑于 2016-08-13</span></a></div></div><div><div class="ContentItem-actions Sticky RichContent-actions is-fixed is-bottom" style="width: 694px; bottom: 0px; left: 451.5px;"><span><button aria-label="赞同 992" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 992</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>66 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover494-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover494-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover495-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover495-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div><button data-zop-retract-question="true" type="button" class="Button ContentItem-action ContentItem-rightButton Button--plain"><span class="RichContent-collapsedText">收起</span><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--ArrowDown ContentItem-arrowIcon is-active" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M12 13L8.285 9.218a.758.758 0 0 0-1.064 0 .738.738 0 0 0 0 1.052l4.249 4.512a.758.758 0 0 0 1.064 0l4.246-4.512a.738.738 0 0 0 0-1.052.757.757 0 0 0-1.063 0L12.002 13z" fill-rule="evenodd"></path></svg></span></button></div><div class="Sticky--holder" style="position: static; top: auto; right: auto; bottom: auto; left: auto; display: flex; float: none; margin: 0px -20px -10px; height: 54px; width: 694px;"></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="1" data-zop="{&quot;authorName&quot;:&quot;镰仓&quot;,&quot;itemId&quot;:157834250,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="157834250" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="1" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;157834250&quot;,&quot;upvote_num&quot;:62,&quot;comment_num&quot;:7,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;a68cd1d81f21f09a518ef4070501f892&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="镰仓"><meta itemprop="image" content="https://pic1.zhimg.com/v2-44afe96a0432162b0a30697c93caf7d4_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/yuxiang204"><meta itemprop="zhihu:followerCount" content="503"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover17-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover17-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/yuxiang204"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-44afe96a0432162b0a30697c93caf7d4_xs.jpg" srcset="https://pic1.zhimg.com/v2-44afe96a0432162b0a30697c93caf7d4_l.jpg 2x" alt="镰仓"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover18-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover18-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/yuxiang204">镰仓</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">Android Engineer at Alibaba</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">62 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="62"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/157834250"><meta itemprop="dateCreated" content="2017-04-18T00:50:53.000Z"><meta itemprop="dateModified" content="2017-04-18T00:50:53.000Z"><meta itemprop="commentCount" content="7"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]"><p>简单一句话是：Android应用程序的主线程在进入消息循环过程前，会在内部创建一个Linux管道（Pipe），这个管道的作用是使得Android应用程序主线程在消息队列为空时可以进入空闲等待状态，并且使得当应用程序的消息队列有消息需要处理时唤醒应用程序的主线程。</p><p>---<br>这一题是需要从消息循环、消息发送和消息处理三个部分理解Android应用程序的消息处理机制了，这里我对一些要点作一个总结：</p><p>         A. Android应用程序的消息处理机制由消息循环、消息发送和消息处理三个部分组成的。</p><p>         B. Android应用程序的主线程在进入消息循环过程前，会在内部创建一个Linux管道（Pipe），这个管道的作用是使得Android应用程序主线程在消息队列为空时可以进入空闲等待状态，并且使得当应用程序的消息队列有消息需要处理时唤醒应用程序的主线程。</p><p>         C. Android应用程序的主线程进入空闲等待状态的方式实际上就是在管道的读端等待管道中有新的内容可读，具体来说就是是通过Linux系统的Epoll机制中的epoll_wait函数进行的。</p><p>         D. 当往Android应用程序的消息队列中加入新的消息时，会同时往管道中的写端写入内容，通过这种方式就可以唤醒正在等待消息到来的应用程序主线程。</p>         E. 当应用程序主线程在进入空闲等待前，会认为当前线程处理空闲状态，于是就会调用那些已经注册了的IdleHandler接口，使得应用程序有机会在空闲的时候处理一些事情。</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/157834250"><span data-tooltip="发布于 2017-04-18 08:50">发布于 2017-04-18</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 62" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 62</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>7 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover46-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover46-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover47-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover47-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="2" data-zop="{&quot;authorName&quot;:&quot;Tmacchen&quot;,&quot;itemId&quot;:59571257,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="59571257" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="2" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;59571257&quot;,&quot;upvote_num&quot;:37,&quot;comment_num&quot;:15,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;53013cf8f04bf168814156e563beb935&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Tmacchen"><meta itemprop="image" content="https://pic2.zhimg.com/f720e4bce_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/chen-yu-quan"><meta itemprop="zhihu:followerCount" content="2714"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover28-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover28-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/chen-yu-quan"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/f720e4bce_xs.jpg" srcset="https://pic2.zhimg.com/f720e4bce_l.jpg 2x" alt="Tmacchen"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover29-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover29-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/chen-yu-quan">Tmacchen</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">招人同帮内推腾讯百度，简历请发featureyuquan@gmail.com</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">37 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="37"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/59571257"><meta itemprop="dateCreated" content="2015-08-17T04:03:29.000Z"><meta itemprop="dateModified" content="2016-03-11T03:21:09.000Z"><meta itemprop="commentCount" content="15"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]"><p>了解下linux的epoll你就知道为什么不会被卡住了，先说结论：阻塞是有的，但是不会卡住<br>主要原因有2个</p><p>1，epoll模型<br>当没有消息的时候会epoll.wait，等待句柄写的时候再唤醒，这个时候其实是阻塞的。</p>2，所有的ui操作都通过handler来发消息操作。<br>比如屏幕刷新16ms一个消息，你的各种点击事件，所以就会有句柄写操作，唤醒上文的wait操作，所以不会被卡死了。</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/59571257"><span data-tooltip="发布于 2015-08-17 12:03">编辑于 2016-03-11</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 37" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 37</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>15 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover49-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover49-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover50-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover50-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="3" data-zop="{&quot;authorName&quot;:&quot;Groffa&quot;,&quot;itemId&quot;:59578531,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="59578531" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="3" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;59578531&quot;,&quot;upvote_num&quot;:27,&quot;comment_num&quot;:4,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;324602d46f897dd224ac5c898cd411e1&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Groffa"><meta itemprop="image" content="https://pic1.zhimg.com/8117a23fa8d4a23072b47b96cb391738_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/guo-qi-fa"><meta itemprop="zhihu:followerCount" content="705"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover32-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover32-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/guo-qi-fa"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/8117a23fa8d4a23072b47b96cb391738_xs.jpg" srcset="https://pic1.zhimg.com/8117a23fa8d4a23072b47b96cb391738_l.jpg 2x" alt="Groffa"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover33-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover33-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/guo-qi-fa">Groffa</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">Android</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">27 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="27"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/59578531"><meta itemprop="dateCreated" content="2015-08-17T04:54:43.000Z"><meta itemprop="dateModified" content="2015-08-17T04:54:43.000Z"><meta itemprop="commentCount" content="4"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]"><p>去看下handler机制就明白了，网上一大把。 </p><p>1.handler机制是使用pipe来实现的 </p><p>2.主线程没有消息处理时阻塞在管道的读端 </p><p>3.binder线程会往主线程消息队列里添加消息，然后往管道写端写一个字节，这样就能唤醒主线程从管道读端返回，也就是说queue.next()会调用返回</p>4.dispatchMessage()中调用onCreate, onResume</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/59578531"><span data-tooltip="发布于 2015-08-17 12:54">发布于 2015-08-17</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 27" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 27</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>4 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover54-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover54-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover55-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover55-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="4" data-zop="{&quot;authorName&quot;:&quot;Rocko&quot;,&quot;itemId&quot;:59614987,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="59614987" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="4" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;59614987&quot;,&quot;upvote_num&quot;:38,&quot;comment_num&quot;:4,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;4897651cf72b010294463a1fd113af52&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Rocko"><meta itemprop="image" content="https://pic3.zhimg.com/v2-698df758dbcb346380387c16f9561c8a_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/rocko"><meta itemprop="zhihu:followerCount" content="893"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover36-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover36-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/rocko"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-698df758dbcb346380387c16f9561c8a_xs.jpg" srcset="https://pic3.zhimg.com/v2-698df758dbcb346380387c16f9561c8a_l.jpg 2x" alt="Rocko"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover37-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover37-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/rocko">Rocko</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">https://rocko.xyz</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">38 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="38"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/59614987"><meta itemprop="dateCreated" content="2015-08-17T08:58:49.000Z"><meta itemprop="dateModified" content="2015-08-17T16:54:27.000Z"><meta itemprop="commentCount" content="4"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]"><p>Handler 机制应该基本都知道了，题主点进去源码看下 ActivityThread 就能基本搞明白了，为什么主线程不会因为 Looper.loop() 里的死循环卡死？</p>首先 ActivityThread 并不是一个 Thread，就只是一个 final 类而已。我们常说的主线程就是从这个类的 main 方法开始，main 方法很简短，一眼就能看全，我们看到里面有 Looper 了，那么接下来就<b>找找 ActivityThread 对应的 Handler</b> 啊，就是内部类 H，其继承 Handler，贴出 handleMessage 的小部分：<br><div class="highlight"><pre><code class="language-java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleMessage</span><span class="o">(</span><span class="n">Message</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">DEBUG_MESSAGES</span><span class="o">)</span> <span class="n">Slog</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">"&gt;&gt;&gt; handling: "</span> <span class="o">+</span> <span class="n">codeToString</span><span class="o">(</span><span class="n">msg</span><span class="o">.</span><span class="na">what</span><span class="o">));</span>
            <span class="k">switch</span> <span class="o">(</span><span class="n">msg</span><span class="o">.</span><span class="na">what</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">case</span> <span class="nl">LAUNCH_ACTIVITY:</span> <span class="o">{</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceBegin</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">,</span> <span class="s">"activityStart"</span><span class="o">);</span>
                    <span class="kd">final</span> <span class="n">ActivityClientRecord</span> <span class="n">r</span> <span class="o">=</span> <span class="o">(</span><span class="n">ActivityClientRecord</span><span class="o">)</span> <span class="n">msg</span><span class="o">.</span><span class="na">obj</span><span class="o">;</span>

                    <span class="n">r</span><span class="o">.</span><span class="na">packageInfo</span> <span class="o">=</span> <span class="n">getPackageInfoNoCheck</span><span class="o">(</span>
                            <span class="n">r</span><span class="o">.</span><span class="na">activityInfo</span><span class="o">.</span><span class="na">applicationInfo</span><span class="o">,</span> <span class="n">r</span><span class="o">.</span><span class="na">compatInfo</span><span class="o">);</span>
                    <span class="n">handleLaunchActivity</span><span class="o">(</span><span class="n">r</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceEnd</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="nl">RELAUNCH_ACTIVITY:</span> <span class="o">{</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceBegin</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">,</span> <span class="s">"activityRestart"</span><span class="o">);</span>
                    <span class="n">ActivityClientRecord</span> <span class="n">r</span> <span class="o">=</span> <span class="o">(</span><span class="n">ActivityClientRecord</span><span class="o">)</span><span class="n">msg</span><span class="o">.</span><span class="na">obj</span><span class="o">;</span>
                    <span class="n">handleRelaunchActivity</span><span class="o">(</span><span class="n">r</span><span class="o">);</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceEnd</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="nl">PAUSE_ACTIVITY:</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceBegin</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">,</span> <span class="s">"activityPause"</span><span class="o">);</span>
                    <span class="n">handlePauseActivity</span><span class="o">((</span><span class="n">IBinder</span><span class="o">)</span><span class="n">msg</span><span class="o">.</span><span class="na">obj</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="o">(</span><span class="n">msg</span><span class="o">.</span><span class="na">arg1</span><span class="o">&amp;</span><span class="n">1</span><span class="o">)</span> <span class="o">!=</span> <span class="n">0</span><span class="o">,</span> <span class="n">msg</span><span class="o">.</span><span class="na">arg2</span><span class="o">,</span>
                            <span class="o">(</span><span class="n">msg</span><span class="o">.</span><span class="na">arg1</span><span class="o">&amp;</span><span class="n">2</span><span class="o">)</span> <span class="o">!=</span> <span class="n">0</span><span class="o">);</span>
                    <span class="n">maybeSnapshot</span><span class="o">();</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceEnd</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">);</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="nl">PAUSE_ACTIVITY_FINISHING:</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceBegin</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">,</span> <span class="s">"activityPause"</span><span class="o">);</span>
                    <span class="n">handlePauseActivity</span><span class="o">((</span><span class="n">IBinder</span><span class="o">)</span><span class="n">msg</span><span class="o">.</span><span class="na">obj</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="o">(</span><span class="n">msg</span><span class="o">.</span><span class="na">arg1</span><span class="o">&amp;</span><span class="n">1</span><span class="o">)</span> <span class="o">!=</span> <span class="n">0</span><span class="o">,</span> <span class="n">msg</span><span class="o">.</span><span class="na">arg2</span><span class="o">,</span>
                            <span class="o">(</span><span class="n">msg</span><span class="o">.</span><span class="na">arg1</span><span class="o">&amp;</span><span class="n">1</span><span class="o">)</span> <span class="o">!=</span> <span class="n">0</span><span class="o">);</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceEnd</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">);</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="nl">STOP_ACTIVITY_SHOW:</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceBegin</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">,</span> <span class="s">"activityStop"</span><span class="o">);</span>
                    <span class="n">handleStopActivity</span><span class="o">((</span><span class="n">IBinder</span><span class="o">)</span><span class="n">msg</span><span class="o">.</span><span class="na">obj</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">msg</span><span class="o">.</span><span class="na">arg2</span><span class="o">);</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceEnd</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">);</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="nl">STOP_ACTIVITY_HIDE:</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceBegin</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">,</span> <span class="s">"activityStop"</span><span class="o">);</span>
                    <span class="n">handleStopActivity</span><span class="o">((</span><span class="n">IBinder</span><span class="o">)</span><span class="n">msg</span><span class="o">.</span><span class="na">obj</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">msg</span><span class="o">.</span><span class="na">arg2</span><span class="o">);</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceEnd</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">);</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="nl">SHOW_WINDOW:</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceBegin</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">,</span> <span class="s">"activityShowWindow"</span><span class="o">);</span>
                    <span class="n">handleWindowVisibility</span><span class="o">((</span><span class="n">IBinder</span><span class="o">)</span><span class="n">msg</span><span class="o">.</span><span class="na">obj</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceEnd</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">);</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="nl">HIDE_WINDOW:</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceBegin</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">,</span> <span class="s">"activityHideWindow"</span><span class="o">);</span>
                    <span class="n">handleWindowVisibility</span><span class="o">((</span><span class="n">IBinder</span><span class="o">)</span><span class="n">msg</span><span class="o">.</span><span class="na">obj</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceEnd</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">);</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="nl">RESUME_ACTIVITY:</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceBegin</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">,</span> <span class="s">"activityResume"</span><span class="o">);</span>
                    <span class="n">handleResumeActivity</span><span class="o">((</span><span class="n">IBinder</span><span class="o">)</span> <span class="n">msg</span><span class="o">.</span><span class="na">obj</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="n">msg</span><span class="o">.</span><span class="na">arg1</span> <span class="o">!=</span> <span class="n">0</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceEnd</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">);</span>
                    <span class="k">break</span><span class="o">;</span>
                <span class="k">case</span> <span class="nl">SEND_RESULT:</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceBegin</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">,</span> <span class="s">"activityDeliverResult"</span><span class="o">);</span>
                    <span class="n">handleSendResult</span><span class="o">((</span><span class="n">ResultData</span><span class="o">)</span><span class="n">msg</span><span class="o">.</span><span class="na">obj</span><span class="o">);</span>
                    <span class="n">Trace</span><span class="o">.</span><span class="na">traceEnd</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">);</span>
                    <span class="k">break</span><span class="o">;</span>

            <span class="o">...........</span>
<span class="o">}</span>
</code></pre></div><br><br><p>看完这 Handler 里处理消息的内容应该明白了吧， Activity 的生命周期都有对应的 case 条件了，ActivityThread 有个 getHandler 方法，得到这个 handler 就可以发送消息，然后 loop 里就分发消息，然后就发给 handler, 然后就执行到 H（Handler ）里的对应代码。所以这些代码就不会卡死～，有消息过来就能执行。举个例子，在 ActivityThread 里的内部类 ApplicationThread 中就有很多 sendMessage 的方法：</p><br><div class="highlight"><pre><code class="language-java"><span class="o">......</span>
<span class="kd">public</span> <span class="kd">final</span> <span class="kt">void</span> <span class="nf">schedulePauseActivity</span><span class="o">(</span><span class="n">IBinder</span> <span class="n">token</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">finished</span><span class="o">,</span>
                <span class="kt">boolean</span> <span class="n">userLeaving</span><span class="o">,</span> <span class="kt">int</span> <span class="n">configChanges</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">dontReport</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">sendMessage</span><span class="o">(</span>
                    <span class="n">finished</span> <span class="o">?</span> <span class="n">H</span><span class="o">.</span><span class="na">PAUSE_ACTIVITY_FINISHING</span> <span class="o">:</span> <span class="n">H</span><span class="o">.</span><span class="na">PAUSE_ACTIVITY</span><span class="o">,</span>
                    <span class="n">token</span><span class="o">,</span>
                    <span class="o">(</span><span class="n">userLeaving</span> <span class="o">?</span> <span class="n">1</span> <span class="o">:</span> <span class="n">0</span><span class="o">)</span> <span class="o">|</span> <span class="o">(</span><span class="n">dontReport</span> <span class="o">?</span> <span class="n">2</span> <span class="o">:</span> <span class="n">0</span><span class="o">),</span>
                    <span class="n">configChanges</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kd">final</span> <span class="kt">void</span> <span class="nf">scheduleStopActivity</span><span class="o">(</span><span class="n">IBinder</span> <span class="n">token</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">showWindow</span><span class="o">,</span>
                <span class="kt">int</span> <span class="n">configChanges</span><span class="o">)</span> <span class="o">{</span>
           <span class="n">sendMessage</span><span class="o">(</span>
                <span class="n">showWindow</span> <span class="o">?</span> <span class="n">H</span><span class="o">.</span><span class="na">STOP_ACTIVITY_SHOW</span> <span class="o">:</span> <span class="n">H</span><span class="o">.</span><span class="na">STOP_ACTIVITY_HIDE</span><span class="o">,</span>
                <span class="n">token</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="n">configChanges</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kd">final</span> <span class="kt">void</span> <span class="nf">scheduleWindowVisibility</span><span class="o">(</span><span class="n">IBinder</span> <span class="n">token</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">showWindow</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">sendMessage</span><span class="o">(</span>
                <span class="n">showWindow</span> <span class="o">?</span> <span class="n">H</span><span class="o">.</span><span class="na">SHOW_WINDOW</span> <span class="o">:</span> <span class="n">H</span><span class="o">.</span><span class="na">HIDE_WINDOW</span><span class="o">,</span>
                <span class="n">token</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kd">final</span> <span class="kt">void</span> <span class="nf">scheduleSleeping</span><span class="o">(</span><span class="n">IBinder</span> <span class="n">token</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">sleeping</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">sendMessage</span><span class="o">(</span><span class="n">H</span><span class="o">.</span><span class="na">SLEEPING</span><span class="o">,</span> <span class="n">token</span><span class="o">,</span> <span class="n">sleeping</span> <span class="o">?</span> <span class="n">1</span> <span class="o">:</span> <span class="n">0</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kd">final</span> <span class="kt">void</span> <span class="nf">scheduleResumeActivity</span><span class="o">(</span><span class="n">IBinder</span> <span class="n">token</span><span class="o">,</span> <span class="kt">int</span> <span class="n">processState</span><span class="o">,</span>
                <span class="kt">boolean</span> <span class="n">isForward</span><span class="o">,</span> <span class="n">Bundle</span> <span class="n">resumeArgs</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">updateProcessState</span><span class="o">(</span><span class="n">processState</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
            <span class="n">sendMessage</span><span class="o">(</span><span class="n">H</span><span class="o">.</span><span class="na">RESUME_ACTIVITY</span><span class="o">,</span> <span class="n">token</span><span class="o">,</span> <span class="n">isForward</span> <span class="o">?</span> <span class="n">1</span> <span class="o">:</span> <span class="n">0</span><span class="o">);</span>
<span class="o">}</span>

<span class="o">......</span>
</code></pre></div></span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/59614987"><span data-tooltip="发布于 2015-08-17 16:58">编辑于 2015-08-18</span></a></div></div><div class="ContentItem-actions RichContent-actions"><span><button aria-label="赞同 38" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 38</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>4 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover492-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover492-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover493-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover493-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div><button data-zop-retract-question="true" type="button" class="Button ContentItem-action ContentItem-rightButton Button--plain"><span class="RichContent-collapsedText">收起</span><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--ArrowDown ContentItem-arrowIcon is-active" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M12 13L8.285 9.218a.758.758 0 0 0-1.064 0 .738.738 0 0 0 0 1.052l4.249 4.512a.758.758 0 0 0 1.064 0l4.246-4.512a.738.738 0 0 0 0-1.052.757.757 0 0 0-1.063 0L12.002 13z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="5" data-zop="{&quot;authorName&quot;:&quot;hi大头鬼hi&quot;,&quot;itemId&quot;:59558499,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="59558499" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="5" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;59558499&quot;,&quot;upvote_num&quot;:42,&quot;comment_num&quot;:12,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;50b28faaec835947511e005cd6734484&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="hi大头鬼hi"><meta itemprop="image" content="https://pic4.zhimg.com/5c6be7d9e_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/bruce-sh"><meta itemprop="zhihu:followerCount" content="10922"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover63-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover63-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/bruce-sh"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/5c6be7d9e_xs.jpg" srcset="https://pic4.zhimg.com/5c6be7d9e_l.jpg 2x" alt="hi大头鬼hi"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover64-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover64-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/bruce-sh">hi大头鬼hi</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">程序员，阿里内推</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">42 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="42"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/59558499"><meta itemprop="dateCreated" content="2015-08-17T02:39:55.000Z"><meta itemprop="dateModified" content="2015-08-17T02:39:55.000Z"><meta itemprop="commentCount" content="12"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]"><p>ActivityThread是应用程序的入口，这里你可以看到写Java程序时司空见惯的main方法，而main方法正是整个Java程序的入口。</p><p>ActivityThread的main方法主要就是做消息循环，一旦退出消息循环，那么你的程序也就可以退出了。</p>从消息队列中取消息可能会阻塞，取到消息会做出相应的处理。如果某个消息处理时间过长，就可能会影响UI线程的刷新速率，造成卡顿的现象。</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/59558499"><span data-tooltip="发布于 2015-08-17 10:39">发布于 2015-08-17</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 42" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 42</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>12 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover84-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover84-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover85-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover85-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="6" data-zop="{&quot;authorName&quot;:&quot;丢猫&quot;,&quot;itemId&quot;:97407853,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="97407853" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="6" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;97407853&quot;,&quot;upvote_num&quot;:18,&quot;comment_num&quot;:2,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;5d8a8fe6226a4bd774536df0db982495&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="丢猫"><meta itemprop="image" content="https://pic3.zhimg.com/v2-20ceee3633384b2ac50c6195215877a4_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/wu-yu-58-67"><meta itemprop="zhihu:followerCount" content="82"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover67-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover67-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/wu-yu-58-67"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-20ceee3633384b2ac50c6195215877a4_xs.jpg" srcset="https://pic3.zhimg.com/v2-20ceee3633384b2ac50c6195215877a4_l.jpg 2x" alt="丢猫"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover68-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover68-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/wu-yu-58-67">丢猫</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">让我去？你的机枪兵都死光了？</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">18 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="18"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/97407853"><meta itemprop="dateCreated" content="2016-04-26T11:00:19.000Z"><meta itemprop="dateModified" content="2016-04-26T11:00:19.000Z"><meta itemprop="commentCount" content="2"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">谁和你说没卡死，实际上就是卡死了。不信你new一个thread，在里面建立一个looper，然后looper.prepare，随后再打个log，你就会发现log死活不会打。<br>一个looper维护一个消息队列，队列里有消息就取出来执行，没消息就休眠直到有消息进入，就是个典型的生产者消费者模型。实际的消息模型会更复杂一些，定时执行和延迟执行关系到系统中断。<br>所以在looper启动后，主线程上执行的任何代码都是在一个被looper从消息队列里取出来执行的runnable内被执行而已，主线程此时就是被阻塞在一个无限循环里了。<br>activity life cycle callback也是如此，生命周期的回调首先是ams通过binder发送ipc调用给app进程，app进程里的binder stub接收到调用后，给main looper插了条runnable而已（通过和main looper绑定的handler完成）。</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/97407853"><span data-tooltip="发布于 2016-04-26 19:00">发布于 2016-04-26</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 18" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 18</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>2 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover87-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover87-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover88-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover88-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="7" data-zop="{&quot;authorName&quot;:&quot;Anonymous&quot;,&quot;itemId&quot;:382654129,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="382654129" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="7" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;382654129&quot;,&quot;upvote_num&quot;:8,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;1da180610c4aeaa3125c2d1f5c610f14&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Anonymous"><meta itemprop="image" content="https://pic4.zhimg.com/da8e974dc_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/anonymous37"><meta itemprop="zhihu:followerCount" content="7"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover71-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover71-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/anonymous37"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/da8e974dc_xs.jpg" srcset="https://pic4.zhimg.com/da8e974dc_l.jpg 2x" alt="Anonymous"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover72-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover72-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/anonymous37">Anonymous</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">搞机的</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">8 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="8"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/382654129"><meta itemprop="dateCreated" content="2018-05-03T16:39:46.000Z"><meta itemprop="dateModified" content="2018-05-03T16:42:49.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]"><p>很多同学都解释了<code>Looper.loop()</code>方法里的死循环跟ANR的区别，我补充一下对以下问题的看法：当主线程调用<code>Looper.loop()</code>方法开始监听消息，并且当消息队列为空时，主线程被挂起，在这种情况下，谁来唤醒主线程？比如当主线程队列为空被挂起之后，用户点击屏幕，这时主线程是如何被唤醒的？</p><p>首先，即使app开发者没有创建其他线程，主线程也不是唯一的线程，还有Binder线程等。这些线程都可以发送消息到主线程来唤醒它处理消息。</p><p>其次，在<code>MessageQueue.next()</code>方法里，会调用一个native方法：<code>nativePollOnce(long ptr, int timeoutMillis)</code>，当主线程没有消息可处理的时候，该方法会阻塞主线程。在这种情况下，用户点击一下屏幕，（打断点）可发现如下调用栈：</p><div class="highlight"><pre><code class="language-text">at android.view.InputEventReceiver.dispatchInputEvent(InputEventReceiver.java:185)
at android.os.MessageQueue.nativePollOnce(MessageQueue.java:-1)
at android.os.MessageQueue.next(MessageQueue.java:325)
at android.os.Looper.loop(Looper.java:142)
at android.app.ActivityThread.main(ActivityThread.java:6541)
at java.lang.reflect.Method.invoke(Method.java:-1)
at com.android.internal.os.Zygote$MethodAndArgsCaller.run(Zygote.java:240)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:767)</code></pre></div><p>可以看到<code>nativePollOnce()</code>方法继续执行了，并且调用了<code>InputEventReceiver.dispatchInputEvent()</code>方法。看源码可以发现该方法有如下注释，这是一个被native 代码调用的方法。</p><div class="highlight"><pre><code class="language-java"><span class="c1">// Called from native code.
</span><span class="c1"></span><span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"unused"</span><span class="o">)</span>
<span class="kd">private</span> <span class="kt">void</span> <span class="nf">dispatchInputEvent</span><span class="o">(</span><span class="kt">int</span> <span class="n">seq</span><span class="o">,</span> <span class="n">InputEvent</span> <span class="n">event</span><span class="o">)</span></code></pre></div><p>由此可推测，调用<code>nativePollOnce()</code>方法挂起主线程之后，当有一些事件到来时，native层会唤醒主线程。具体的阻塞和唤醒机制，就是其他答主提到的epoll机制了。</p><p class="ztext-empty-paragraph"><br></p><p>注：以上涉及代码，是android sdk 26上的，其他系统版本可能有所不同。</p><p>再注：好奇心重的同学，可以在<code>MessageQueue.next()</code>方法里打断点观察主线程在队列为空的情况下如何被阻塞。阻塞之后，可以在<code>MessageQueue</code>的各个添加消息到队列中的方法里打断点，观察点击屏幕时产生的第一个消息是如何被添加到队列里的。</p><p>小tips：<code>MessageQueue.enqueueMessage(Message msg, long when)</code>并不是唯一添加消息的方法。 记得在所有添加消息的方法里打断点，才能观察到第一个消息是如何被添加到队列里的。</p></span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/382654129"><span data-tooltip="发布于 2018-05-04 00:39">编辑于 2018-05-04</span></a></div></div><div class="ContentItem-actions RichContent-actions"><span><button aria-label="赞同 8" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 8</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover482-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover482-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover483-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover483-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div><button data-zop-retract-question="true" type="button" class="Button ContentItem-action ContentItem-rightButton Button--plain"><span class="RichContent-collapsedText">收起</span><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--ArrowDown ContentItem-arrowIcon is-active" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M12 13L8.285 9.218a.758.758 0 0 0-1.064 0 .738.738 0 0 0 0 1.052l4.249 4.512a.758.758 0 0 0 1.064 0l4.246-4.512a.738.738 0 0 0 0-1.052.757.757 0 0 0-1.063 0L12.002 13z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="8" data-zop="{&quot;authorName&quot;:&quot;RyuanYans&quot;,&quot;itemId&quot;:278867983,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="278867983" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="8" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;278867983&quot;,&quot;upvote_num&quot;:12,&quot;comment_num&quot;:3,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;fa48d62e3080c51435cadd2cffabcb5f&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="RyuanYans"><meta itemprop="image" content="https://pic2.zhimg.com/1d1ea5573e22f04978c4598c8e227f6c_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/RyanYans"><meta itemprop="zhihu:followerCount" content="6"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover75-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover75-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/RyanYans"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/1d1ea5573e22f04978c4598c8e227f6c_xs.jpg" srcset="https://pic2.zhimg.com/1d1ea5573e22f04978c4598c8e227f6c_l.jpg 2x" alt="RyuanYans"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover76-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover76-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/RyanYans">RyuanYans</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">-- 职业拔鞋钉</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">12 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="12"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/278867983"><meta itemprop="dateCreated" content="2017-12-18T16:43:20.000Z"><meta itemprop="dateModified" content="2017-12-18T16:43:20.000Z"><meta itemprop="commentCount" content="3"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]"><p>哈哈，我看有一部分人理解”Looper.loop()的阻塞“和”UI线程上执行耗时操作卡死“的区别时还一脸懵逼的状况，简单回答一波：</p><ol><li>首先这两之间一点联系都没有，完全两码事。</li><li>Looper上的阻塞，<b>前提是没有输入事件</b>，MsgQ为空，Looper空闲状态，线程进入阻塞，释放CPU执行权，等待唤醒。</li><li>UI耗时导致卡死，<b>前提是要有输入事件，</b>MsgQ不为空，Looper正常轮询，线程并没有阻塞，但是该事件执行时间过长（5秒？），而且与此期间其他的事件（按键按下，屏幕点击..）都没办法处理（卡死），然后就ANR异常了。</li></ol></span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/278867983"><span data-tooltip="发布于 2017-12-19 00:43">发布于 2017-12-19</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 12" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 12</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>3 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover147-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover147-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover148-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover148-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="9" data-zop="{&quot;authorName&quot;:&quot;TracyB&quot;,&quot;itemId&quot;:59722754,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="59722754" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="9" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;59722754&quot;,&quot;upvote_num&quot;:24,&quot;comment_num&quot;:3,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;ab24dfe2f68a55fcd8d3d3b367505be6&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="TracyB"><meta itemprop="image" content="https://pic4.zhimg.com/da8e974dc_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/tracyb"><meta itemprop="zhihu:followerCount" content="11"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover79-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover79-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/tracyb"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/da8e974dc_xs.jpg" srcset="https://pic4.zhimg.com/da8e974dc_l.jpg 2x" alt="TracyB"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover80-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover80-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/tracyb">TracyB</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">这里不想显示技术探索者</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">24 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="24"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/59722754"><meta itemprop="dateCreated" content="2015-08-18T04:22:50.000Z"><meta itemprop="dateModified" content="2015-08-18T04:22:50.000Z"><meta itemprop="commentCount" content="3"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">epoll+pipe，有消息就依次执行，没消息就block住，让出CPU，等有消息了，epoll会往pipe中写一个字符，把主线程从block状态唤起，主线程就继续依次执行消息，怎么会死循环呢…</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/59722754"><span data-tooltip="发布于 2015-08-18 12:22">发布于 2015-08-18</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 24" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 24</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>3 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover150-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover150-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover151-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover151-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="10" data-zop="{&quot;authorName&quot;:&quot;Cyandev&quot;,&quot;itemId&quot;:157878909,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="157878909" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="10" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;157878909&quot;,&quot;upvote_num&quot;:1,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;73dea43918ac6edf7b152eea6eb87cd4&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Cyandev"><meta itemprop="image" content="https://pic1.zhimg.com/v2-fad5db0f7540afc406e5aa12a6f111b3_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/cyandev"><meta itemprop="zhihu:followerCount" content="2566"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover98-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover98-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/cyandev"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-fad5db0f7540afc406e5aa12a6f111b3_xs.jpg" srcset="https://pic1.zhimg.com/v2-fad5db0f7540afc406e5aa12a6f111b3_l.jpg 2x" alt="Cyandev"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover99-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover99-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/cyandev">Cyandev</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">An initiate of programming.</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">1 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="1"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/157878909"><meta itemprop="dateCreated" content="2017-04-18T04:24:40.000Z"><meta itemprop="dateModified" content="2017-04-18T04:24:40.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">对于 epoll 相关的知识题主可以稍后了解，这里主要说下为什么不会“卡死”，我觉得题主认为的卡死就是一个方法长时间没有返回导致 ANR，然后 main 函数中又调用了 loop 方法，这个方法也不会返回，是一个死循环。但是 UI 是事件循环来驱动的，也就是说每一帧的绘制都会通过一次事件循环（Android 后来出现的 Render Thread 或者 macOS、iOS 的 WindowServer 机制不严格是这样），每次触摸操作也要经过一次事件循环，假如某个方法执行时间过长，那么新的触摸或重绘事件就不能得以处理，用户就会觉得卡或死机了。然而事件循环总得有个驱动器，这就需要用到循环，loop 方法中实际上有一个很重要的调用来获取下一个可用的事件，假设没有可用事件就会通过 epoll 来等待，拿到事件后就会通过 Handler 进行派发，派发的最终结果就是你的 Activity  或其他 components 里的一个生命周期方法或回调方法被调用，你就可以在里面做自己的事情了。</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/157878909"><span data-tooltip="发布于 2017-04-18 12:24">发布于 2017-04-18</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 1" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 1</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover153-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover153-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover154-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover154-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="11" data-zop="{&quot;authorName&quot;:&quot;Alex Wang&quot;,&quot;itemId&quot;:59575004,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="59575004" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="11" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;59575004&quot;,&quot;upvote_num&quot;:8,&quot;comment_num&quot;:1,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;5eb088c3ccc2c51ce81bb274049fb5db&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Alex Wang"><meta itemprop="image" content="https://pic4.zhimg.com/7b8e72c144e581881f769b179b98b309_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/wang-du-du-43-1"><meta itemprop="zhihu:followerCount" content="2872"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover102-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover102-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/wang-du-du-43-1"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/7b8e72c144e581881f769b179b98b309_xs.jpg" srcset="https://pic4.zhimg.com/7b8e72c144e581881f769b179b98b309_l.jpg 2x" alt="Alex Wang"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover103-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover103-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/wang-du-du-43-1">Alex Wang</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">高级工程师，Coder，Teamleader</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">8 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="8"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/59575004"><meta itemprop="dateCreated" content="2015-08-17T04:30:32.000Z"><meta itemprop="dateModified" content="2015-08-17T04:30:32.000Z"><meta itemprop="commentCount" content="1"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">卡死是指不响应消息，而那个循环就是一个消息处理循环啊。</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/59575004"><span data-tooltip="发布于 2015-08-17 12:30">发布于 2015-08-17</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 8" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 8</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>1 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover158-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover158-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover159-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover159-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="12" data-zop="{&quot;authorName&quot;:&quot;Jie Peng&quot;,&quot;itemId&quot;:90662131,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="90662131" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="12" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;90662131&quot;,&quot;upvote_num&quot;:8,&quot;comment_num&quot;:2,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;db54a6dddc206ab77597776d908768a8&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Jie Peng"><meta itemprop="image" content="https://pic1.zhimg.com/v2-c50a9cb7b659321b3e7f26b6dc675d41_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/jie-peng-20"><meta itemprop="zhihu:followerCount" content="9"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover106-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover106-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/jie-peng-20"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-c50a9cb7b659321b3e7f26b6dc675d41_xs.jpg" srcset="https://pic1.zhimg.com/v2-c50a9cb7b659321b3e7f26b6dc675d41_l.jpg 2x" alt="Jie Peng"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover107-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover107-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/jie-peng-20">Jie Peng</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">专注Android开发</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">8 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="8"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/90662131"><meta itemprop="dateCreated" content="2016-03-14T06:39:33.000Z"><meta itemprop="dateModified" content="2016-03-14T06:41:43.000Z"><meta itemprop="commentCount" content="2"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">大神们写得都很好,但其实对我们小白来讲，还有很多点是需要打通的<br>APK程序的运行过程<br>    首先，ActivityThread从static main()函数开始，调用prepareMainLooper()为UI线程创建一个消息对列（MessageQueue）<br>    然后，创建一个ActivityThread对象，在其初始化代码中会创建一个H（Handler）对象和一个AppplicationThread(Binder)对象<br>Binder负责接远程AmS的IPC调用，收到消息后，通过Handler将消息发送到消息队列，UI主线程会异步的从消息队列中取出消息并执行操作<br>    接着，UI主线程调用Looper.loop()进入消息循环体。<br>    当ActivityThread接收到AmS发送start某个activit后，就会创建指定的Activity对象。Activity又会创建PhoneWindow类---&gt;DecroView类---&gt;相应的View创建完成后，Activity需要把创建好的界面显示到屏幕上，于是调用WindowManager,他会创建一个ViewRoot对象，创建完ViewRoot后，WM调用WmS提供的远程接口完成添加一个窗口并显示到屏幕上。<br>-------------------------以上摘自柯元旦&lt;Android内核剖析&gt;<br>我觉得比较重要的几个点：<br>1.基本上一个Binder会对应一个线程,因为他用于IPC通信，肯定是阻塞式的，他又不可能在UI线程中阻塞<br>2.理解AmS和和客户端Activity的交互过程,WmS拿到启动某个Activity的消息后肯定会把这条消息以IPC的方式发送给ActivityThread，负责这一过程的Binder就是ApplicationThread<br>3.如果不理解Binder请忽略</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/90662131"><span data-tooltip="发布于 2016-03-14 14:39">编辑于 2016-03-14</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 8" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 8</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>2 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover161-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover161-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover162-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover162-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="13" data-zop="{&quot;authorName&quot;:&quot;王少星&quot;,&quot;itemId&quot;:89375831,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="89375831" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="13" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;89375831&quot;,&quot;upvote_num&quot;:4,&quot;comment_num&quot;:4,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;462f65a806bdd55ca02487ca0b07d8e1&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="王少星"><meta itemprop="image" content="https://pic2.zhimg.com/v2-07f4a9191fc9343192a1ff0efd69bc08_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/wang-shao-xing"><meta itemprop="zhihu:followerCount" content="28"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover110-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover110-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/wang-shao-xing"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-07f4a9191fc9343192a1ff0efd69bc08_xs.jpg" srcset="https://pic2.zhimg.com/v2-07f4a9191fc9343192a1ff0efd69bc08_l.jpg 2x" alt="王少星"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover111-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover111-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/wang-shao-xing">王少星</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">4 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="4"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/89375831"><meta itemprop="dateCreated" content="2016-03-05T12:08:28.000Z"><meta itemprop="dateModified" content="2016-03-05T12:08:28.000Z"><meta itemprop="commentCount" content="4"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">这里是 6.0 的 ActivityThread main 方法的源代码：<br><div class="highlight"><pre><code class="language-java"><span class="c1">// End of event ActivityThreadMain.
</span><span class="c1"></span><span class="n">Trace</span><span class="o">.</span><span class="na">traceEnd</span><span class="o">(</span><span class="n">Trace</span><span class="o">.</span><span class="na">TRACE_TAG_ACTIVITY_MANAGER</span><span class="o">);</span>
<span class="n">Looper</span><span class="o">.</span><span class="na">loop</span><span class="o">();</span>

<span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="s">"Main thread loop unexpectedly exited"</span><span class="o">);</span></code></pre></div>Looper.loop() 确实是一个死循环，但是 Looper.loop() 后面就没有东西了啊（轮到后面那一句执行就是程序异常退出了）。<br>Looper.loop() 就这样一直在主线程守着，我们的 App 才有机会等待用户来操作，才不会执行完 main() 方法就结束了。<br>Looper.loop() 这个方法在主线程循环着，当有消息的时候就进行消息处理，可以调用我们在 Activity 里写的生命周期方法，也就说我们的代码其实就是在这个循环里面去执行的，当然不会阻塞了。</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/89375831"><span data-tooltip="发布于 2016-03-05 20:08">发布于 2016-03-05</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 4" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 4</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>4 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover190-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover190-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover191-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover191-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="14" data-zop="{&quot;authorName&quot;:&quot;keylor李担&quot;,&quot;itemId&quot;:59981198,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="59981198" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="14" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;59981198&quot;,&quot;upvote_num&quot;:5,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;2beecbafc9ab8f68efe703a28ab04c52&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="keylor李担"><meta itemprop="image" content="https://pic4.zhimg.com/v2-fe265f114f816c52c97625b43cf658b7_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/keylorli-dan"><meta itemprop="zhihu:followerCount" content="169"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover114-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover114-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/keylorli-dan"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-fe265f114f816c52c97625b43cf658b7_xs.jpg" srcset="https://pic4.zhimg.com/v2-fe265f114f816c52c97625b43cf658b7_l.jpg 2x" alt="keylor李担"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover115-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover115-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/keylorli-dan">keylor李担</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">用程序创造价值，经济学理解人性。曾历人生灰暗，也将拥未来明光</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">5 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="5"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/59981198"><meta itemprop="dateCreated" content="2015-08-19T16:40:21.000Z"><meta itemprop="dateModified" content="2015-08-19T16:40:21.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">就像一辆车在圆形赛车道上跑，一边跑一边执行任务，比如开到市中心买瓶水，任务完成又回到刚刚离开的地方，继续各种执行买水的任务，直到没有任务了，行了，跑一圈回到起点。睡觉，有任务叫醒你，你又开始跑一圈。边跑边接单。</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/59981198"><span data-tooltip="发布于 2015-08-20 00:40">发布于 2015-08-20</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 5" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 5</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover193-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover193-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover194-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover194-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="15" data-zop="{&quot;authorName&quot;:&quot;一只程序员&quot;,&quot;itemId&quot;:96395942,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="96395942" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="15" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;96395942&quot;,&quot;upvote_num&quot;:1,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;74cb5ac5594f5eae9130d42d9f5c0647&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="一只程序员"><meta itemprop="image" content="https://pic2.zhimg.com/2d9d962f7471b2e259ad120b7f1b000f_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/yizhi-cheng-xu-yuan"><meta itemprop="zhihu:followerCount" content="704"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover168-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover168-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/yizhi-cheng-xu-yuan"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/2d9d962f7471b2e259ad120b7f1b000f_xs.jpg" srcset="https://pic2.zhimg.com/2d9d962f7471b2e259ad120b7f1b000f_l.jpg 2x" alt="一只程序员"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover169-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover169-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/yizhi-cheng-xu-yuan">一只程序员</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">不把匿名功能干掉，知乎迟早要完.另外喜欢问如何看待XXX的,你有脑子就自己想去。</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">1 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="1"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/96395942"><meta itemprop="dateCreated" content="2016-04-22T12:12:36.000Z"><meta itemprop="dateModified" content="2016-04-22T12:12:36.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">这个东西，如果故意这么写的，游戏界称为叫永真循环。如果是某程序员乱写的，叫死循环。。。。</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/96395942"><span data-tooltip="发布于 2016-04-22 20:12">发布于 2016-04-22</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 1" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 1</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover196-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover196-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover197-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover197-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="16" data-zop="{&quot;authorName&quot;:&quot;况鹰&quot;,&quot;itemId&quot;:59666239,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="59666239" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="16" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;59666239&quot;,&quot;upvote_num&quot;:2,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;81494a35b0d35a873c5ab65ecb3e398e&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="况鹰"><meta itemprop="image" content="https://pic3.zhimg.com/e9e1bfee3f75264ba5d46778c13481a5_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/kuang-ying-57"><meta itemprop="zhihu:followerCount" content="154"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover172-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover172-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/kuang-ying-57"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/e9e1bfee3f75264ba5d46778c13481a5_xs.jpg" srcset="https://pic3.zhimg.com/e9e1bfee3f75264ba5d46778c13481a5_l.jpg 2x" alt="况鹰"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover173-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover173-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/kuang-ying-57">况鹰</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">源码爱好者</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">2 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="2"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/59666239"><meta itemprop="dateCreated" content="2015-08-17T15:34:43.000Z"><meta itemprop="dateModified" content="2015-08-17T15:38:09.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">messagequene里面的next又是个for(;;)死循环，继续深入下去jni层还有个for(;;)，三层死循环呢，哪只楼主的一层啊，按楼主的意思得卡成翔。其实答案楼主的第二张图已经有提示了，next()后面写了两个很大的英文提示 ---- might block。。。。。。block不就意味着不占有cpu了么，为啥会卡死。。。。。最后一句，看看epoll就明白looper的原理了。再补充一下，实在不明白的话可以用libevent写个简单的10行例子代码跑跑。</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/59666239"><span data-tooltip="发布于 2015-08-17 23:34">编辑于 2015-08-17</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 2" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 2</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover199-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover199-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover200-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover200-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="17" data-zop="{&quot;authorName&quot;:&quot;皎洁同学&quot;,&quot;itemId&quot;:662898834,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="662898834" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="17" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;662898834&quot;,&quot;upvote_num&quot;:1,&quot;comment_num&quot;:1,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;0a0cc7625af7b3e9ae285920515cbf92&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="皎洁同学"><meta itemprop="image" content="https://pic3.zhimg.com/v2-3e5ae23253257ddfe781f2845707cd72_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/dwyane-wade-51"><meta itemprop="zhihu:followerCount" content="31"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover176-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover176-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/dwyane-wade-51"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-3e5ae23253257ddfe781f2845707cd72_xs.jpg" srcset="https://pic3.zhimg.com/v2-3e5ae23253257ddfe781f2845707cd72_l.jpg 2x" alt="皎洁同学"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover177-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover177-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/dwyane-wade-51">皎洁同学</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">公众号：皎洁同学 这里不只有科技&amp;Android</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">1 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="1"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/662898834"><meta itemprop="dateCreated" content="2019-04-25T07:50:39.000Z"><meta itemprop="dateModified" content="2019-04-25T07:50:39.000Z"><meta itemprop="commentCount" content="1"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]"><p>准确的讲，主线程确实堵塞了，Looper实现了<b>可阻塞的死循环</b>。当没有消息的时候，主线程既不能退出，又不能无阻塞死循环执行，最后的办法只能是让他有消息的时候处理消息，没消息的时候进入阻塞状态。</p><p>利用Linux的epoll+pipe机制，使得主线程在阻塞的时候，让出CPU资源，同时等待新消息。当我们对系统进行操作（包括各种滑动和点击）的时候，系统就会给主线程发送消息，这个时候就会唤醒主线程（执行onCreate，onResume等方法），当处理完这个消息，就会再次进入阻塞状态。这样系统就能做到随时响应用户的操作。</p><p>真正的ANR绝不是Looper轮询消息导致的，而是处理消息过程中的问题。<b>事件只会阻塞Looper，而Looper不会阻塞事件</b>，当某个事件在主线程执行了耗时操作，影响了Looper轮询后面的消息，才会发生ANR。</p></span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/662898834"><span data-tooltip="发布于 2019-04-25 15:50">发布于 2019-04-25</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 1" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 1</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>1 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover202-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover202-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover203-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover203-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="18" data-zop="{&quot;authorName&quot;:&quot;拉曼却的疯骑士&quot;,&quot;itemId&quot;:145911277,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="145911277" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="18" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;145911277&quot;,&quot;upvote_num&quot;:1,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;c4020e41f34ccbffad72c57e86b0c5e7&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="拉曼却的疯骑士"><meta itemprop="image" content="https://pic3.zhimg.com/v2-59c12034caaa4f2ea6e26511335c60a8_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/caoyanfeng"><meta itemprop="zhihu:followerCount" content="599"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover180-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover180-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/caoyanfeng"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-59c12034caaa4f2ea6e26511335c60a8_xs.jpg" srcset="https://pic3.zhimg.com/v2-59c12034caaa4f2ea6e26511335c60a8_l.jpg 2x" alt="拉曼却的疯骑士"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover181-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover181-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/caoyanfeng">拉曼却的疯骑士</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">高质量回答，争取成为知乎大V</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">1 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="1"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/145911277"><meta itemprop="dateCreated" content="2017-02-12T04:43:52.000Z"><meta itemprop="dateModified" content="2017-02-12T04:47:37.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]"><p><span><span class="UserLink"><div class="Popover"><div id="Popover188-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover188-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/c7de1694c846fe3b95895bc4ccb8df50" data-za-detail-view-id="1045">@Gityuan</a></div></div></span></span> 已经很好的解释了这个问题，我来解释另外一个问题——主线程能进入消息循环而不能退出，而子线程需要主动建立消息循环，并且需要主动退出。</p><p>./frameworks/base/core/java/android/app/ActivityThread.java里有UI主线程的main函数入口：</p><div class="highlight"><pre><code class="language-text">public static void main(String[] args) {
    Trace.traceBegin(Trace.TRACE_TAG_ACTIVITY_MANAGER, "ActivityThreadMain");
    SamplingProfilerIntegration.start();

    // CloseGuard defaults to true and can be quite spammy.  We
    // disable it here, but selectively enable it later (via
    // StrictMode) on debug builds, but using DropBox, not logs.
    CloseGuard.setEnabled(false);

    Environment.initForCurrentUser();

    // Set the reporter for event logging in libcore
    EventLogger.setReporter(new EventLoggingReporter());

    // Make sure TrustedCertificateStore looks in the right place for CA certificates
    final File configDir = Environment.getUserConfigDirectory(UserHandle.myUserId());
    TrustedCertificateStore.setDefaultUserDirectory(configDir);

    Process.setArgV0("&lt;pre-initialized&gt;");

    Looper.prepareMainLooper();

    ActivityThread thread = new ActivityThread();
    thread.attach(false);

    if (sMainThreadHandler == null) {
        sMainThreadHandler = thread.getHandler();
    }

    if (false) {
        Looper.myLooper().setMessageLogging(new
                LogPrinter(Log.DEBUG, "ActivityThread"));
    }

    // End of event ActivityThreadMain.
    Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER);
    Looper.loop();

    throw new RuntimeException("Main thread loop unexpectedly exited");
}</code></pre></div><p>Looper.loop()就进入了死循环，而Looper.<i>prepareMainLooper</i>()如下:</p><div class="highlight"><pre><code class="language-text">/**
 * Initialize the current thread as a looper, marking it as an
 * application's main looper. The main looper for your application
 * is created by the Android environment, so you should never need
 * to call this function yourself.  See also: {@link #prepare()}
 */
public static void prepareMainLooper() {
    prepare(false);
    synchronized (Looper.class) {
        if (sMainLooper != null) {
            throw new IllegalStateException("The main Looper has already been prepared.");
        }
        sMainLooper = myLooper();
    }
}</code></pre></div><p><i>prepare</i>(false)是私有的，不能被外部调用，只被主线程调用。</p><div class="highlight"><pre><code class="language-text">private static void prepare(boolean quitAllowed) {
    if (sThreadLocal.get() != null) {
        throw new RuntimeException("Only one Looper may be created per thread");
    }
    sThreadLocal.set(new Looper(quitAllowed));
}</code></pre></div><p>new Looper(quitAllowed)</p><div class="highlight"><pre><code class="language-text">private Looper(boolean quitAllowed) {
    mQueue = new MessageQueue(quitAllowed);
    mThread = Thread.currentThread();
}</code></pre></div><p>也就是这个quitAllowed标志量传入了MessageQueue。MessageQueue是由内部的Message采用指针方式实现的链表，内部有个quit(boolean safe)方法。</p><div class="highlight"><pre><code class="language-text">void quit(boolean safe) {
    if (!mQuitAllowed) {
        throw new IllegalStateException("Main thread not allowed to quit.");
    }

    synchronized (this) {
        if (mQuitting) {
            return;
        }
        mQuitting = true;

        if (safe) {
            removeAllFutureMessagesLocked();
        } else {
            removeAllMessagesLocked();
        }

        // We can assume mPtr != 0 because mQuitting was previously false.
        nativeWake(mPtr);
    }
}</code></pre></div><p>也就是说，UI主线程则不能主动退出消息循环。</p><br><p>而子类建立消息循环的典型方式如下：</p><div class="highlight"><pre><code class="language-text">* &lt;pre&gt;
*  class LooperThread extends Thread {
*      public Handler mHandler;
*
*      public void run() {
*          Looper.prepare();
*
*          mHandler = new Handler() {
*              public void handleMessage(Message msg) {
*                  // process incoming messages here
*              }
*          };
*
*          Looper.loop();
*      }
*  }&lt;/pre&gt;</code></pre></div><p><i>如果子线程已经执行完毕所有消息循环，则必须主动结束子线程的消息循环，否则会陷入死循环。结束的方式是主动调用Looper的quit()或</i>quitSafely()<i>方法。</i></p><div class="highlight"><pre><code class="language-text">/**
 * Quits the looper.
 * &lt;p&gt;
 * Causes the {@link #loop} method to terminate without processing any
 * more messages in the message queue.
 * &lt;/p&gt;&lt;p&gt;
 * Any attempt to post messages to the queue after the looper is asked to quit will fail.
 * For example, the {@link Handler#sendMessage(Message)} method will return false.
 * &lt;/p&gt;&lt;p class="note"&gt;
 * Using this method may be unsafe because some messages may not be delivered
 * before the looper terminates.  Consider using {@link #quitSafely} instead to ensure
 * that all pending work is completed in an orderly manner.
 * &lt;/p&gt;
 *
 * @see #quitSafely
 */
public void quit() {
    mQueue.quit(false);
}

/**
 * Quits the looper safely.
 * &lt;p&gt;
 * Causes the {@link #loop} method to terminate as soon as all remaining messages
 * in the message queue that are already due to be delivered have been handled.
 * However pending delayed messages with due times in the future will not be
 * delivered before the loop terminates.
 * &lt;/p&gt;&lt;p&gt;
 * Any attempt to post messages to the queue after the looper is asked to quit will fail.
 * For example, the {@link Handler#sendMessage(Message)} method will return false.
 * &lt;/p&gt;
 */
public void quitSafely() {
    mQueue.quit(true);
}</code></pre></div></span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/145911277"><span data-tooltip="发布于 2017-02-12 12:43">编辑于 2017-02-12</span></a></div></div><div class="ContentItem-actions RichContent-actions"><span><button aria-label="赞同 1" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 1</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover478-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover478-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover479-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover479-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div><button data-zop-retract-question="true" type="button" class="Button ContentItem-action ContentItem-rightButton Button--plain"><span class="RichContent-collapsedText">收起</span><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--ArrowDown ContentItem-arrowIcon is-active" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M12 13L8.285 9.218a.758.758 0 0 0-1.064 0 .738.738 0 0 0 0 1.052l4.249 4.512a.758.758 0 0 0 1.064 0l4.246-4.512a.738.738 0 0 0 0-1.052.757.757 0 0 0-1.063 0L12.002 13z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="19" data-zop="{&quot;authorName&quot;:&quot;淡薄者&quot;,&quot;itemId&quot;:59718107,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="59718107" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="19" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;59718107&quot;,&quot;upvote_num&quot;:1,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;32641632b3752668dd0cdf34ee51eb6d&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="淡薄者"><meta itemprop="image" content="https://pic2.zhimg.com/8a2873e38278ce738331040aeafd9c6e_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/zai-lu-gao-tou"><meta itemprop="zhihu:followerCount" content="6"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover184-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover184-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/zai-lu-gao-tou"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/8a2873e38278ce738331040aeafd9c6e_xs.jpg" srcset="https://pic2.zhimg.com/8a2873e38278ce738331040aeafd9c6e_l.jpg 2x" alt="淡薄者"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover185-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover185-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/zai-lu-gao-tou">淡薄者</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">虽然技术菜，但是代码写得帅！</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">1 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="1"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/59718107"><meta itemprop="dateCreated" content="2015-08-18T03:49:01.000Z"><meta itemprop="dateModified" content="2015-08-18T03:49:01.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">next（）是一个阻塞方法，如果没有消息只会一直等在那里并不会多消耗系统资源，所以不会卡死</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/59718107"><span data-tooltip="发布于 2015-08-18 11:49">发布于 2015-08-18</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 1" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 1</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover246-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover246-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover247-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover247-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="20" data-zop="{&quot;authorName&quot;:&quot;风格鱼&quot;,&quot;itemId&quot;:63079799,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="63079799" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="20" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;63079799&quot;,&quot;upvote_num&quot;:1,&quot;comment_num&quot;:2,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;647475e376998e5d339b00d7d2b4251b&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="风格鱼"><meta itemprop="image" content="https://pic4.zhimg.com/b25abc0014ef4f7df183288360561f0c_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/bu-yi-yun-97"><meta itemprop="zhihu:followerCount" content="409"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover227-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover227-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/bu-yi-yun-97"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/b25abc0014ef4f7df183288360561f0c_xs.jpg" srcset="https://pic4.zhimg.com/b25abc0014ef4f7df183288360561f0c_l.jpg 2x" alt="风格鱼"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover228-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover228-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/bu-yi-yun-97">风格鱼</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">喜欢跑步的鹅厂码农</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">1 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="1"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/63079799"><meta itemprop="dateCreated" content="2015-09-10T04:36:27.000Z"><meta itemprop="dateModified" content="2015-09-10T04:36:27.000Z"><meta itemprop="commentCount" content="2"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">前几天刚好在面试的时候被问到了这个问题，我也看过looper源码，但是确实不清楚，当时没答出来。后面和同学讨论的时候，同学说应该是通过某种方式在消息队列没有消息的时候让它阻塞。</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/63079799"><span data-tooltip="发布于 2015-09-10 12:36">发布于 2015-09-10</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 1" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 1</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>2 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover249-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover249-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover250-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover250-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="21" data-zop="{&quot;authorName&quot;:&quot;麦田捕手&quot;,&quot;itemId&quot;:93796167,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="93796167" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="21" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;93796167&quot;,&quot;upvote_num&quot;:3,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;27dda92abc09782082d0436cfadcbefa&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="麦田捕手"><meta itemprop="image" content="https://pic3.zhimg.com/1cc66a6d54dab30c1c18e9afd7d3f299_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/huang-qiang-14-64"><meta itemprop="zhihu:followerCount" content="34"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover231-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover231-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/huang-qiang-14-64"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/1cc66a6d54dab30c1c18e9afd7d3f299_xs.jpg" srcset="https://pic3.zhimg.com/1cc66a6d54dab30c1c18e9afd7d3f299_l.jpg 2x" alt="麦田捕手"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover232-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover232-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/huang-qiang-14-64">麦田捕手</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">努力做一个全栈开发工程师</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">3 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="3"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/93796167"><meta itemprop="dateCreated" content="2016-04-05T08:23:36.000Z"><meta itemprop="dateModified" content="2016-04-05T08:23:36.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">loop里，主线程会不停的去消息队列里取消息，如果队列为空就阻塞线程，thread.sleep，交出cpu占用，当别的线程添加消息时，会唤醒主线程，这时候，主线程会去消息队列把新加的消息取出来执行，执行完毕就继续沉睡</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/93796167"><span data-tooltip="发布于 2016-04-05 16:23">发布于 2016-04-05</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 3" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 3</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover252-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover252-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover253-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover253-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="22" data-zop="{&quot;authorName&quot;:&quot;小高&quot;,&quot;itemId&quot;:89633256,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="89633256" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="22" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;89633256&quot;,&quot;upvote_num&quot;:3,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;b3dfc89f26a8aff0803b2b0d88014f68&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="小高"><meta itemprop="image" content="https://pic3.zhimg.com/47d8c1d229b9fab9d4be530a67ccea70_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/xiaogao2015"><meta itemprop="zhihu:followerCount" content="10"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover235-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover235-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/xiaogao2015"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/47d8c1d229b9fab9d4be530a67ccea70_xs.jpg" srcset="https://pic3.zhimg.com/47d8c1d229b9fab9d4be530a67ccea70_l.jpg 2x" alt="小高"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover236-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover236-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/xiaogao2015">小高</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">3 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="3"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/89633256"><meta itemprop="dateCreated" content="2016-03-07T09:03:14.000Z"><meta itemprop="dateModified" content="2016-03-17T09:59:29.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">ActivityThread.java 的 main 函数是应用的入口，所以，直接看 ActiivtyThread.java 的 main 方法的最后。looper.loop() 是这样被调用的：<br><div class="highlight"><pre><code class="language-text">        // End of event ActivityThreadMain.
        Trace.traceEnd(Trace.TRACE_TAG_ACTIVITY_MANAGER);
        Looper.loop();

        throw new RuntimeException("Main thread loop unexpectedly exited");</code></pre></div><p>如题主所说 Looper.loop() 的内部有一个无限的循环，只要应用一直在跑，Looper.loop() 的循环就不会跳出来。由上面的代码可知，如果从 Looper.loop() 的循环跳出来，会抛出「<b>主线程循环异常退出</b>」（'<b>Main thread loop unexpectedly exited</b>'）的异常。</p>Android 的应用是由事件驱动的，looper.loop() 不断地接收事件、处理事件，每一个应用都是运行在 Looper.loop() 的控制之下，如果它停止了，应用也就停止了。只能是某一个应用阻塞 Looper.loop()，而不是 Looper.loop() 阻塞应用。</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/89633256"><span data-tooltip="发布于 2016-03-07 17:03">编辑于 2016-03-17</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 3" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 3</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover280-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover280-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover281-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover281-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="23" data-zop="{&quot;authorName&quot;:&quot;Kelvin wu&quot;,&quot;itemId&quot;:59698428,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="59698428" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="23" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;59698428&quot;,&quot;upvote_num&quot;:3,&quot;comment_num&quot;:3,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;d94c47a1536a5d4425dbc1d2d81daf04&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Kelvin wu"><meta itemprop="image" content="https://pic4.zhimg.com/daa43e213c8c449a5e2c128180312af9_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/kelvin_love_wmy"><meta itemprop="zhihu:followerCount" content="237"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover239-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover239-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/kelvin_love_wmy"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/daa43e213c8c449a5e2c128180312af9_xs.jpg" srcset="https://pic4.zhimg.com/daa43e213c8c449a5e2c128180312af9_l.jpg 2x" alt="Kelvin wu"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover240-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover240-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/kelvin_love_wmy">Kelvin wu</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">欢迎关注我的专栏https://zhuanlan.zhihu.com/kelvin-love-wmy</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">3 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="3"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/59698428"><meta itemprop="dateCreated" content="2015-08-18T01:32:03.000Z"><meta itemprop="dateModified" content="2015-08-18T01:32:03.000Z"><meta itemprop="commentCount" content="3"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">大概的意思是，OnCreate等activity的生命周期函数都是由AMS（ActivityManagerService）通过往ApplicationThread这个binder上发消息，然后往MainLooper的messagequeue上发消息，主线程取出消息来执行这些生命周期的。<br>当MainLooper的messagequeue为空时，也可以注册idlehandler去执行空转，也就是没有消息是执行一种空闲时的动作。<br>如果涉及到UI的更新，会使用异步消息，平时我们handler发送得消息都是同步消息。异步消息的大概意思就是messagequeue查找的时候会跳过前面所有的同步消息，直接去取异步的来执行，这样就保证了UI更新的即时性，优先被主线程处理，</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/59698428"><span data-tooltip="发布于 2015-08-18 09:32">发布于 2015-08-18</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 3" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 3</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>3 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover285-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover285-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover286-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover286-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="24" data-zop="{&quot;authorName&quot;:&quot;匿名用户&quot;,&quot;itemId&quot;:140573908,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="140573908" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="24" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;140573908&quot;,&quot;upvote_num&quot;:2,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;0&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="匿名用户"><meta itemprop="image" content="https://pic1.zhimg.com/aadd7b895_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/"><meta itemprop="zhihu:followerCount" content="0"><span class="UserLink AuthorInfo-avatarWrapper"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/aadd7b895_xs.jpg" srcset="https://pic1.zhimg.com/aadd7b895_l.jpg 2x" alt="匿名用户"></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name">匿名用户</span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">2 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="2"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/140573908"><meta itemprop="dateCreated" content="2017-01-12T06:20:07.000Z"><meta itemprop="dateModified" content="2017-01-12T06:20:07.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]"><p>这个问题可以去看看深入理解Android卷三关于IMS的章节，了解下linux下的epoll和inotify机制。其实整个Java层都是表面上的东西，很多关键的东西都在native层，Java层只是持有native的钥匙，像binder，ui渲染，Looper，管道机制等实现。</p></span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/140573908"><span data-tooltip="发布于 2017-01-12 14:20">发布于 2017-01-12</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 2" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 2</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover288-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover288-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover289-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover289-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="25" data-zop="{&quot;authorName&quot;:&quot;Zhu Huang&quot;,&quot;itemId&quot;:64907897,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="64907897" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="25" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;64907897&quot;,&quot;upvote_num&quot;:2,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;c357481e604a3a0c5b09504829f48923&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Zhu Huang"><meta itemprop="image" content="https://pic3.zhimg.com/3d3206f7173e3a890a58c56b97dd37bd_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/zhu-huang-45"><meta itemprop="zhihu:followerCount" content="107"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover259-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover259-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/zhu-huang-45"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/3d3206f7173e3a890a58c56b97dd37bd_xs.jpg" srcset="https://pic3.zhimg.com/3d3206f7173e3a890a58c56b97dd37bd_l.jpg 2x" alt="Zhu Huang"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover260-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover260-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/zhu-huang-45">Zhu Huang</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">2 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="2"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/64907897"><meta itemprop="dateCreated" content="2015-09-23T12:34:16.000Z"><meta itemprop="dateModified" content="2015-09-23T12:34:16.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">只要处理message的各种操作不是耗时操作就不会卡死。<br>至于oncreat,onstart主线程运行, 本质也是系统级别service, Ams, 通过binder发消息到activitythread的消息队列实现的。</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/64907897"><span data-tooltip="发布于 2015-09-23 20:34">发布于 2015-09-23</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 2" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 2</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover291-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover291-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover292-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover292-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="26" data-zop="{&quot;authorName&quot;:&quot;李某某&quot;,&quot;itemId&quot;:59634995,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="59634995" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="26" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;59634995&quot;,&quot;upvote_num&quot;:2,&quot;comment_num&quot;:1,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;eb9a86faa155713e1760ccd8c2e40827&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="李某某"><meta itemprop="image" content="https://pic4.zhimg.com/08f1bf91192d7d8b602131214d432840_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/li-gan-80"><meta itemprop="zhihu:followerCount" content="26"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover263-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover263-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/li-gan-80"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/08f1bf91192d7d8b602131214d432840_xs.jpg" srcset="https://pic4.zhimg.com/08f1bf91192d7d8b602131214d432840_l.jpg 2x" alt="李某某"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover264-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover264-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/li-gan-80">李某某</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">一个屌丝的自我修养</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">2 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="2"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/59634995"><meta itemprop="dateCreated" content="2015-08-17T11:36:56.000Z"><meta itemprop="dateModified" content="2015-08-17T11:36:56.000Z"><meta itemprop="commentCount" content="1"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">你说的卡死，是OOM,stackoverflow,还是ANR?</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/59634995"><span data-tooltip="发布于 2015-08-17 19:36">发布于 2015-08-17</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 2" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 2</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>1 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover294-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover294-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover295-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover295-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="27" data-zop="{&quot;authorName&quot;:&quot;黄洪清&quot;,&quot;itemId&quot;:182045726,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="182045726" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="27" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;182045726&quot;,&quot;upvote_num&quot;:2,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;3fd24214df778e8c7bd942744dd0f559&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="黄洪清"><meta itemprop="image" content="https://pic4.zhimg.com/da8e974dc_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/huang-hong-qing-74"><meta itemprop="zhihu:followerCount" content="11"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover267-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover267-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/huang-hong-qing-74"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/da8e974dc_xs.jpg" srcset="https://pic4.zhimg.com/da8e974dc_l.jpg 2x" alt="黄洪清"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover268-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover268-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/huang-hong-qing-74">黄洪清</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">IT工程师</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">2 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="2"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/182045726"><meta itemprop="dateCreated" content="2017-06-11T02:28:42.000Z"><meta itemprop="dateModified" content="2017-06-11T06:47:25.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]"><p>包括Linux,iOS, Windows ,Android 所用的图形界面程序(包括服务器程序), 都有一个无限循环.</p><p><b>为什么? 用简单的思维想一下</b></p><p><b>没有无限循环,程序运行一段时间后必然自动退出.</b></p><p>无限循环里通常会在虚拟IO文件的读操作上<b>阻塞</b>一下, 让出CPU.</p><p>(这个阻塞很重要,不然就独占CPU了,这个阻塞不会影响性能,操作系统内核级的支持)</p><p>Android 的 Looper  只是一个JAVA语言的实现方式.</p><br><p>以前研究PHP-FPM 源码写过一边文章:</p><a href="https://link.zhihu.com/?target=http%3A//www.jianshu.com/p/3bd0aef2f2b7" class=" wrap external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043">PHP FPM源代码反刍品味之一：无限运行程序</a><p>摘录如下:</p><blockquote>无线循环里：
1，获取阻塞超时时间（依据下一个定时任务），
2，阻塞等待IO事件，
3，处理IO事件，
4，处理定时任务。
周而复始，不停运行，这可以说是服务器和图形界面程序设计的一个套路。
了解了这个套路，研究无限程序源代码就不会陌生。</blockquote><p>这个逻辑结构, 和Android 的 Looper 简直可以说是一模一样.</p><p>无线循环里,通常会顺带着处理下定时任务,这个不是必须的,只是顺手牵羊带来的福利.</p><p>没有定时任务逻辑,程序依旧可以运行.</p><p>但无限循环,和循环里阻塞一下的逻辑是必须的,</p><p>这个无限循环很通用,通常在GUI框架或库里实现了,不用开发者开发.</p><p>如果不使用任何框架或是操作系统GUI库,开发图形界面程序,就要自己编写这个无限循环逻辑.</p><p><b>试想一下,如果不使用任何框架或是操作系统GUI库,如何开发一个图形界面程序?</b></p><p>这是个很大的话题,这里用个简单的例子说明.</p><blockquote>要求开发一个图形界面程序,把屏幕大小的png 图片,显示在屏幕上,用户双击图片时,图片由彩色变成黑白的, 点击右上角时,程序退出</blockquote><p>我们首先把png 图片转化为BMP 格式, 贴到屏幕上, 程序运行这里时,不知用户何时点击,没事做了, 如果没有无限循环,程序就退出了.</p><p>要程序等待用户点击, 通常创建一个pipe通道, 一端可读,一端可写的虚拟文件</p><p>在无限循环里反复读取这个通道, 而用户的操作,转化为信号,写到通道里. 写入的内容可以是约定的代号, 就是让读取端知道有事件触发.</p><p>这是简单也最基本的逻辑.</p><br><p>抛开编程,IT, 假设你不懂编程,用简单的头脑想一下,反而很容易理解.</p><p>地铁上的列车要一直运行,必然要循环,不然再远的路程都有到达目的地的时候.</p><p>当然没乘客的时候就停一下,让出资源,也省电节能.</p><p>大道至简</p></span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/182045726"><span data-tooltip="发布于 2017-06-11 10:28">编辑于 2017-06-11</span></a></div></div><div class="ContentItem-actions RichContent-actions"><span><button aria-label="赞同 2" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 2</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover474-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover474-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover475-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover475-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div><button data-zop-retract-question="true" type="button" class="Button ContentItem-action ContentItem-rightButton Button--plain"><span class="RichContent-collapsedText">收起</span><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--ArrowDown ContentItem-arrowIcon is-active" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M12 13L8.285 9.218a.758.758 0 0 0-1.064 0 .738.738 0 0 0 0 1.052l4.249 4.512a.758.758 0 0 0 1.064 0l4.246-4.512a.738.738 0 0 0 0-1.052.757.757 0 0 0-1.063 0L12.002 13z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="28" data-zop="{&quot;authorName&quot;:&quot;初阳&quot;,&quot;itemId&quot;:281045662,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="281045662" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="28" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;281045662&quot;,&quot;upvote_num&quot;:1,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;c672da0976af5c859bbf254970954769&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="初阳"><meta itemprop="image" content="https://pic1.zhimg.com/v2-0285c7440e9deaef6f7374bc42707a6e_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/feng-qi-shi-9"><meta itemprop="zhihu:followerCount" content="2"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover271-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover271-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/feng-qi-shi-9"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-0285c7440e9deaef6f7374bc42707a6e_xs.jpg" srcset="https://pic1.zhimg.com/v2-0285c7440e9deaef6f7374bc42707a6e_l.jpg 2x" alt="初阳"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover272-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover272-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/feng-qi-shi-9">初阳</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">有女朋友的程序猿。</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">1 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="1"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/281045662"><meta itemprop="dateCreated" content="2017-12-22T07:01:36.000Z"><meta itemprop="dateModified" content="2017-12-22T07:01:36.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]"><p>简单点说Looper.loop()阻塞，ActivityThread的内部类H extends Handler，用的主线程的MainLooper，</p><p>Activity的生命周期都是在H这个Handler的handleMessage中调用的。<br>外部Binder调用发送消息给到主线程执行生命周期方法。</p><p>ApplicationThreadNative <br>@Override<br>public boolean onTransact(int code, Parcel data, Parcel reply, int flags)<br>        throws RemoteException {<br>    switch (code) {<br>    case SCHEDULE_PAUSE_ACTIVITY_TRANSACTION:<br>    {<br>        data.enforceInterface(IApplicationThread.<b><i>descriptor</i></b>);<br>        IBinder b = data.readStrongBinder();<br>        boolean finished = data.readInt() != 0;<br>        boolean userLeaving = data.readInt() != 0;<br>        int configChanges = data.readInt();<br>        boolean dontReport = data.readInt() != 0;<br>        schedulePauseActivity(b, finished, userLeaving, configChanges, dontReport);<br>        return true;<br>...</p><p>} </p><p></p></span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/281045662"><span data-tooltip="发布于 2017-12-22 15:01">发布于 2017-12-22</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 1" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 1</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover328-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover328-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover329-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover329-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="29" data-zop="{&quot;authorName&quot;:&quot;木质的旋律&quot;,&quot;itemId&quot;:194150008,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="194150008" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="29" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;194150008&quot;,&quot;upvote_num&quot;:1,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;52f8fc471a2408424013f73035cedb39&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="木质的旋律"><meta itemprop="image" content="https://pic4.zhimg.com/98948bf2c_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/mooolv"><meta itemprop="zhihu:followerCount" content="54"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover275-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover275-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/mooolv"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/98948bf2c_xs.jpg" srcset="https://pic4.zhimg.com/98948bf2c_l.jpg 2x" alt="木质的旋律"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover276-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover276-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/mooolv">木质的旋律</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">Android/iOS高级工程师</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">1 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="1"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/194150008"><meta itemprop="dateCreated" content="2017-07-05T15:57:16.000Z"><meta itemprop="dateModified" content="2017-07-05T15:57:17.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">阻塞的时候没有可执行的消息，有可执行的消息时必定不在阻塞状态。所以主线程看起来不会被阻塞。</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/194150008"><span data-tooltip="发布于 2017-07-05 23:57">编辑于 2017-07-05</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 1" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 1</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover351-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover351-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover352-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover352-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="30" data-zop="{&quot;authorName&quot;:&quot;黑白&quot;,&quot;itemId&quot;:92699867,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="92699867" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="30" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;92699867&quot;,&quot;upvote_num&quot;:1,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;1a558ef52e3dafb48c6ee6cd650c8827&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="黑白"><meta itemprop="image" content="https://pic4.zhimg.com/8506e8919aad6cd4f069b53615e33f31_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/xu-yue-7-30"><meta itemprop="zhihu:followerCount" content="47"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover307-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover307-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/xu-yue-7-30"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/8506e8919aad6cd4f069b53615e33f31_xs.jpg" srcset="https://pic4.zhimg.com/8506e8919aad6cd4f069b53615e33f31_l.jpg 2x" alt="黑白"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover308-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover308-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/xu-yue-7-30">黑白</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">一只Android开发者。</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">1 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="1"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/92699867"><meta itemprop="dateCreated" content="2016-03-28T12:43:43.000Z"><meta itemprop="dateModified" content="2016-03-28T12:43:43.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">题主的问题当年我也有想过，但是后来我明白了，当你懂了Handler+Looper+MessageQueue机制后，就会知道Android为什么是基于事件驱动的。Android应用再启动完毕后便会进入一个死循环监听到来的事件（Message），而Android中几乎所有的系统的调用都是通过主线程的Handler发送Message，然后回调handleMessage.执行的，如果死循环退出了，也就不能响应各类事件了，所以应用程序也就退出了</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/92699867"><span data-tooltip="发布于 2016-03-28 20:43">发布于 2016-03-28</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 1" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 1</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover354-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover354-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover355-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover355-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="31" data-zop="{&quot;authorName&quot;:&quot;Coder Robin&quot;,&quot;itemId&quot;:59572566,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="59572566" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="31" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;59572566&quot;,&quot;upvote_num&quot;:1,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;ee240c2902890aa8b4c2bfa67d949665&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Coder Robin"><meta itemprop="image" content="https://pic2.zhimg.com/92e57bdfa_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/robin.ren"><meta itemprop="zhihu:followerCount" content="112"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover311-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover311-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/robin.ren"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/92e57bdfa_xs.jpg" srcset="https://pic2.zhimg.com/92e57bdfa_l.jpg 2x" alt="Coder Robin"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover312-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover312-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/robin.ren">Coder Robin</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">android码农</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button type="button" class="Button Button--plain">1 人赞同了该回答</button></span></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="1"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/59572566"><meta itemprop="dateCreated" content="2015-08-17T04:12:48.000Z"><meta itemprop="dateModified" content="2015-08-17T04:19:11.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">从activitythread可以看到android的生命周期也就是主线程就是在这个消息循环里面执行。理解下生产者消费者模式。。</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/59572566"><span data-tooltip="发布于 2015-08-17 12:12">编辑于 2015-08-17</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 1" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同 1</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover382-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover382-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover383-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover383-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="32" data-zop="{&quot;authorName&quot;:&quot;周月玥&quot;,&quot;itemId&quot;:302674368,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="302674368" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="32" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;302674368&quot;,&quot;upvote_num&quot;:0,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;13ac61a8035d1a060f78e39246b65b93&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="周月玥"><meta itemprop="image" content="https://pic3.zhimg.com/v2-1c2470c7d6936846841f0a95497128b9_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/zhou-yue-yue-3"><meta itemprop="zhihu:followerCount" content="27"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover315-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover315-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/zhou-yue-yue-3"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-1c2470c7d6936846841f0a95497128b9_xs.jpg" srcset="https://pic3.zhimg.com/v2-1c2470c7d6936846841f0a95497128b9_l.jpg 2x" alt="周月玥"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover316-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover316-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/zhou-yue-yue-3">周月玥</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">一个热爱历史，数码的coder</div></div></div></div></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="0"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/302674368"><meta itemprop="dateCreated" content="2018-01-24T05:01:04.000Z"><meta itemprop="dateModified" content="2018-01-24T05:01:04.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]"><p>如果你不死循环的话，一个app在一段代码执行后就自动关闭了。其实app的生命周期都是在looper这个死循环中控制的。</p></span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/302674368"><span data-tooltip="发布于 2018-01-24 13:01">发布于 2018-01-24</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 0" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover426-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover426-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover427-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover427-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="33" data-zop="{&quot;authorName&quot;:&quot;jack&quot;,&quot;itemId&quot;:158378846,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="158378846" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="33" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;158378846&quot;,&quot;upvote_num&quot;:0,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;40d19c48675feebc0498effea0ee41b2&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="jack"><meta itemprop="image" content="https://pic4.zhimg.com/da8e974dc_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/jack-42-97-4"><meta itemprop="zhihu:followerCount" content="14"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover319-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover319-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/jack-42-97-4"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/da8e974dc_xs.jpg" srcset="https://pic4.zhimg.com/da8e974dc_l.jpg 2x" alt="jack"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover320-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover320-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/jack-42-97-4">jack</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">惨品射鸡师</div></div></div></div></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="0"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/158378846"><meta itemprop="dateCreated" content="2017-04-20T00:23:48.000Z"><meta itemprop="dateModified" content="2017-04-20T00:23:49.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">queue.next(); //might block<br>——关键就是这里了，消息处理完是会block的。</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/158378846"><span data-tooltip="发布于 2017-04-20 08:23">编辑于 2017-04-20</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 0" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover429-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover429-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover430-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover430-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="34" data-zop="{&quot;authorName&quot;:&quot;asdgbc&quot;,&quot;itemId&quot;:158013909,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="158013909" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="34" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;158013909&quot;,&quot;upvote_num&quot;:0,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;2daa93a96b1392b9286281f7e31af9d8&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="asdgbc"><meta itemprop="image" content="https://pic4.zhimg.com/v2-86d9ae4b0bee883b9b566f5bd55584a9_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/chen-xue-xing"><meta itemprop="zhihu:followerCount" content="9"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover323-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover323-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/chen-xue-xing"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-86d9ae4b0bee883b9b566f5bd55584a9_xs.jpg" srcset="https://pic4.zhimg.com/v2-86d9ae4b0bee883b9b566f5bd55584a9_l.jpg 2x" alt="asdgbc"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover324-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover324-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/chen-xue-xing">asdgbc</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"></div></div></div></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="0"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/158013909"><meta itemprop="dateCreated" content="2017-04-18T16:09:25.000Z"><meta itemprop="dateModified" content="2017-04-18T16:09:25.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">死循环为什么会卡死呢？<br>在死循环里面不停的去刷新界面以及响应点击事件什么的不就好了</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/158013909"><span data-tooltip="发布于 2017-04-19 00:09">发布于 2017-04-19</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 0" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover432-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover432-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover433-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover433-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="35" data-zop="{&quot;authorName&quot;:&quot;安吉尼亚鹰啄樱&quot;,&quot;itemId&quot;:157879827,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="157879827" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="35" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;157879827&quot;,&quot;upvote_num&quot;:0,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;4d29ce0661de0abc727ab02fd2ccab79&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="安吉尼亚鹰啄樱"><meta itemprop="image" content="https://pic4.zhimg.com/da8e974dc_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/huacaitu"><meta itemprop="zhihu:followerCount" content="16"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover361-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover361-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/huacaitu"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/da8e974dc_xs.jpg" srcset="https://pic4.zhimg.com/da8e974dc_l.jpg 2x" alt="安吉尼亚鹰啄樱"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover362-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover362-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/huacaitu">安吉尼亚鹰啄樱</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">前Android负优化工程狮/现小法师/刀狗</div></div></div></div></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="0"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/157879827"><meta itemprop="dateCreated" content="2017-04-18T04:29:44.000Z"><meta itemprop="dateModified" content="2017-04-18T04:29:44.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">我的理解是<br>因为这就是你写不阻塞主线程代码所要保护的东西啊</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/157879827"><span data-tooltip="发布于 2017-04-18 12:29">发布于 2017-04-18</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 0" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover435-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover435-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover436-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover436-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="36" data-zop="{&quot;authorName&quot;:&quot;区汇君&quot;,&quot;itemId&quot;:145521728,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="145521728" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="36" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;145521728&quot;,&quot;upvote_num&quot;:0,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;7524560aa63d0b2c52074833b5fdfe89&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="区汇君"><meta itemprop="image" content="https://pic3.zhimg.com/v2-48f5c4246d4a4f08d94e2df70fd77766_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/ouhuijun"><meta itemprop="zhihu:followerCount" content="1"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover365-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover365-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/ouhuijun"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-48f5c4246d4a4f08d94e2df70fd77766_xs.jpg" srcset="https://pic3.zhimg.com/v2-48f5c4246d4a4f08d94e2df70fd77766_l.jpg 2x" alt="区汇君"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover366-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover366-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/ouhuijun">区汇君</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">@ppjun</div></div></div></div></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="0"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/145521728"><meta itemprop="dateCreated" content="2017-02-10T02:15:12.000Z"><meta itemprop="dateModified" content="2017-02-11T01:44:24.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">1. ActivityThread 的main方法调用了做的操作主要有<br><ul><li>创建MessageQueue消息队列，Thread主线程和Looper对象 Looper.prepareMainLooper(); <br></li><li>实例化ActivityThread对象，和他的两个内部类<b>H</b> 和<b>ApplicationThread</b>。分别用来处理信息和发送信息。<br></li><li>消息队列操作Looper.loop();，然后在loop方法一直检查队列里面有没有message 。有就在handler执行操作，没就一直处于sleep状态，这时候主线程阻塞。<br></li></ul>2. 首先ActivityThread是一个普通的final类 里面有个H的内部类继承了handler 那么就有handleMessage方法来处理信息，如果退出信息循环 你的程序也会退出，还有linux的<b>epoll机制</b>，但没信息来就一直wait，等待MessageQueue队列有消息了 ，handle的来处理信息，这时候会阻塞，但是不会卡死。<br>3. 还有一个内部类ApplicationThread，里面的Binder线程负责和系统进程比如ActivityManagerService来交换信息。从而sendMessage到H这个Handler内部类操作activity的生命周期。<br>4. 线程执行完了就会停止，主线程也是线程需要有代码一直执行比如调用Looper.loop()，直到退出app。</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/145521728"><span data-tooltip="发布于 2017-02-10 10:15">编辑于 2017-02-11</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 0" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover438-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover438-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover439-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover439-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="37" data-zop="{&quot;authorName&quot;:&quot;王月半子&quot;,&quot;itemId&quot;:93044767,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="93044767" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="37" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;93044767&quot;,&quot;upvote_num&quot;:0,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;d413863d4ac6552e9e7a541c00b031c1&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="王月半子"><meta itemprop="image" content="https://pic4.zhimg.com/v2-7089740f22fb2829d1426ea1b33372e6_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/wang-yue-ban-zi-30"><meta itemprop="zhihu:followerCount" content="0"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover369-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover369-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/wang-yue-ban-zi-30"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-7089740f22fb2829d1426ea1b33372e6_xs.jpg" srcset="https://pic4.zhimg.com/v2-7089740f22fb2829d1426ea1b33372e6_l.jpg 2x" alt="王月半子"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover370-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover370-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/wang-yue-ban-zi-30">王月半子</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">就爱看知乎</div></div></div></div></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="0"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/93044767"><meta itemprop="dateCreated" content="2016-03-31T01:48:42.000Z"><meta itemprop="dateModified" content="2016-03-31T01:48:42.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">赞赞赞。<br>不过有一点想请教楼主，您在文中提到：”每个App进程中至少会有两个binder线程 ApplicationThread(简称AT)和ActivityManagerProxy（简称AMP）“我写了一个activity测试如下图<figure><noscript>&amp;lt;img src="https://pic4.zhimg.com/50/3b23e50ddb86053489eded31f65102d8_hd.jpg" data-rawwidth="579" data-rawheight="231" class="origin_image zh-lightbox-thumb" width="579" data-original="https://pic4.zhimg.com/3b23e50ddb86053489eded31f65102d8_r.jpg"/&amp;gt;</noscript><img src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/3b23e50ddb86053489eded31f65102d8_hd.jpg" data-rawwidth="579" data-rawheight="231" class="origin_image zh-lightbox-thumb lazy" width="579" data-original="https://pic4.zhimg.com/3b23e50ddb86053489eded31f65102d8_r.jpg" data-actualsrc="https://pic4.zhimg.com/50/3b23e50ddb86053489eded31f65102d8_hd.jpg"></figure>的确是有很多线程，其中是有两个binder线程，但是据我所知App主线程在于WMS打交道的时候主线程也会创建一个binder对象即ViewRoot.W，用来与WMS通信。您所说的AMP内部有的仅仅是个binder的引用。</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/93044767"><span data-tooltip="发布于 2016-03-31 09:48">发布于 2016-03-31</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 0" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover441-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover441-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover442-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover442-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="38" data-zop="{&quot;authorName&quot;:&quot;小林&quot;,&quot;itemId&quot;:68904149,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="68904149" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="38" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;68904149&quot;,&quot;upvote_num&quot;:0,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;f799384f8fb8068743135fe1bb266b26&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="小林"><meta itemprop="image" content="https://pic4.zhimg.com/da8e974dc_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/gu-xiao-lin-29"><meta itemprop="zhihu:followerCount" content="19"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover373-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover373-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/gu-xiao-lin-29"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/da8e974dc_xs.jpg" srcset="https://pic4.zhimg.com/da8e974dc_l.jpg 2x" alt="小林"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover374-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover374-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/gu-xiao-lin-29">小林</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">程序员</div></div></div></div></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="0"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/68904149"><meta itemprop="dateCreated" content="2015-10-22T11:44:46.000Z"><meta itemprop="dateModified" content="2015-10-22T11:44:46.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">正常卡epull那里，三年就遇到一次，epull出错直接返回，然后没有判断返回值，那么就是楼主说的事了.</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/68904149"><span data-tooltip="发布于 2015-10-22 19:44">发布于 2015-10-22</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 0" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover444-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover444-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover445-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover445-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="39" data-zop="{&quot;authorName&quot;:&quot;myjfm&quot;,&quot;itemId&quot;:61504487,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="61504487" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="39" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;61504487&quot;,&quot;upvote_num&quot;:0,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;cca9e1483f3f3902cf657f066082f416&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="myjfm"><meta itemprop="image" content="https://pic4.zhimg.com/04bc8e19aebe0c881bdec6070f645d7d_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/jeff-yang-37"><meta itemprop="zhihu:followerCount" content="255"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover377-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover377-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/jeff-yang-37"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/04bc8e19aebe0c881bdec6070f645d7d_xs.jpg" srcset="https://pic4.zhimg.com/04bc8e19aebe0c881bdec6070f645d7d_l.jpg 2x" alt="myjfm"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover378-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover378-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/jeff-yang-37">myjfm</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">蜗居北京的互联网狗</div></div></div></div></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="0"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/61504487"><meta itemprop="dateCreated" content="2015-08-30T07:04:20.000Z"><meta itemprop="dateModified" content="2015-08-30T07:04:20.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">注释里不是写的清清楚楚吗？might block</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/61504487"><span data-tooltip="发布于 2015-08-30 15:04">发布于 2015-08-30</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 0" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover455-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover455-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover456-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover456-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="40" data-zop="{&quot;authorName&quot;:&quot;Mark&quot;,&quot;itemId&quot;:59816359,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="59816359" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="40" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;59816359&quot;,&quot;upvote_num&quot;:0,&quot;comment_num&quot;:1,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;1f701b8c29a22a0a9ce285df9d5497dc&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Mark"><meta itemprop="image" content="https://pic4.zhimg.com/e9be87f6f29ba08da7c94ad7faf76fc9_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/CoMark"><meta itemprop="zhihu:followerCount" content="39"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover391-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover391-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/CoMark"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/e9be87f6f29ba08da7c94ad7faf76fc9_xs.jpg" srcset="https://pic4.zhimg.com/e9be87f6f29ba08da7c94ad7faf76fc9_l.jpg 2x" alt="Mark"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover392-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover392-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/CoMark">Mark</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"></div></div></div></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="0"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/59816359"><meta itemprop="dateCreated" content="2015-08-18T15:22:50.000Z"><meta itemprop="dateModified" content="2015-08-18T15:22:50.000Z"><meta itemprop="commentCount" content="1"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]">当年我还在思考，windows的窗口绘制为什么不会导致电脑死机。后来知道主线程负责事件和消息的生产，消息和UI绘制线程负责消费，没事你就可以睡觉，有事老板会叫醒你的。</span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/59816359"><span data-tooltip="发布于 2015-08-18 23:22">发布于 2015-08-18</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 0" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>1 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover464-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover464-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover465-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover465-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="41" data-zop="{&quot;authorName&quot;:&quot;叽哩叽哩鸡&quot;,&quot;itemId&quot;:534744299,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="534744299" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="41" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;534744299&quot;,&quot;upvote_num&quot;:0,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;05e6deebdd9aeea103a7fe310791ece2&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="叽哩叽哩鸡"><meta itemprop="image" content="https://pic1.zhimg.com/v2-9a2fb5a7bb61370d3ec64f98310dd94c_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/ji-li-ji-li-ji"><meta itemprop="zhihu:followerCount" content="2"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover395-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover395-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/ji-li-ji-li-ji"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-9a2fb5a7bb61370d3ec64f98310dd94c_xs.jpg" srcset="https://pic1.zhimg.com/v2-9a2fb5a7bb61370d3ec64f98310dd94c_l.jpg 2x" alt="叽哩叽哩鸡"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover396-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover396-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/ji-li-ji-li-ji">叽哩叽哩鸡</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">远离垃圾人</div></div></div></div></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="0"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/534744299"><meta itemprop="dateCreated" content="2018-11-19T09:21:27.000Z"><meta itemprop="dateModified" content="2018-11-19T09:21:27.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]"><p>???</p><p class="ztext-empty-paragraph"><br></p><p>主线程的 Looper 就是handle界面Message、不让界面卡死的， 你不loop()反而会卡的死死地</p></span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/534744299"><span data-tooltip="发布于 2018-11-19 17:21">发布于 2018-11-19</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 0" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover461-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover461-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover462-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover462-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="42" data-zop="{&quot;authorName&quot;:&quot;Gibbon Zhuo&quot;,&quot;itemId&quot;:533218084,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="533218084" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="42" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;533218084&quot;,&quot;upvote_num&quot;:0,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;0b6d603322c08183cdf70e459cb173e5&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Gibbon Zhuo"><meta itemprop="image" content="https://pic4.zhimg.com/v2-6481de6b56660d3a2cf37c9720e3596e_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/gibbon-zhuo"><meta itemprop="zhihu:followerCount" content="2"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover399-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover399-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/gibbon-zhuo"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-6481de6b56660d3a2cf37c9720e3596e_xs.jpg" srcset="https://pic4.zhimg.com/v2-6481de6b56660d3a2cf37c9720e3596e_l.jpg 2x" alt="Gibbon Zhuo"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover400-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover400-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/gibbon-zhuo">Gibbon Zhuo</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"></div></div></div></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="0"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/533218084"><meta itemprop="dateCreated" content="2018-11-17T03:25:47.000Z"><meta itemprop="dateModified" content="2018-11-17T03:25:47.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]"><p>为什么回答这个问题不从何为主线程卡死，何为ANR，ANR什么情况下会发生呢？</p><p>实际上主线程（UI线程）维护了和system_<i>server间的通信交互、当system_server给UI线程发信息的时候，system_server像个监工一样，希望你在特定的场合（比如广播10s）、特定时间内完成、否则它就不客气了，给你抛出ANR警告。而system_server给UI线程发信息，自然是希望你及时接收并处理，那从哪里接收处理，不就是looper.loop循环处理消息的。这样不就可以说明为啥不会卡死了，因为实际上就是要这么处理消息。至于详细的细节，就如其他答主描述。</i></p></span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/533218084"><span data-tooltip="发布于 2018-11-17 11:25">发布于 2018-11-17</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 0" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover458-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover458-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover459-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover459-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="43" data-zop="{&quot;authorName&quot;:&quot;墨辰lyb&quot;,&quot;itemId&quot;:487871994,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="487871994" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="43" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;487871994&quot;,&quot;upvote_num&quot;:0,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;2a07bafb8e635060e2463aa0dc0f02f9&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="墨辰lyb"><meta itemprop="image" content="https://pic3.zhimg.com/v2-a04c5906f2cc18342f48d71f423b76de_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/mo-chen-lyb"><meta itemprop="zhihu:followerCount" content="0"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover403-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover403-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/mo-chen-lyb"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-a04c5906f2cc18342f48d71f423b76de_xs.jpg" srcset="https://pic3.zhimg.com/v2-a04c5906f2cc18342f48d71f423b76de_l.jpg 2x" alt="墨辰lyb"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover404-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover404-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/mo-chen-lyb">墨辰lyb</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">程序员</div></div></div></div></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="0"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/487871994"><meta itemprop="dateCreated" content="2018-09-08T11:57:00.000Z"><meta itemprop="dateModified" content="2018-09-08T11:57:00.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]"><p>真正会卡死主线程的操作是在回调方法onCreate/onStart/onResume等操作时间过长，会导致掉帧，甚至发生ANR，looper.loop本身不会导致应用卡死。这句话就可以解释了吧，嘻嘻</p></span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/487871994"><span data-tooltip="发布于 2018-09-08 19:57">发布于 2018-09-08</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 0" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover467-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover467-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover468-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover468-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div class="List-item" tabindex="0"><div class="ContentItem AnswerItem" data-za-index="44" data-zop="{&quot;authorName&quot;:&quot;千锋教育&quot;,&quot;itemId&quot;:125858977,&quot;title&quot;:&quot;Android中为什么主线程不会因为Looper.loop()里的死循环卡死？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="125858977" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope="" data-za-detail-view-path-module="AnswerItem" data-za-detail-view-path-index="44" data-za-extra-module="{&quot;card&quot;:{&quot;has_image&quot;:false,&quot;has_video&quot;:false,&quot;content&quot;:{&quot;type&quot;:&quot;Answer&quot;,&quot;token&quot;:&quot;125858977&quot;,&quot;upvote_num&quot;:0,&quot;comment_num&quot;:0,&quot;publish_timestamp&quot;:null,&quot;parent_token&quot;:&quot;34652589&quot;,&quot;author_member_hash_id&quot;:&quot;fcd651a7016733abc33dcb8dde413f5e&quot;}}}"><div class="ContentItem-meta"><div class="AuthorInfo AnswerItem-authorInfo AnswerItem-authorInfo--related" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="千锋教育"><meta itemprop="image" content="https://pic4.zhimg.com/v2-ad979c0292fff5556f45dcd31deb1a29_is.jpg"><meta itemprop="url" content="https://www.zhihu.com/people/gong-cheng-shi-37-62"><meta itemprop="zhihu:followerCount" content="17"><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="Popover407-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover407-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/gong-cheng-shi-37-62"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-ad979c0292fff5556f45dcd31deb1a29_xs.jpg" srcset="https://pic4.zhimg.com/v2-ad979c0292fff5556f45dcd31deb1a29_l.jpg 2x" alt="千锋教育"></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="Popover408-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover408-content"><a class="UserLink-link" data-za-detail-view-element_name="User" target="_blank" href="https://www.zhihu.com/people/gong-cheng-shi-37-62">千锋教育</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText">做真实的自己</div></div></div></div></div></div><meta itemprop="image"><meta itemprop="upvoteCount" content="0"><meta itemprop="url" content="https://www.zhihu.com/question/34652589/answer/125858977"><meta itemprop="dateCreated" content="2016-10-10T05:36:10.000Z"><meta itemprop="dateModified" content="2016-10-10T05:36:10.000Z"><meta itemprop="commentCount" content="0"><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText ztext CopyrightRichText-richText" itemprop="text" ecommerce="[object Object]"><p>Handler类是用来发送和处理消息用的，而Looper类是用来存储消息队列以及处理消息循环的一个封装类。 UI线程本身已经实现了消息队列，所有可以直接创建Handler类 而自己创建的线程要实现消息处理，必须调用Looper.prepare()来创建消息队列以及其他一些步骤的初始化，再创建Handler，最后调用Looper.loop()实现消息循环。</p></span></div><div><div class="ContentItem-time"><a target="_blank" href="https://www.zhihu.com/question/34652589/answer/125858977"><span data-tooltip="发布于 2016-10-10 13:36">发布于 2016-10-10</span></a></div></div><div class="ContentItem-actions"><span><button aria-label="赞同 0" type="button" class="Button VoteButton VoteButton--up"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M2 18.242c0-.326.088-.532.237-.896l7.98-13.203C10.572 3.57 11.086 3 12 3c.915 0 1.429.571 1.784 1.143l7.98 13.203c.15.364.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H3.955c-1.08 0-1.955-.517-1.955-1.9z" fill-rule="evenodd"></path></svg></span>赞同</button><button aria-label="反对" type="button" class="Button VoteButton VoteButton--down"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--TriangleDown" fill="currentColor" viewBox="0 0 24 24" width="10" height="10"><path d="M20.044 3H3.956C2.876 3 2 3.517 2 4.9c0 .326.087.533.236.896L10.216 19c.355.571.87 1.143 1.784 1.143s1.429-.572 1.784-1.143l7.98-13.204c.149-.363.236-.57.236-.896 0-1.386-.876-1.9-1.956-1.9z" fill-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Comment Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M10.241 19.313a.97.97 0 0 0-.77.2 7.908 7.908 0 0 1-3.772 1.482.409.409 0 0 1-.38-.637 5.825 5.825 0 0 0 1.11-2.237.605.605 0 0 0-.227-.59A7.935 7.935 0 0 1 3 11.25C3 6.7 7.03 3 12 3s9 3.7 9 8.25-4.373 9.108-10.759 8.063z" fill-rule="evenodd"></path></svg></span>添加评论</button><div class="Popover ShareMenu ContentItem-action"><div class="ShareMenu-toggler" id="Popover470-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover470-content"><button type="button" class="Button Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Share Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2.931 7.89c-1.067.24-1.275 1.669-.318 2.207l5.277 2.908 8.168-4.776c.25-.127.477.198.273.39L9.05 14.66l.927 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.242c.584-.892-.212-2.029-1.234-1.796L2.93 7.89z" fill-rule="evenodd"></path></svg></span>分享</button></div></div><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Star Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action Button--plain Button--withIcon Button--withLabel"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Heart Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M2 8.437C2 5.505 4.294 3.094 7.207 3 9.243 3 11.092 4.19 12 6c.823-1.758 2.649-3 4.651-3C19.545 3 22 5.507 22 8.432 22 16.24 13.842 21 12 21 10.158 21 2 16.24 2 8.437z" fill-rule="evenodd"></path></svg></span>感谢</button><div class="Popover ContentItem-action"><button aria-label="更多" type="button" id="Popover471-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="Popover471-content" class="Button OptionsButton Button--plain Button--withIcon Button--iconOnly"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Dots Button-zi" fill="currentColor" viewBox="0 0 24 24" width="1.2em" height="1.2em"><path d="M5 14a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm7 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z" fill-rule="evenodd"></path></svg></span></button></div></div></div></div></div><div></div></div></div></div></div></div></div><div class="Card" data-za-detail-view-path-module="BottomBar" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:null}}"><button type="button" class="Button QuestionAnswers-answerButton Button--blue Button--spread"><svg viewBox="0 0 12 12" class="Icon QuestionButton-icon Button-icon Icon--modify" width="14" height="16" aria-hidden="true" style="height: 16px; width: 14px;"><title></title><g><path d="M.423 10.32L0 12l1.667-.474 1.55-.44-2.4-2.33-.394 1.564zM10.153.233c-.327-.318-.85-.31-1.17.018l-.793.817 2.49 2.414.792-.814c.318-.328.312-.852-.017-1.17l-1.3-1.263zM3.84 10.536L1.35 8.122l6.265-6.46 2.49 2.414-6.265 6.46z" fill-rule="evenodd"></path></g></svg>写回答</button></div><div class="CollapsedAnswers-bar"><button type="button" class="Button Button--plain">1 个回答被折叠</button>（<a target="_blank" type="button" class="Button Button--plain" href="https://www.zhihu.com/question/20120168">为什么？</a>）</div></div></div><div class="Question-sideColumn Question-sideColumn--sticky" data-za-detail-view-path-module="RightSideBar" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:null}}"><div><div class="Sticky is-fixed" style="width: 296px; top: -558px; left: 1155.5px;"><div class="Card"><div class="Pc-card Card"><a class="Banner-link" href="https://bj.ikongjian.com/ikj/20181017/01?&amp;utm_source=xxl&amp;utm_medium=zhihu&amp;utm_account=haoliang&amp;utm_page=pc016&amp;utm_keyword=hl097" target="_blank"><div class="Banner-adTag">广告</div><img class="Banner-image" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-450bb9209da8187e1a684de57193d8f3_540x450.jpeg" alt="广告"></a><div class="Pc-card-button-close " data-tooltip="不再显示" data-tooltip-position="bottom"><svg viewBox="0 0 12 12" class="Icon Icon--close Pc-card-button-close-svg "><path fill-rule="evenodd" d="M3 2L2 3l3 3-3 3 1 1 3-3 3 3 1-1-3-3 3-3-1-1-3 3"></path></svg></div></div></div><div class="Card" data-za-detail-view-path-module="RelatedQuestions" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:null}}"><div class="Card-header SimilarQuestions-title"><div class="Card-headerText">相关问题</div></div><div class="Card-section SimilarQuestions-list"><div class="SimilarQuestions-item" itemprop="zhihu:similarQuestion" itemtype="http://schema.org/Question" itemscope="" data-za-detail-view-path-module="QuestionItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Question&quot;,&quot;token&quot;:&quot;267207880&quot;}}}"><meta itemprop="name" content="关于Android Handler的一个问题,请问问题描述中的第二种写法是什么操作?"><meta itemprop="url" content="https://www.zhihu.com/question/267207880"><meta itemprop="answerCount" content="6"><meta itemprop="zhihu:followerCount" content="7"><a target="_blank" type="button" class="Button Button--plain" href="https://www.zhihu.com/question/267207880">关于Android Handler的一个问题,请问问题描述中的第二种写法是什么操作?</a> 6 个回答</div><div class="SimilarQuestions-item" itemprop="zhihu:similarQuestion" itemtype="http://schema.org/Question" itemscope="" data-za-detail-view-path-module="QuestionItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Question&quot;,&quot;token&quot;:&quot;30804052&quot;}}}"><meta itemprop="name" content="Android中的Thread与AsyncTask的区别?"><meta itemprop="url" content="https://www.zhihu.com/question/30804052"><meta itemprop="answerCount" content="7"><meta itemprop="zhihu:followerCount" content="554"><a target="_blank" type="button" class="Button Button--plain" href="https://www.zhihu.com/question/30804052">Android中的Thread与AsyncTask的区别?</a> 7 个回答</div><div class="SimilarQuestions-item" itemprop="zhihu:similarQuestion" itemtype="http://schema.org/Question" itemscope="" data-za-detail-view-path-module="QuestionItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Question&quot;,&quot;token&quot;:&quot;19818664&quot;}}}"><meta itemprop="name" content="android AsyncTask 怎么返回值给UI线程？"><meta itemprop="url" content="https://www.zhihu.com/question/19818664"><meta itemprop="answerCount" content="6"><meta itemprop="zhihu:followerCount" content="20"><a target="_blank" type="button" class="Button Button--plain" href="https://www.zhihu.com/question/19818664">android AsyncTask 怎么返回值给UI线程？</a> 6 个回答</div><div class="SimilarQuestions-item" itemprop="zhihu:similarQuestion" itemtype="http://schema.org/Question" itemscope="" data-za-detail-view-path-module="QuestionItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Question&quot;,&quot;token&quot;:&quot;29826231&quot;}}}"><meta itemprop="name" content="怎么让 Android 程序一直后台运行，像 QQ 一样不被杀死？"><meta itemprop="url" content="https://www.zhihu.com/question/29826231"><meta itemprop="answerCount" content="130"><meta itemprop="zhihu:followerCount" content="1933"><a target="_blank" type="button" class="Button Button--plain" href="https://www.zhihu.com/question/29826231">怎么让 Android 程序一直后台运行，像 QQ 一样不被杀死？</a> 130 个回答</div><div class="SimilarQuestions-item" itemprop="zhihu:similarQuestion" itemtype="http://schema.org/Question" itemscope="" data-za-detail-view-path-module="QuestionItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Question&quot;,&quot;token&quot;:&quot;37804956&quot;}}}"><meta itemprop="name" content="Android的App中线程池的使用，具体使用多少个线程池？"><meta itemprop="url" content="https://www.zhihu.com/question/37804956"><meta itemprop="answerCount" content="9"><meta itemprop="zhihu:followerCount" content="225"><a target="_blank" type="button" class="Button Button--plain" href="https://www.zhihu.com/question/37804956">Android的App中线程池的使用，具体使用多少个线程池？</a> 9 个回答</div></div></div><div class="Card" data-za-detail-view-path-module="ContentList" data-za-detail-view-path-module_name="相关推荐" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:null}}"><div class="Card-header RelatedCommodities-title"><div class="Card-headerText">相关推荐</div></div><div class="Card-section RelatedCommodities-list"><a target="_blank" href="https://www.zhihu.com/lives/840265585467207680" type="button" class="Button RelatedCommodities-item Button--plain" data-za-detail-view-path-module="LiveItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Live&quot;,&quot;id&quot;:&quot;840265585467207680&quot;,&quot;author_member_hash_id&quot;:&quot;13de39b981c8ada8131c0fbb212a7667&quot;}}}"><img class="RelatedCommodities-image" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-452c11ca50a5666eaff9a611d7eccce5_250x0.jpg" alt="live"><div class="RelatedCommodities-content"><div class="RelatedCommodities-subject" data-tooltip="Android 程序员的那些事">Android 程序员的那些事</div><div class="RelatedCommodities-description">singwhatiwanna</div><div class="RelatedCommodities-meta"><div class="RelatedCommodities-scoreWrapper"><div class="Rating"><svg viewBox="0 0 15 15" class="Icon Icon--rating" width="15" height="15" aria-hidden="true" style="margin-left: 0px; height: 15px; width: 15px;"><title></title><g><g fill-rule="evenodd">     <path fill="#ffab2e" d="M10.925 14.302c.173.13.408.13.58-.002.174-.13.244-.362.175-.572l-1.323-4.296 3.435-2.456c.175-.13.25-.36.185-.572-.064-.212-.253-.357-.468-.36H9.275L7.96 1.754c-.064-.21-.21-.354-.46-.354-.14 0-1.027 3.53-.988 6.32.04 2.788.98 3.85.98 3.85l3.433 2.732z"></path>     <path fill="#ffab2e" d="M7.5 1.4c-.25 0-.41.144-.474.354l-1.318 4.29H1.49c-.214.003-.403.148-.467.36-.065.212.01.442.185.572l3.42 2.463-1.307 4.286c-.066.21.004.44.176.572.172.13.407.132.58.003l3.42-2.734L7.5 1.4z">   </path></g></g></svg><svg viewBox="0 0 15 15" class="Icon Icon--rating" width="15" height="15" aria-hidden="true" style="margin-left: 0px; height: 15px; width: 15px;"><title></title><g><g fill-rule="evenodd">     <path fill="#ffab2e" d="M10.925 14.302c.173.13.408.13.58-.002.174-.13.244-.362.175-.572l-1.323-4.296 3.435-2.456c.175-.13.25-.36.185-.572-.064-.212-.253-.357-.468-.36H9.275L7.96 1.754c-.064-.21-.21-.354-.46-.354-.14 0-1.027 3.53-.988 6.32.04 2.788.98 3.85.98 3.85l3.433 2.732z"></path>     <path fill="#ffab2e" d="M7.5 1.4c-.25 0-.41.144-.474.354l-1.318 4.29H1.49c-.214.003-.403.148-.467.36-.065.212.01.442.185.572l3.42 2.463-1.307 4.286c-.066.21.004.44.176.572.172.13.407.132.58.003l3.42-2.734L7.5 1.4z">   </path></g></g></svg><svg viewBox="0 0 15 15" class="Icon Icon--rating" width="15" height="15" aria-hidden="true" style="margin-left: 0px; height: 15px; width: 15px;"><title></title><g><g fill-rule="evenodd">     <path fill="#ffab2e" d="M10.925 14.302c.173.13.408.13.58-.002.174-.13.244-.362.175-.572l-1.323-4.296 3.435-2.456c.175-.13.25-.36.185-.572-.064-.212-.253-.357-.468-.36H9.275L7.96 1.754c-.064-.21-.21-.354-.46-.354-.14 0-1.027 3.53-.988 6.32.04 2.788.98 3.85.98 3.85l3.433 2.732z"></path>     <path fill="#ffab2e" d="M7.5 1.4c-.25 0-.41.144-.474.354l-1.318 4.29H1.49c-.214.003-.403.148-.467.36-.065.212.01.442.185.572l3.42 2.463-1.307 4.286c-.066.21.004.44.176.572.172.13.407.132.58.003l3.42-2.734L7.5 1.4z">   </path></g></g></svg><svg viewBox="0 0 15 15" class="Icon Icon--rating" width="15" height="15" aria-hidden="true" style="margin-left: 0px; height: 15px; width: 15px;"><title></title><g><g fill-rule="evenodd">     <path fill="#ffab2e" d="M10.925 14.302c.173.13.408.13.58-.002.174-.13.244-.362.175-.572l-1.323-4.296 3.435-2.456c.175-.13.25-.36.185-.572-.064-.212-.253-.357-.468-.36H9.275L7.96 1.754c-.064-.21-.21-.354-.46-.354-.14 0-1.027 3.53-.988 6.32.04 2.788.98 3.85.98 3.85l3.433 2.732z"></path>     <path fill="#ffab2e" d="M7.5 1.4c-.25 0-.41.144-.474.354l-1.318 4.29H1.49c-.214.003-.403.148-.467.36-.065.212.01.442.185.572l3.42 2.463-1.307 4.286c-.066.21.004.44.176.572.172.13.407.132.58.003l3.42-2.734L7.5 1.4z">   </path></g></g></svg><svg width="15" height="15" viewBox="0 0 15 15" class="Icon Icon--ratingHalf" aria-hidden="true" style="margin-left: 0px; height: 15px; width: 15px;"><title></title><g><g fill-rule="evenodd">     <path fill="#d7d8d9" d="M10.925 14.302c.173.13.408.13.58-.002.174-.13.244-.362.175-.572l-1.323-4.296 3.435-2.456c.175-.13.25-.36.185-.572-.064-.212-.253-.357-.468-.36H9.275L7.96 1.754c-.064-.21-.21-.354-.46-.354-.14 0-1.027 3.53-.988 6.32.04 2.788.98 3.85.98 3.85l3.433 2.732z"></path>     <path fill="#ffab2e" d="M7.5 1.4c-.25 0-.41.144-.474.354l-1.318 4.29H1.49c-.214.003-.403.148-.467.36-.065.212.01.442.185.572l3.42 2.463-1.307 4.286c-.066.21.004.44.176.572.172.13.407.132.58.003l3.42-2.734L7.5 1.4z"></path>   </g></g></svg></div>1175 人参与</div></div></div></a><a target="_blank" href="https://www.zhihu.com/lives/916265051361529856" type="button" class="Button RelatedCommodities-item Button--plain" data-za-detail-view-path-module="LiveItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;Live&quot;,&quot;id&quot;:&quot;916265051361529856&quot;,&quot;author_member_hash_id&quot;:&quot;d127d540d194cf37387ebd4ea250ff6a&quot;}}}"><img class="RelatedCommodities-image" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-795f1d34b08244bae0a8d71488a17ed1_250x0.jpg" alt="live"><div class="RelatedCommodities-content"><div class="RelatedCommodities-subject RelatedCommodities-subject-two" data-tooltip="如何高效地掌握Android开发技术">如何高效地掌握Android开发技术</div><div class="RelatedCommodities-meta"><div class="RelatedCommodities-scoreWrapper"><div class="Rating"><svg viewBox="0 0 15 15" class="Icon Icon--rating" width="15" height="15" aria-hidden="true" style="margin-left: 0px; height: 15px; width: 15px;"><title></title><g><g fill-rule="evenodd">     <path fill="#ffab2e" d="M10.925 14.302c.173.13.408.13.58-.002.174-.13.244-.362.175-.572l-1.323-4.296 3.435-2.456c.175-.13.25-.36.185-.572-.064-.212-.253-.357-.468-.36H9.275L7.96 1.754c-.064-.21-.21-.354-.46-.354-.14 0-1.027 3.53-.988 6.32.04 2.788.98 3.85.98 3.85l3.433 2.732z"></path>     <path fill="#ffab2e" d="M7.5 1.4c-.25 0-.41.144-.474.354l-1.318 4.29H1.49c-.214.003-.403.148-.467.36-.065.212.01.442.185.572l3.42 2.463-1.307 4.286c-.066.21.004.44.176.572.172.13.407.132.58.003l3.42-2.734L7.5 1.4z">   </path></g></g></svg><svg viewBox="0 0 15 15" class="Icon Icon--rating" width="15" height="15" aria-hidden="true" style="margin-left: 0px; height: 15px; width: 15px;"><title></title><g><g fill-rule="evenodd">     <path fill="#ffab2e" d="M10.925 14.302c.173.13.408.13.58-.002.174-.13.244-.362.175-.572l-1.323-4.296 3.435-2.456c.175-.13.25-.36.185-.572-.064-.212-.253-.357-.468-.36H9.275L7.96 1.754c-.064-.21-.21-.354-.46-.354-.14 0-1.027 3.53-.988 6.32.04 2.788.98 3.85.98 3.85l3.433 2.732z"></path>     <path fill="#ffab2e" d="M7.5 1.4c-.25 0-.41.144-.474.354l-1.318 4.29H1.49c-.214.003-.403.148-.467.36-.065.212.01.442.185.572l3.42 2.463-1.307 4.286c-.066.21.004.44.176.572.172.13.407.132.58.003l3.42-2.734L7.5 1.4z">   </path></g></g></svg><svg viewBox="0 0 15 15" class="Icon Icon--rating" width="15" height="15" aria-hidden="true" style="margin-left: 0px; height: 15px; width: 15px;"><title></title><g><g fill-rule="evenodd">     <path fill="#ffab2e" d="M10.925 14.302c.173.13.408.13.58-.002.174-.13.244-.362.175-.572l-1.323-4.296 3.435-2.456c.175-.13.25-.36.185-.572-.064-.212-.253-.357-.468-.36H9.275L7.96 1.754c-.064-.21-.21-.354-.46-.354-.14 0-1.027 3.53-.988 6.32.04 2.788.98 3.85.98 3.85l3.433 2.732z"></path>     <path fill="#ffab2e" d="M7.5 1.4c-.25 0-.41.144-.474.354l-1.318 4.29H1.49c-.214.003-.403.148-.467.36-.065.212.01.442.185.572l3.42 2.463-1.307 4.286c-.066.21.004.44.176.572.172.13.407.132.58.003l3.42-2.734L7.5 1.4z">   </path></g></g></svg><svg viewBox="0 0 15 15" class="Icon Icon--rating" width="15" height="15" aria-hidden="true" style="margin-left: 0px; height: 15px; width: 15px;"><title></title><g><g fill-rule="evenodd">     <path fill="#ffab2e" d="M10.925 14.302c.173.13.408.13.58-.002.174-.13.244-.362.175-.572l-1.323-4.296 3.435-2.456c.175-.13.25-.36.185-.572-.064-.212-.253-.357-.468-.36H9.275L7.96 1.754c-.064-.21-.21-.354-.46-.354-.14 0-1.027 3.53-.988 6.32.04 2.788.98 3.85.98 3.85l3.433 2.732z"></path>     <path fill="#ffab2e" d="M7.5 1.4c-.25 0-.41.144-.474.354l-1.318 4.29H1.49c-.214.003-.403.148-.467.36-.065.212.01.442.185.572l3.42 2.463-1.307 4.286c-.066.21.004.44.176.572.172.13.407.132.58.003l3.42-2.734L7.5 1.4z">   </path></g></g></svg><svg viewBox="0 0 15 15" class="Icon Icon--rating" width="15" height="15" aria-hidden="true" style="margin-left: 0px; height: 15px; width: 15px;"><title></title><g><g fill-rule="evenodd">     <path fill="#ffab2e" d="M10.925 14.302c.173.13.408.13.58-.002.174-.13.244-.362.175-.572l-1.323-4.296 3.435-2.456c.175-.13.25-.36.185-.572-.064-.212-.253-.357-.468-.36H9.275L7.96 1.754c-.064-.21-.21-.354-.46-.354-.14 0-1.027 3.53-.988 6.32.04 2.788.98 3.85.98 3.85l3.433 2.732z"></path>     <path fill="#ffab2e" d="M7.5 1.4c-.25 0-.41.144-.474.354l-1.318 4.29H1.49c-.214.003-.403.148-.467.36-.065.212.01.442.185.572l3.42 2.463-1.307 4.286c-.066.21.004.44.176.572.172.13.407.132.58.003l3.42-2.734L7.5 1.4z">   </path></g></g></svg></div>903 人参与</div></div></div></a><a target="_blank" href="https://www.zhihu.com/pub/book/119557754" type="button" class="Button RelatedCommodities-item Button--plain" data-za-detail-view-path-module="EBookItem" data-za-extra-module="{&quot;card&quot;:{&quot;content&quot;:{&quot;type&quot;:&quot;EBook&quot;,&quot;token&quot;:&quot;119557754&quot;}}}"><img class="RelatedCommodities-image" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-5cd953be6f20d65e1bac2e1e7c173178_250x0.jpg" alt="live"><div class="RelatedCommodities-content"><div class="RelatedCommodities-subject RelatedCommodities-subject-two" data-tooltip="Android 程序设计：第 2 版">Android 程序设计：第 2 版</div><div class="RelatedCommodities-meta"><div class="RelatedCommodities-bookMeta">1,337 人读过<span class="RelatedCommodities-bookRead"><span style="display: inline-flex; align-items: center;">​<svg class="Zi Zi--Ebook" width="13" height="14" fill="currentColor" viewBox="0 0 24 24"><path d="M16 17.649V2.931a.921.921 0 0 0-.045-.283.943.943 0 0 0-1.182-.604L4.655 5.235A.932.932 0 0 0 4 6.122v14.947c0 .514.421.931.941.931H19.06c.52 0 .941-.417.941-.93V7.292a.936.936 0 0 0-.941-.931h-.773v12.834a.934.934 0 0 1-.83.924L6.464 21.416c-.02.002 2.94-.958 8.883-2.881a.932.932 0 0 0 .653-.886z" fill-rule="evenodd"></path></svg></span>阅读</span></div></div></div></a></div></div><div class="Card"><div class="Pc-card Card"><a class="Banner-link" href="https://bj.ikongjian.com/ikj/20181017/01?&amp;utm_source=xxl&amp;utm_medium=zhihu&amp;utm_account=haoliang&amp;utm_page=pc016&amp;utm_keyword=hl099" target="_blank"><div class="Banner-adTag">广告</div><img class="Banner-image" src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/v2-f304cc57bc92e93a76f4816412d86fcb_540x450.jpeg" alt="广告"></a><div class="Pc-card-button-close " data-tooltip="不再显示" data-tooltip-position="bottom"><svg viewBox="0 0 12 12" class="Icon Icon--close Pc-card-button-close-svg "><path fill-rule="evenodd" d="M3 2L2 3l3 3-3 3 1 1 3-3 3 3 1-1-3-3 3-3-1-1-3 3"></path></svg></div></div></div><footer class="Footer"><a class="Footer-item" target="_blank" rel="noopener noreferrer" href="https://liukanshan.zhihu.com/">刘看山</a><span class="Footer-dot"></span><a class="Footer-item" target="_blank" rel="noopener noreferrer" href="https://www.zhihu.com/question/19581624">知乎指南</a><span class="Footer-dot"></span><a class="Footer-item" target="_blank" rel="noopener noreferrer" href="https://www.zhihu.com/terms">知乎协议</a><span class="Footer-dot"></span><a class="Footer-item" target="_blank" rel="noopener noreferrer" href="https://www.zhihu.com/term/privacy">知乎隐私保护指引</a><br><a class="Footer-item" target="_blank" href="https://www.zhihu.com/app">应用</a><span class="Footer-dot"></span><a class="Footer-item" target="_blank" rel="noopener noreferrer" href="https://app.mokahr.com/apply/zhihu">工作</a><span class="Footer-dot"></span><button type="button" class="Button OrgCreateButton">申请开通知乎机构号</button><br><a class="Footer-item" target="_blank" rel="noopener noreferrer" href="https://zhuanlan.zhihu.com/p/51068775">侵权举报</a><span class="Footer-dot"></span><a class="Footer-item" target="_blank" rel="noopener noreferrer" href="http://www.12377.cn/">网上有害信息举报专区</a><br><span class="Footer-item">违法和不良信息举报：010-82716601</span><br><a class="Footer-item" target="_blank" href="https://www.zhihu.com/jubao">儿童色情信息举报专区</a><br><a class="Footer-item" target="_blank" href="https://www.zhihu.com/certificates">证照中心</a><br><a class="Footer-item" target="_blank" href="https://www.zhihu.com/contact">联系我们</a><span> © 2019 知乎</span></footer></div><div class="Sticky--holder" style="position: static; top: auto; right: auto; bottom: auto; left: auto; display: block; float: none; margin: 0px; height: 1401.31px;"></div></div></div></div></div></main><div class="CornerButtons"><div class="CornerAnimayedFlex"><button data-tooltip="建议反馈" data-tooltip-position="left" data-tooltip-will-hide-on-click="true" aria-label="建议反馈" type="button" class="Button CornerButton Button--plain"><svg class="Zi Zi--Feedback" title="建议反馈" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M19.99 6.99L18 5s-1-1-2-1H8C7 4 6 5 6 5L4 7S3 8 3 9v9s0 2 2.002 2H19c2 0 2-2 2-2V9c0-1-1.01-2.01-1.01-2.01zM16.5 5.5L19 8H5l2.5-2.5h9zm-2 5.5s.5 0 .5.5-.5.5-.5.5h-5s-.5 0-.5-.5.5-.5.5-.5h5z"></path></svg></button></div><div class="CornerAnimayedFlex CornerAnimayedFlex--hidden"><button data-tooltip="回到顶部" data-tooltip-position="left" data-tooltip-will-hide-on-click="true" aria-label="回到顶部" type="button" class="Button CornerButton Button--plain"><svg class="Zi Zi--BackToTop" title="回到顶部" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M16.036 19.59a1 1 0 0 1-.997.995H9.032a.996.996 0 0 1-.997-.996v-7.005H5.03c-1.1 0-1.36-.633-.578-1.416L11.33 4.29a1.003 1.003 0 0 1 1.412 0l6.878 6.88c.782.78.523 1.415-.58 1.415h-3.004v7.005z"></path></svg></button></div></div></div></div><script id="js-clientConfig" type="text/json">{"host":"zhihu.com","protocol":"https:","wwwHost":"www.zhihu.com","zhuanlanHost":"zhuanlan.zhihu.com","apiHost":"api.zhihu.com"}</script><script id="js-initialData" type="text/json">{"initialState":{"common":{"ask":{}},"loading":{"global":{"count":0},"local":{"question\u002Fget\u002F":false,"question\u002FgetAnswers\u002F34652589":false}},"entities":{"users":{"70072e0861e805e9b03b75f000efb9c3":{"uid":1135507088817250300,"userType":"people","id":"70072e0861e805e9b03b75f000efb9c3"}},"questions":{"34652589":{"type":"question","id":34652589,"title":"Android中为什么主线程不会因为Looper.loop()里的死循环卡死？","questionType":"normal","created":1439777878,"updatedTime":1439783968,"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fquestions\u002F34652589","isMuted":false,"isNormal":true,"isEditable":true,"adminClosedComment":false,"hasPublishingDraft":false,"answerCount":45,"visitCount":102439,"commentCount":1,"followerCount":1361,"collapsedAnswerCount":1,"excerpt":"app程序入口中为主线程准备好了消息队列 [图片] 而根据Looper.loop()源码可知里面是一个死循环在遍历消息队列取消息 [图片] 而且并也没看见哪里有相关代码为这个死循环准备了一个新线程去运转，但是主线程却并不会因为Looper.loop()中的这个死循环卡死，为什么呢？ ————————————补充———————————————— 举个例子，像Activity的生命周期这些方法这些都是在主线程里执行的吧，那这些生命周期方法是怎么实现在死循环…","commentPermission":"all","detail":"app程序入口中为主线程准备好了消息队列\u003Cbr\u002F\u003E\u003Cfigure\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fce97597327ffe00c04ce76fc2f41030c_b.png\" data-rawwidth=\"531\" data-rawheight=\"481\" class=\"origin_image zh-lightbox-thumb\" width=\"531\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fce97597327ffe00c04ce76fc2f41030c_r.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cbr\u002F\u003E而根据Looper.loop()源码可知里面是一个死循环在遍历消息队列取消息\u003Cbr\u002F\u003E\u003Cfigure\u003E\u003Cimg src=\"https:\u002F\u002Fpic3.zhimg.com\u002F10df1f7c70d0d9382f5c8a4b2b6d66a6_b.png\" data-rawwidth=\"474\" data-rawheight=\"372\" class=\"origin_image zh-lightbox-thumb\" width=\"474\" data-original=\"https:\u002F\u002Fpic3.zhimg.com\u002F10df1f7c70d0d9382f5c8a4b2b6d66a6_r.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cbr\u002F\u003E而且并也没看见哪里有相关代码为这个死循环准备了一个新线程去运转，但是主线程却并不会因为Looper.loop()中的这个死循环卡死，为什么呢？\u003Cbr\u002F\u003E————————————补充————————————————\u003Cbr\u002F\u003E举个例子，像Activity的生命周期这些方法这些都是在主线程里执行的吧，那这些生命周期方法是怎么实现在死循环体外能够执行起来的？","editableDetail":"app程序入口中为主线程准备好了消息队列\u003Cbr\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002F50\u002Fce97597327ffe00c04ce76fc2f41030c_b.jpg\" data-rawwidth=\"531\" data-rawheight=\"481\" class=\"content_image\"\u003E\u003Cbr\u003E而根据Looper.loop()源码可知里面是一个死循环在遍历消息队列取消息\u003Cbr\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002F50\u002F10df1f7c70d0d9382f5c8a4b2b6d66a6_b.jpg\" data-rawwidth=\"474\" data-rawheight=\"372\" class=\"content_image\"\u003E\u003Cbr\u003E而且并也没看见哪里有相关代码为这个死循环准备了一个新线程去运转，但是主线程却并不会因为Looper.loop()中的这个死循环卡死，为什么呢？\u003Cbr\u003E————————————补充————————————————\u003Cbr\u003E举个例子，像Activity的生命周期这些方法这些都是在主线程里执行的吧，那这些生命周期方法是怎么实现在死循环体外能够执行起来的？","status":{"isLocked":false,"isClose":false,"isEvaluate":false,"isSuggest":false},"relationship":{"isAuthor":false,"isFollowing":false,"isAnonymous":false,"canLock":false,"canStickAnswers":false,"canCollapseAnswers":false},"topics":[{"id":"19555634","type":"topic","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19555634","name":"Android 开发","avatarUrl":"https:\u002F\u002Fpic4.zhimg.com\u002F8c9ca8319_is.jpg"},{"id":"20020270","type":"topic","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F20020270","name":"Android 开发咨询","avatarUrl":"https:\u002F\u002Fpic4.zhimg.com\u002Fe82bab09c_is.jpg"},{"id":"20044980","type":"topic","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F20044980","name":"Android系统源码","avatarUrl":"https:\u002F\u002Fpic4.zhimg.com\u002F6810a71312466a6063f7dd61f9bf5989_is.jpg"}],"author":{"id":"4bb58cdb813150bafe8bb6796ab75e4b","urlToken":"lin-xuan-63-7","name":"车干木木","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002F2016a711c589ee7cb557a9c283c54bb2_is.jpg","avatarUrlTemplate":"https:\u002F\u002Fpic1.zhimg.com\u002F2016a711c589ee7cb557a9c283c54bb2_{size}.jpg","isOrg":false,"type":"people","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fpeople\u002F4bb58cdb813150bafe8bb6796ab75e4b","userType":"people","headline":"","badge":[],"gender":1,"isAdvertiser":false,"isPrivacy":false},"canComment":{"status":true,"reason":""},"reviewInfo":{"type":"","tips":"","editTips":"","isReviewing":false},"relatedCards":[],"muteInfo":{"type":""},"showAuthor":false}},"answers":{"59571257":{"id":59571257,"type":"answer","answerType":"normal","question":{"type":"question","id":34652589,"title":"Android中为什么主线程不会因为Looper.loop()里的死循环卡死？","questionType":"normal","created":1439777878,"updatedTime":1439783968,"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fquestions\u002F34652589","relationship":{}},"author":{"id":"53013cf8f04bf168814156e563beb935","urlToken":"chen-yu-quan","name":"Tmacchen","avatarUrl":"https:\u002F\u002Fpic2.zhimg.com\u002Ff720e4bce_is.jpg","avatarUrlTemplate":"https:\u002F\u002Fpic2.zhimg.com\u002Ff720e4bce_{size}.jpg","isOrg":false,"type":"people","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fpeople\u002F53013cf8f04bf168814156e563beb935","userType":"people","headline":"招人同帮内推腾讯百度，简历请发featureyuquan@gmail.com","badge":[],"gender":1,"isAdvertiser":false,"followerCount":2714,"isFollowed":false,"isPrivacy":false},"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fanswers\u002F59571257","isCollapsed":false,"createdTime":1439784209,"updatedTime":1457666469,"extras":"","isCopyable":true,"isNormal":true,"voteupCount":37,"commentCount":15,"isSticky":false,"adminClosedComment":false,"commentPermission":"all","canComment":{"reason":"","status":true},"reshipmentSettings":"allowed","content":"了解下linux的epoll你就知道为什么不会被卡住了，先说结论：阻塞是有的，但是不会卡住\u003Cbr\u002F\u003E主要原因有2个\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E1，epoll模型\u003Cbr\u002F\u003E当没有消息的时候会epoll.wait，等待句柄写的时候再唤醒，这个时候其实是阻塞的。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E2，所有的ui操作都通过handler来发消息操作。\u003Cbr\u002F\u003E比如屏幕刷新16ms一个消息，你的各种点击事件，所以就会有句柄写操作，唤醒上文的wait操作，所以不会被卡死了。","editableContent":"","excerpt":"了解下linux的epoll你就知道为什么不会被卡住了，先说结论：阻塞是有的，但是不会卡住 主要原因有2个 1，epoll模型 当没有消息的时候会epoll.wait，等待句柄写的时候再唤醒，这个时候其实是阻塞的。 2，所有的ui操作都通过handler来发消息操作。 比如屏幕刷新16ms一个消息，你的各种点击事件，所以就会有句柄写操作，唤醒上文的wait操作，所以不会被卡死了。","collapsedBy":"nobody","collapseReason":"","annotationAction":null,"markInfos":[],"relevantInfo":{"isRelevant":false,"relevantType":"","relevantText":""},"suggestEdit":{"reason":"","status":false,"tip":"","title":"","unnormalDetails":{"status":"","description":"","reason":"","reasonId":0,"note":""},"url":""},"isLabeled":false,"rewardInfo":{"canOpenReward":false,"isRewardable":false,"rewardMemberCount":0,"rewardTotalMoney":0,"tagline":""},"relationship":{"isAuthor":false,"isAuthorized":false,"isNothelp":false,"isThanked":false,"isRecognized":false,"voting":0,"upvotedFollowees":[]}},"59578531":{"id":59578531,"type":"answer","answerType":"normal","question":{"type":"question","id":34652589,"title":"Android中为什么主线程不会因为Looper.loop()里的死循环卡死？","questionType":"normal","created":1439777878,"updatedTime":1439783968,"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fquestions\u002F34652589","relationship":{}},"author":{"id":"324602d46f897dd224ac5c898cd411e1","urlToken":"guo-qi-fa","name":"Groffa","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002F8117a23fa8d4a23072b47b96cb391738_is.jpg","avatarUrlTemplate":"https:\u002F\u002Fpic1.zhimg.com\u002F8117a23fa8d4a23072b47b96cb391738_{size}.jpg","isOrg":false,"type":"people","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fpeople\u002F324602d46f897dd224ac5c898cd411e1","userType":"people","headline":"Android","badge":[],"gender":1,"isAdvertiser":false,"followerCount":705,"isFollowed":false,"isPrivacy":true},"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fanswers\u002F59578531","isCollapsed":false,"createdTime":1439787283,"updatedTime":1439787283,"extras":"","isCopyable":true,"isNormal":true,"voteupCount":27,"commentCount":4,"isSticky":false,"adminClosedComment":false,"commentPermission":"all","canComment":{"reason":"","status":true},"reshipmentSettings":"allowed","content":"去看下handler机制就明白了，网上一大把。 \u003Cbr\u002F\u003E\u003Cbr\u002F\u003E1.handler机制是使用pipe来实现的 \u003Cbr\u002F\u003E\u003Cbr\u002F\u003E2.主线程没有消息处理时阻塞在管道的读端 \u003Cbr\u002F\u003E\u003Cbr\u002F\u003E3.binder线程会往主线程消息队列里添加消息，然后往管道写端写一个字节，这样就能唤醒主线程从管道读端返回，也就是说queue.next()会调用返回\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E4.dispatchMessage()中调用onCreate, onResume","editableContent":"","excerpt":"去看下handler机制就明白了，网上一大把。 1.handler机制是使用pipe来实现的 2.主线程没有消息处理时阻塞在管道的读端 3.binder线程会往主线程消息队列里添加消息，然后往管道写端写一个字节，这样就能唤醒主线程从管道读端返回，也就是说queue.next()会调用返回 4.dispatchMessage()中调用onCreate, onResume","collapsedBy":"nobody","collapseReason":"","annotationAction":null,"markInfos":[],"relevantInfo":{"isRelevant":false,"relevantType":"","relevantText":""},"suggestEdit":{"reason":"","status":false,"tip":"","title":"","unnormalDetails":{"status":"","description":"","reason":"","reasonId":0,"note":""},"url":""},"isLabeled":false,"rewardInfo":{"canOpenReward":false,"isRewardable":false,"rewardMemberCount":0,"rewardTotalMoney":0,"tagline":""},"relationship":{"isAuthor":false,"isAuthorized":false,"isNothelp":false,"isThanked":false,"isRecognized":false,"voting":0,"upvotedFollowees":[]}},"59614987":{"id":59614987,"type":"answer","answerType":"normal","question":{"type":"question","id":34652589,"title":"Android中为什么主线程不会因为Looper.loop()里的死循环卡死？","questionType":"normal","created":1439777878,"updatedTime":1439783968,"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fquestions\u002F34652589","relationship":{}},"author":{"id":"4897651cf72b010294463a1fd113af52","urlToken":"rocko","name":"Rocko","avatarUrl":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-698df758dbcb346380387c16f9561c8a_is.jpg","avatarUrlTemplate":"https:\u002F\u002Fpic3.zhimg.com\u002Fv2-698df758dbcb346380387c16f9561c8a_{size}.jpg","isOrg":false,"type":"people","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fpeople\u002F4897651cf72b010294463a1fd113af52","userType":"people","headline":"https:\u002F\u002Frocko.xyz","badge":[],"gender":1,"isAdvertiser":false,"followerCount":893,"isFollowed":false,"isPrivacy":false},"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fanswers\u002F59614987","isCollapsed":false,"createdTime":1439801929,"updatedTime":1439830467,"extras":"","isCopyable":true,"isNormal":true,"voteupCount":38,"commentCount":4,"isSticky":false,"adminClosedComment":false,"commentPermission":"all","canComment":{"reason":"","status":true},"reshipmentSettings":"allowed","content":"Handler 机制应该基本都知道了，题主点进去源码看下 ActivityThread 就能基本搞明白了，为什么主线程不会因为 Looper.loop() 里的死循环卡死？\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E首先 ActivityThread 并不是一个 Thread，就只是一个 final 类而已。我们常说的主线程就是从这个类的 main 方法开始，main 方法很简短，一眼就能看全，我们看到里面有 Looper 了，那么接下来就\u003Cb\u003E找找 ActivityThread 对应的 Handler\u003C\u002Fb\u003E 啊，就是内部类 H，其继承 Handler，贴出 handleMessage 的小部分：\u003Cbr\u002F\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-java\"\u003E\u003Cspan class=\"kd\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EhandleMessage\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EMessage\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E{\u003C\u002Fspan\u003E\n            \u003Cspan class=\"k\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EDEBUG_MESSAGES\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ESlog\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Ev\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETAG\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E&#34;&gt;&gt;&gt; handling: &#34;\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EcodeToString\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Ewhat\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E));\u003C\u002Fspan\u003E\n            \u003Cspan class=\"k\"\u003Eswitch\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Ewhat\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E{\u003C\u002Fspan\u003E\n                \u003Cspan class=\"k\"\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\"nl\"\u003ELAUNCH_ACTIVITY:\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E{\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceBegin\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E&#34;activityStart&#34;\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"kd\"\u003Efinal\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EActivityClientRecord\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Er\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EActivityClientRecord\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Eobj\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E;\u003C\u002Fspan\u003E\n\n                    \u003Cspan class=\"n\"\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EpackageInfo\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EgetPackageInfoNoCheck\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\n                            \u003Cspan class=\"n\"\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EactivityInfo\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EapplicationInfo\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EcompatInfo\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003EhandleLaunchActivity\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kc\"\u003Enull\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceEnd\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                \u003Cspan class=\"o\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\"k\"\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\"nl\"\u003ERELAUNCH_ACTIVITY:\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E{\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceBegin\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E&#34;activityRestart&#34;\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003EActivityClientRecord\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Er\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EActivityClientRecord\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Eobj\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E;\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003EhandleRelaunchActivity\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Er\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceEnd\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                \u003Cspan class=\"o\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\"k\"\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\"nl\"\u003EPAUSE_ACTIVITY:\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceBegin\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E&#34;activityPause&#34;\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003EhandlePauseActivity\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E((\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EIBinder\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Eobj\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kc\"\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Earg1\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&amp;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Earg2\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E\n                            \u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Earg1\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&amp;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003EmaybeSnapshot\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E();\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceEnd\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"k\"\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\"k\"\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\"nl\"\u003EPAUSE_ACTIVITY_FINISHING:\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceBegin\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E&#34;activityPause&#34;\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003EhandlePauseActivity\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E((\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EIBinder\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Eobj\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kc\"\u003Etrue\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Earg1\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&amp;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Earg2\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E\n                            \u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Earg1\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E&amp;\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceEnd\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"k\"\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\"k\"\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\"nl\"\u003ESTOP_ACTIVITY_SHOW:\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceBegin\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E&#34;activityStop&#34;\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003EhandleStopActivity\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E((\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EIBinder\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Eobj\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kc\"\u003Etrue\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Earg2\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceEnd\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"k\"\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\"k\"\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\"nl\"\u003ESTOP_ACTIVITY_HIDE:\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceBegin\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E&#34;activityStop&#34;\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003EhandleStopActivity\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E((\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EIBinder\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Eobj\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kc\"\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Earg2\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceEnd\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"k\"\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\"k\"\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\"nl\"\u003ESHOW_WINDOW:\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceBegin\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E&#34;activityShowWindow&#34;\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003EhandleWindowVisibility\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E((\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EIBinder\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Eobj\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kc\"\u003Etrue\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceEnd\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"k\"\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\"k\"\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\"nl\"\u003EHIDE_WINDOW:\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceBegin\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E&#34;activityHideWindow&#34;\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003EhandleWindowVisibility\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E((\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EIBinder\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Eobj\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kc\"\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceEnd\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"k\"\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\"k\"\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\"nl\"\u003ERESUME_ACTIVITY:\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceBegin\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E&#34;activityResume&#34;\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003EhandleResumeActivity\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E((\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EIBinder\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Eobj\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kc\"\u003Etrue\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Earg1\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kc\"\u003Etrue\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceEnd\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"k\"\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E;\u003C\u002Fspan\u003E\n                \u003Cspan class=\"k\"\u003Ecase\u003C\u002Fspan\u003E \u003Cspan class=\"nl\"\u003ESEND_RESULT:\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceBegin\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"s\"\u003E&#34;activityDeliverResult&#34;\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003EhandleSendResult\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E((\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EResultData\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003Emsg\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Eobj\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EtraceEnd\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003ETrace\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ETRACE_TAG_ACTIVITY_MANAGER\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"k\"\u003Ebreak\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E;\u003C\u002Fspan\u003E\n\n            \u003Cspan class=\"o\"\u003E...........\u003C\u002Fspan\u003E\n\u003Cspan class=\"o\"\u003E}\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E看完这 Handler 里处理消息的内容应该明白了吧， Activity 的生命周期都有对应的 case 条件了，ActivityThread 有个 getHandler 方法，得到这个 handler 就可以发送消息，然后 loop 里就分发消息，然后就发给 handler, 然后就执行到 H（Handler ）里的对应代码。所以这些代码就不会卡死～，有消息过来就能执行。举个例子，在 ActivityThread 里的内部类 ApplicationThread 中就有很多 sendMessage 的方法：\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-java\"\u003E\u003Cspan class=\"o\"\u003E......\u003C\u002Fspan\u003E\n\u003Cspan class=\"kd\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"kd\"\u003Efinal\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EschedulePauseActivity\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EIBinder\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etoken\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eboolean\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Efinished\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E\n                \u003Cspan class=\"kt\"\u003Eboolean\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EuserLeaving\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EconfigChanges\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eboolean\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EdontReport\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E{\u003C\u002Fspan\u003E\n            \u003Cspan class=\"n\"\u003EsendMessage\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003Efinished\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E?\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EH\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EPAUSE_ACTIVITY_FINISHING\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EH\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EPAUSE_ACTIVITY\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003Etoken\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EuserLeaving\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E?\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E1\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E|\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EdontReport\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E?\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E2\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E),\u003C\u002Fspan\u003E\n                    \u003Cspan class=\"n\"\u003EconfigChanges\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n        \u003Cspan class=\"o\"\u003E}\u003C\u002Fspan\u003E\n\n        \u003Cspan class=\"kd\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"kd\"\u003Efinal\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EscheduleStopActivity\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EIBinder\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etoken\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eboolean\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EshowWindow\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E\n                \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EconfigChanges\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E{\u003C\u002Fspan\u003E\n           \u003Cspan class=\"n\"\u003EsendMessage\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\n                \u003Cspan class=\"n\"\u003EshowWindow\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E?\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EH\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ESTOP_ACTIVITY_SHOW\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EH\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ESTOP_ACTIVITY_HIDE\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E\n                \u003Cspan class=\"n\"\u003Etoken\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EconfigChanges\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n        \u003Cspan class=\"o\"\u003E}\u003C\u002Fspan\u003E\n\n        \u003Cspan class=\"kd\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"kd\"\u003Efinal\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EscheduleWindowVisibility\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EIBinder\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etoken\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eboolean\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EshowWindow\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E{\u003C\u002Fspan\u003E\n            \u003Cspan class=\"n\"\u003EsendMessage\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\n                \u003Cspan class=\"n\"\u003EshowWindow\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E?\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EH\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ESHOW_WINDOW\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EH\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EHIDE_WINDOW\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E\n                \u003Cspan class=\"n\"\u003Etoken\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n        \u003Cspan class=\"o\"\u003E}\u003C\u002Fspan\u003E\n\n        \u003Cspan class=\"kd\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"kd\"\u003Efinal\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EscheduleSleeping\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EIBinder\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etoken\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eboolean\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Esleeping\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E{\u003C\u002Fspan\u003E\n            \u003Cspan class=\"n\"\u003EsendMessage\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EH\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ESLEEPING\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etoken\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Esleeping\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E?\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E1\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n        \u003Cspan class=\"o\"\u003E}\u003C\u002Fspan\u003E\n\n        \u003Cspan class=\"kd\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"kd\"\u003Efinal\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003EscheduleResumeActivity\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EIBinder\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etoken\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Eint\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EprocessState\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E\n                \u003Cspan class=\"kt\"\u003Eboolean\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EisForward\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EBundle\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EresumeArgs\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E{\u003C\u002Fspan\u003E\n            \u003Cspan class=\"n\"\u003EupdateProcessState\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EprocessState\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"kc\"\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n            \u003Cspan class=\"n\"\u003EsendMessage\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EH\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003ERESUME_ACTIVITY\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Etoken\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EisForward\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E?\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E1\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n\u003Cspan class=\"o\"\u003E}\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"o\"\u003E......\u003C\u002Fspan\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E","editableContent":"","excerpt":"Handler 机制应该基本都知道了，题主点进去源码看下 ActivityThread 就能基本搞明白了，为什么主线程不会因为 Looper.loop() 里的死循环卡死？ 首先 ActivityThread 并不是一个 Thread，就只是一个 final 类而已。我们常说的主线程就是从这个类的 main 方法开始，main 方法很简短，一眼就能看全，我们看到里面有 Looper 了，那么接下来就找找 ActivityThread 对应的 Handler 啊，就是内部类 H，其继承 Handler，贴出 handleMessa…","collapsedBy":"nobody","collapseReason":"","annotationAction":null,"markInfos":[],"relevantInfo":{"isRelevant":false,"relevantType":"","relevantText":""},"suggestEdit":{"reason":"","status":false,"tip":"","title":"","unnormalDetails":{"status":"","description":"","reason":"","reasonId":0,"note":""},"url":""},"isLabeled":false,"rewardInfo":{"canOpenReward":false,"isRewardable":false,"rewardMemberCount":0,"rewardTotalMoney":0,"tagline":""},"relationship":{"isAuthor":false,"isAuthorized":false,"isNothelp":false,"isThanked":false,"isRecognized":false,"voting":0,"upvotedFollowees":[]}},"90344494":{"id":90344494,"type":"answer","answerType":"normal","question":{"type":"question","id":34652589,"title":"Android中为什么主线程不会因为Looper.loop()里的死循环卡死？","questionType":"normal","created":1439777878,"updatedTime":1439783968,"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fquestions\u002F34652589","relationship":{}},"author":{"id":"c7de1694c846fe3b95895bc4ccb8df50","urlToken":"gityuan","name":"Gityuan","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002F59e145e8b0d37770ef831324a77ba088_is.jpg","avatarUrlTemplate":"https:\u002F\u002Fpic1.zhimg.com\u002F59e145e8b0d37770ef831324a77ba088_{size}.jpg","isOrg":false,"type":"people","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fpeople\u002Fc7de1694c846fe3b95895bc4ccb8df50","userType":"people","headline":"http:\u002F\u002Fgityuan.com","badge":[],"gender":1,"isAdvertiser":false,"followerCount":6147,"isFollowed":false,"isPrivacy":false},"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fanswers\u002F90344494","isCollapsed":false,"createdTime":1457745487,"updatedTime":1471074381,"extras":"","isCopyable":true,"isNormal":true,"voteupCount":992,"commentCount":66,"isSticky":false,"adminClosedComment":false,"commentPermission":"all","canComment":{"reason":"","status":true},"reshipmentSettings":"allowed","content":"要完全彻底理解这个问题，需要准备以下4方面的知识：Process\u002FThread，Android Binder IPC，Handler\u002FLooper\u002FMessageQueue消息机制，Linux pipe\u002Fepoll机制。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E总结一下楼主主要有3个疑惑：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E1.Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ \u003Cbr\u002F\u003E\u003Cbr\u002F\u003E2.没看见哪里有相关代码为这个死循环准备了一个新线程去运转？ \u003Cbr\u002F\u003E\u003Cbr\u002F\u003E3.Activity的生命周期这些方法这些都是在主线程里执行的吧，那这些生命周期方法是怎么实现在死循环体外能够执行起来的？\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E--------------------------------------------------------------------------------------------------------------------------------------\u003Cbr\u002F\u003E针对这些疑惑， \u003Ca data-hash=\"50b28faaec835947511e005cd6734484\" href=\"https:\u002F\u002Fwww.zhihu.com\u002Fpeople\u002F50b28faaec835947511e005cd6734484\" class=\"member_mention\" data-editable=\"true\" data-title=\"@hi大头鬼hi\" data-hovercard=\"p$b$50b28faaec835947511e005cd6734484\"\u003E@hi大头鬼hi\u003C\u002Fa\u003E\u003Ca data-hash=\"4897651cf72b010294463a1fd113af52\" href=\"https:\u002F\u002Fwww.zhihu.com\u002Fpeople\u002F4897651cf72b010294463a1fd113af52\" class=\"member_mention\" data-editable=\"true\" data-title=\"@Rocko\" data-hovercard=\"p$b$4897651cf72b010294463a1fd113af52\"\u003E@Rocko\u003C\u002Fa\u003E\u003Ca data-hash=\"53013cf8f04bf168814156e563beb935\" href=\"https:\u002F\u002Fwww.zhihu.com\u002Fpeople\u002F53013cf8f04bf168814156e563beb935\" class=\"member_mention\" data-editable=\"true\" data-title=\"@陈昱全\" data-hovercard=\"p$b$53013cf8f04bf168814156e563beb935\"\u003E@陈昱全\u003C\u002Fa\u003E 大家回答都比较精炼，接下来我再更进一步详细地一一解答楼主的疑惑：\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E(1) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ \u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E这里涉及线程，先说说说进程\u002F线程，\u003Cb\u003E进程：\u003C\u002Fb\u003E每个app运行时前首先创建一个进程，该进程是由Zygote fork出来的，用于承载App上运行的各种Activity\u002FService等组件。进程对于上层应用来说是完全透明的，这也是google有意为之，让App程序都是运行在Android Runtime。大多数情况一个App就运行在一个进程中，除非在AndroidManifest.xml中配置Android:process属性，或通过native代码fork进程。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E线程：\u003C\u002Fb\u003E线程对应用来说非常常见，比如每次new Thread().start都会创建一个新的线程。该线程与App所在进程之间资源共享，从Linux角度来说进程与线程除了是否共享资源外，并没有本质的区别，都是一个task_struct结构体\u003Cb\u003E，在CPU看来进程或线程无非就是一段可执行的代码，CPU采用CFS调度算法，保证每个task都尽可能公平的享有CPU时间片\u003C\u002Fb\u003E。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E有了这么准备，再说说死循环问题：\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E对于线程既然是一段可执行的代码，当可执行代码执行完成后，线程生命周期便该终止了，线程退出。而对于主线程，我们是绝不希望会被运行一段时间，自己就退出，那么如何保证能一直存活呢？\u003Cb\u003E简单做法就是可执行代码是能一直执行下去的，死循环便能保证不会被退出，\u003C\u002Fb\u003E例如，binder线程也是采用死循环的方法，通过循环方式不同与Binder驱动进行读写操作，当然并非简单地死循环，无消息时会休眠。但这里可能又引发了另一个问题，既然是死循环又如何去处理其他事务呢？通过创建新线程的方式。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E真正会卡死主线程的操作是在回调方法onCreate\u002FonStart\u002FonResume等操作时间过长，会导致掉帧，甚至发生ANR，looper.loop本身不会导致应用卡死。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E(2) 没看见哪里有相关代码为这个死循环准备了一个新线程去运转？ \u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E事实上，会在进入死循环之前便创建了新binder线程，在代码ActivityThread.main()中：\u003Cbr\u002F\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-java\"\u003E\u003Cspan class=\"kd\"\u003Epublic\u003C\u002Fspan\u003E \u003Cspan class=\"kd\"\u003Estatic\u003C\u002Fspan\u003E \u003Cspan class=\"kt\"\u003Evoid\u003C\u002Fspan\u003E \u003Cspan class=\"nf\"\u003Emain\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"n\"\u003EString\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E[]\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Eargs\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E{\u003C\u002Fspan\u003E\n        \u003Cspan class=\"o\"\u003E....\u003C\u002Fspan\u003E\n\n        \u003Cspan class=\"c1\"\u003E\u002F\u002F创建Looper和MessageQueue对象，用于处理主线程的消息\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E        \u003Cspan class=\"n\"\u003ELooper\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003EprepareMainLooper\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E();\u003C\u002Fspan\u003E\n\n        \u003Cspan class=\"c1\"\u003E\u002F\u002F创建ActivityThread对象\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E        \u003Cspan class=\"n\"\u003EActivityThread\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003Ethread\u003C\u002Fspan\u003E \u003Cspan class=\"o\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003EActivityThread\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E();\u003C\u002Fspan\u003E \n\n        \u003Cspan class=\"c1\"\u003E\u002F\u002F建立Binder通道 (创建新线程)\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E        \u003Cspan class=\"n\"\u003Ethread\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Eattach\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"kc\"\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n\n        \u003Cspan class=\"n\"\u003ELooper\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"na\"\u003Eloop\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E();\u003C\u002Fspan\u003E \u003Cspan class=\"c1\"\u003E\u002F\u002F消息循环运行\n\u003C\u002Fspan\u003E\u003Cspan class=\"c1\"\u003E\u003C\u002Fspan\u003E        \u003Cspan class=\"k\"\u003Ethrow\u003C\u002Fspan\u003E \u003Cspan class=\"k\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"n\"\u003ERuntimeException\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"s\"\u003E&#34;Main thread loop unexpectedly exited&#34;\u003C\u002Fspan\u003E\u003Cspan class=\"o\"\u003E);\u003C\u002Fspan\u003E\n    \u003Cspan class=\"o\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cb\u003Ethread.attach(false)；便会创建一个Binder线程（具体是指ApplicationThread，Binder的服务端，用于接收系统服务AMS发送来的事件），该Binder线程通过Handler将Message发送给主线程\u003C\u002Fb\u003E，具体过程可查看 \u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fgityuan.com\u002F2016\u002F03\u002F06\u002Fstart-service\u002F\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003EstartService流程分析\u003C\u002Fa\u003E，这里不展开说，简单说Binder用于进程间通信，采用C\u002FS架构。关于binder感兴趣的朋友，可查看我回答的另一个知乎问题：\u003Cbr\u002F\u003E\u003Ca href=\"https:\u002F\u002Fwww.zhihu.com\u002Fquestion\u002F39440766\u002Fanswer\u002F89210950\" class=\"internal\"\u003E为什么Android要采用Binder作为IPC机制？ - Gityuan的回答\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E另外，\u003Cb\u003EActivityThread实际上并非线程\u003C\u002Fb\u003E，不像HandlerThread类，ActivityThread并没有真正继承Thread类，只是往往运行在主线程，该人以线程的感觉，其实承载ActivityThread的主线程就是由Zygote fork而创建的进程。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E主线程的死循环一直运行是不是特别消耗CPU资源呢？ \u003C\u002Fb\u003E其实不然，这里就涉及到\u003Cb\u003ELinux pipe\u002Fe\u003C\u002Fb\u003E\u003Cb\u003Epoll机制\u003C\u002Fb\u003E，简单说就是在主线程的MessageQueue没有消息时，便阻塞在loop的queue.next()中的nativePollOnce()方法里，详情见\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fwww.yuanhh.com\u002F2015\u002F12\u002F26\u002Fhandler-message-framework\u002F%23next\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003EAndroid消息机制1-Handler(Java层)\u003C\u002Fa\u003E，此时主线程会释放CPU资源进入休眠状态，直到下个消息到达或者有事务发生，通过往pipe管道写端写入数据来唤醒主线程工作。这里采用的epoll机制，是一种IO多路复用机制，可以同时监控多个描述符，当某个描述符就绪(读或写就绪)，则立刻通知相应程序进行读或写操作，本质同步I\u002FO，即读写是阻塞的。 \u003Cb\u003E所以说，主线程大多数时候都是处于休眠状态，并不会消耗大量CPU资源。\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E(3) Activity的生命周期是怎么实现在死循环体外能够执行起来的？\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EActivityThread的内部类H继承于Handler，通过handler消息机制，简单说Handler机制用于同一个进程的线程间通信。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003EActivity的生命周期都是依靠主线程的Looper.loop，当收到不同Message时则采用相应措施：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E在H.handleMessage(msg)方法中，根据接收到不同的msg，执行相应的生命周期。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E    比如收到msg=H.LAUNCH_ACTIVITY，则调用ActivityThread.handleLaunchActivity()方法，最终会通过反射机制，创建Activity实例，然后再执行Activity.onCreate()等方法；\u003Cbr\u002F\u003E    再比如收到msg=H.PAUSE_ACTIVITY，则调用ActivityThread.handlePauseActivity()方法，最终会执行Activity.onPause()等方法。 上述过程，我只挑核心逻辑讲，真正该过程远比这复杂。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E主线程的消息又是哪来的呢？\u003C\u002Fb\u003E当然是App进程中的其他线程通过Handler发送给主线程，请看接下来的内容：\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E--------------------------------------------------------------------------------------------------------------------------------------\u003Cbr\u002F\u003E\u003Cb\u003E最后，从进程与线程间通信的角度，\u003C\u002Fb\u003E\u003Cb\u003E通过一张图\u003C\u002Fb\u003E\u003Cb\u003E加深大家对App运行过程的理解：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003Cfigure\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic4.zhimg.com\u002F50\u002F7fb8728164975ac86a2b0b886de2b872_hd.jpg\" data-rawwidth=\"890\" data-rawheight=\"535\" class=\"origin_image zh-lightbox-thumb\" width=\"890\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002F7fb8728164975ac86a2b0b886de2b872_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;890&#39; height=&#39;535&#39;&gt;&lt;\u002Fsvg&gt;\" data-rawwidth=\"890\" data-rawheight=\"535\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"890\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002F7fb8728164975ac86a2b0b886de2b872_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic4.zhimg.com\u002F50\u002F7fb8728164975ac86a2b0b886de2b872_hd.jpg\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cbr\u002F\u003E\u003Cb\u003Esystem_server进程是系统进程\u003C\u002Fb\u003E，java framework框架的核心载体，里面运行了大量的系统服务，比如这里提供ApplicationThreadProxy（简称ATP），ActivityManagerService（简称AMS），这个两个服务都运行在system_server进程的不同线程中，由于ATP和AMS都是基于IBinder接口，都是binder线程，binder线程的创建与销毁都是由binder驱动来决定的。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003EApp进程则是我们常说的应用程序\u003C\u002Fb\u003E，主线程主要负责Activity\u002FService等组件的生命周期以及UI相关操作都运行在这个线程； 另外，每个App进程中至少会有两个binder线程 ApplicationThread(简称AT)和ActivityManagerProxy（简称AMP），除了图中画的线程，其中还有很多线程，比如signal catcher线程等，这里就不一一列举。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003EBinder用于不同进程之间通信，由一个进程的Binder客户端向另一个进程的服务端发送事务，比如图中线程2向线程4发送事务；而handler用于同一个进程中不同线程的通信，比如图中线程4向主线程发送消息。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E结合图说说Activity生命周期，比如暂停Activity，流程如下：\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\u003Col\u003E\u003Cli\u003E线程1的AMS中调用线程2的ATP；（由于同一个进程的线程间资源共享，可以相互直接调用，但需要注意多线程并发问题）\u003Cbr\u002F\u003E\u003C\u002Fli\u003E\u003Cli\u003E线程2通过binder传输到App进程的线程4；\u003Cbr\u002F\u003E\u003C\u002Fli\u003E\u003Cli\u003E线程4通过handler消息机制，将暂停Activity的消息发送给主线程；\u003Cbr\u002F\u003E\u003C\u002Fli\u003E\u003Cli\u003E主线程在looper.loop()中循环遍历消息，当收到暂停Activity的消息时，便将消息分发给ActivityThread.H.handleMessage()方法，再经过方法的调用，最后便会调用到Activity.onPause()，当onPause()处理完后，继续循环loop下去。\u003Cbr\u002F\u003E\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E--------------------------------- \u003Cb\u003E欢迎关注我的微博：\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=http%3A\u002F\u002Fweibo.com\u002Fgityuan\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003EGityuan\u003C\u002Fa\u003E\u003C\u002Fb\u003E-----------------------------------------\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E\u003Cb\u003E如果大家觉得我回答得还行，还请大家随手 点赞、关注、收藏，如果觉得说得不好的，还往评论指正。\u003C\u002Fb\u003E","editableContent":"","excerpt":"要完全彻底理解这个问题，需要准备以下4方面的知识：Process\u002FThread，Android Binder IPC，Handler\u002FLooper\u002FMessageQueue消息机制，Linux pipe\u002Fepoll机制。 总结一下楼主主要有3个疑惑： 1.Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ 2.没看见哪里有相关代码为这个死循环准备了一个新线程去运转？ 3.Activity的生命周期这些方法这些都是在主线程里执行的吧，那这些生命周期方法是怎么实现在死循环体外能够执行…","collapsedBy":"nobody","collapseReason":"","annotationAction":null,"markInfos":[],"relevantInfo":{"isRelevant":false,"relevantType":"","relevantText":""},"suggestEdit":{"reason":"","status":false,"tip":"","title":"","unnormalDetails":{"status":"","description":"","reason":"","reasonId":0,"note":""},"url":""},"isLabeled":false,"rewardInfo":{"canOpenReward":false,"isRewardable":false,"rewardMemberCount":0,"rewardTotalMoney":0,"tagline":""},"relationship":{"isAuthor":false,"isAuthorized":false,"isNothelp":false,"isThanked":false,"isRecognized":false,"voting":0,"upvotedFollowees":[]}},"157834250":{"id":157834250,"type":"answer","answerType":"normal","question":{"type":"question","id":34652589,"title":"Android中为什么主线程不会因为Looper.loop()里的死循环卡死？","questionType":"normal","created":1439777878,"updatedTime":1439783968,"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fquestions\u002F34652589","relationship":{}},"author":{"id":"a68cd1d81f21f09a518ef4070501f892","urlToken":"yuxiang204","name":"镰仓","avatarUrl":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-44afe96a0432162b0a30697c93caf7d4_is.jpg","avatarUrlTemplate":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-44afe96a0432162b0a30697c93caf7d4_{size}.jpg","isOrg":false,"type":"people","url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fpeople\u002Fa68cd1d81f21f09a518ef4070501f892","userType":"people","headline":"Android Engineer at Alibaba","badge":[],"gender":1,"isAdvertiser":false,"followerCount":503,"isFollowed":false,"isPrivacy":false},"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fanswers\u002F157834250","isCollapsed":false,"createdTime":1492476653,"updatedTime":1492476653,"extras":"","isCopyable":true,"isNormal":true,"voteupCount":62,"commentCount":7,"isSticky":false,"adminClosedComment":false,"commentPermission":"all","canComment":{"reason":"","status":true},"reshipmentSettings":"allowed","content":"简单一句话是：Android应用程序的主线程在进入消息循环过程前，会在内部创建一个Linux管道（Pipe），这个管道的作用是使得Android应用程序主线程在消息队列为空时可以进入空闲等待状态，并且使得当应用程序的消息队列有消息需要处理时唤醒应用程序的主线程。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E---\u003Cbr\u002F\u003E这一题是需要从消息循环、消息发送和消息处理三个部分理解Android应用程序的消息处理机制了，这里我对一些要点作一个总结：\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E         A. Android应用程序的消息处理机制由消息循环、消息发送和消息处理三个部分组成的。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E         B. Android应用程序的主线程在进入消息循环过程前，会在内部创建一个Linux管道（Pipe），这个管道的作用是使得Android应用程序主线程在消息队列为空时可以进入空闲等待状态，并且使得当应用程序的消息队列有消息需要处理时唤醒应用程序的主线程。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E         C. Android应用程序的主线程进入空闲等待状态的方式实际上就是在管道的读端等待管道中有新的内容可读，具体来说就是是通过Linux系统的Epoll机制中的epoll_wait函数进行的。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E         D. 当往Android应用程序的消息队列中加入新的消息时，会同时往管道中的写端写入内容，通过这种方式就可以唤醒正在等待消息到来的应用程序主线程。\u003Cbr\u002F\u003E\u003Cbr\u002F\u003E         E. 当应用程序主线程在进入空闲等待前，会认为当前线程处理空闲状态，于是就会调用那些已经注册了的IdleHandler接口，使得应用程序有机会在空闲的时候处理一些事情。","editableContent":"","excerpt":"简单一句话是：Android应用程序的主线程在进入消息循环过程前，会在内部创建一个Linux管道（Pipe），这个管道的作用是使得Android应用程序主线程在消息队列为空时可以进入空闲等待状态，并且使得当应用程序的消息队列有消息需要处理时唤醒应用程序的主线程。 --- 这一题是需要从消息循环、消息发送和消息处理三个部分理解Android应用程序的消息处理机制了，这里我对一些要点作一个总结： A. Android应用程序的消息处理机制由消息…","collapsedBy":"nobody","collapseReason":"","annotationAction":null,"markInfos":[],"relevantInfo":{"isRelevant":false,"relevantType":"","relevantText":""},"suggestEdit":{"reason":"","status":false,"tip":"","title":"","unnormalDetails":{"status":"","description":"","reason":"","reasonId":0,"note":""},"url":""},"isLabeled":false,"rewardInfo":{"canOpenReward":false,"isRewardable":false,"rewardMemberCount":0,"rewardTotalMoney":0,"tagline":""},"relationship":{"isAuthor":false,"isAuthorized":false,"isNothelp":false,"isThanked":false,"isRecognized":false,"voting":0,"upvotedFollowees":[]}}},"articles":{},"columns":{},"topics":{},"roundtables":{},"favlists":{},"comments":{},"notifications":{},"ebooks":{},"activities":{},"feeds":{},"pins":{},"promotions":{},"drafts":{},"chats":{}},"currentUser":"70072e0861e805e9b03b75f000efb9c3","account":{"lockLevel":{},"unlockTicketStatus":false,"unlockTicket":null,"challenge":[],"errorStatus":false,"message":"","isFetching":false,"accountInfo":{},"urlToken":{"loading":false}},"settings":{"socialBind":null,"inboxMsg":null,"notification":{},"email":{},"privacyFlag":null,"blockedUsers":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"blockedFollowees":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"ignoredTopics":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"restrictedTopics":null,"laboratory":{}},"notification":{},"people":{"profileStatus":{},"activitiesByUser":{},"answersByUser":{},"answersSortByVotesByUser":{},"answersIncludedByUser":{},"votedAnswersByUser":{},"thankedAnswersByUser":{},"voteAnswersByUser":{},"thankAnswersByUser":{},"topicAnswersByUser":{},"articlesByUser":{},"articlesSortByVotesByUser":{},"articlesIncludedByUser":{},"pinsByUser":{},"questionsByUser":{},"commercialQuestionsByUser":{},"favlistsByUser":{},"followingByUser":{},"followersByUser":{},"mutualsByUser":{},"followingColumnsByUser":{},"followingQuestionsByUser":{},"followingFavlistsByUser":{},"followingTopicsByUser":{},"publicationsByUser":{},"columnsByUser":{},"allFavlistsByUser":{},"brands":null,"creationsByUser":{},"creationsSortByVotesByUser":{}},"env":{"ab":{"config":{"experiments":[{"expId":"launch-gw_ydyq-2","expPrefix":"gw_ydyq","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-li_ebook_detail-2","expPrefix":"li_ebook_detail","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-nw_zhuantigaiban-2","expPrefix":"nw_zhuantigaiban","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-qa_answer_update-2","expPrefix":"qa_answer_update","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-rec_book_chapter-4","expPrefix":"rec_book_chapter","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-rec_es_update-3","expPrefix":"rec_es_update","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-se_ios_spb309-5","expPrefix":"se_ios_spb309","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-se_ir-2","expPrefix":"se_ir","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-se_payconsult-3","expPrefix":"se_payconsult","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-se_subtext-2","expPrefix":"se_subtext","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-se_webtimebox-2","expPrefix":"se_webtimebox","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-se_whitelist-2","expPrefix":"se_whitelist","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-top_hotchild-2","expPrefix":"top_hotchild","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-tp_and_sticky-2","expPrefix":"tp_and_sticky","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-us_bigone-10","expPrefix":"us_bigone","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-us_foltopic_user-10","expPrefix":"us_foltopic_user","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-us_newguide3-11","expPrefix":"us_newguide3","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"launch-us_n_web_msg-5","expPrefix":"us_n_web_msg","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"nw_zhuantikapian-1","expPrefix":"nw_zhuantikapian","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"li_qa_new_cover-8","expPrefix":"li_qa_new_cover","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"li_hot_score_ab-7","expPrefix":"li_hot_score_ab","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"li_price_test-2","expPrefix":"li_price_test","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"se_ltr_v012-3","expPrefix":"se_ltr_v012","isDynamicallyUpdated":false,"isRuntime":false,"includeTriggerInfo":false},{"expId":"se_zu_onebox-2","expPrefix":"se_zu_onebox","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"se_backsearch-2","expPrefix":"se_backsearch","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"us_bignew-10","expPrefix":"us_bignew","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"us_update-10","expPrefix":"us_update","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"top_native_ans-1","expPrefix":"top_native_ans","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"top_recall_expr-1","expPrefix":"top_recall_expr","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"top_vipconsume-8","expPrefix":"top_vipconsume","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"top_hotcommerce-5","expPrefix":"top_hotcommerce","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"top_gr_ab_exp-10","expPrefix":"top_gr_ab_exp","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"top_recall_v2-3","expPrefix":"top_recall_v2","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"top_hotctr-8","expPrefix":"top_hotctr","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false},{"expId":"rec_km_xgb_model-26","expPrefix":"rec_km_xgb_model","isDynamicallyUpdated":true,"isRuntime":false,"includeTriggerInfo":false}],"params":[{"id":"gue_anonymous","type":"String","value":"show"},{"id":"se_payconsult","type":"String","value":"5","chainId":"_all_"},{"id":"soc_bigone","type":"String","value":"1","chainId":"_all_"},{"id":"top_recall_exp_v2","type":"String","value":"3","chainId":"_all_"},{"id":"zr_ans_rec","type":"String","value":"gbrank","chainId":"_all_"},{"id":"li_price_test","type":"String","value":"2","chainId":"_all_"},{"id":"se_colorfultab","type":"String","value":"1","chainId":"_all_"},{"id":"se_expired_ob","type":"String","value":"0","chainId":"_all_"},{"id":"se_likebutton","type":"String","value":"0","chainId":"_all_"},{"id":"se_wannasearch","type":"String","value":"0","chainId":"_all_"},{"id":"soc_update","type":"String","value":"0","chainId":"_all_"},{"id":"zr_km_slot_style","type":"String","value":"event_card","chainId":"_all_"},{"id":"soc_special","type":"String","value":"0","chainId":"_all_"},{"id":"top_reason","type":"String","value":"1","chainId":"_all_"},{"id":"tp_meta_card","type":"String","value":"0","chainId":"_all_"},{"id":"tp_m_intro_re_topic","type":"String","value":"1","chainId":"_all_"},{"id":"se_ltr_v012","type":"String","value":"1","chainId":"_all_"},{"id":"se_rr","type":"String","value":"1","chainId":"_all_"},{"id":"se_topicdirect","type":"String","value":"2","chainId":"_all_"},{"id":"se_webmajorob","type":"String","value":"0","chainId":"_all_"},{"id":"web_answer_list_ad","type":"String","value":"1"},{"id":"se_terminate","type":"String","value":"0","chainId":"_all_"},{"id":"tp_qa_metacard_top","type":"String","value":"top","chainId":"_all_"},{"id":"ug_zero_follow_0","type":"String","value":"0","chainId":"_all_"},{"id":"se_topiclabel","type":"String","value":"0","chainId":"_all_"},{"id":"tsp_hotctr","type":"String","value":"1","chainId":"_all_"},{"id":"zr_answer_rec_cp","type":"String","value":"close","chainId":"_all_"},{"id":"zr_art_rec","type":"String","value":"base","chainId":"_all_"},{"id":"li_album3_ab","type":"String","value":"0","chainId":"_all_"},{"id":"li_android_vip","type":"String","value":"0","chainId":"_all_"},{"id":"se_college_cm","type":"String","value":"0","chainId":"_all_"},{"id":"se_mobileweb","type":"String","value":"1","chainId":"_all_"},{"id":"zr_ebook_chapter","type":"String","value":"1","chainId":"_all_"},{"id":"li_album_liutongab","type":"String","value":"0","chainId":"_all_"},{"id":"ug_newtag","type":"String","value":"1","chainId":"_all_"},{"id":"zr_es_update","type":"String","value":"1","chainId":"_all_"},{"id":"tsp_childbillboard","type":"String","value":"2","chainId":"_all_"},{"id":"zr_video_rank","type":"String","value":"new_rank","chainId":"_all_"},{"id":"li_qa_new_cover","type":"String","value":"0","chainId":"_all_"},{"id":"pf_creator_card","type":"String","value":"1","chainId":"_all_"},{"id":"top_native_answer","type":"String","value":"1","chainId":"_all_"},{"id":"top_vipconsume","type":"String","value":"3","chainId":"_all_"},{"id":"gue_zhuantikapian","type":"String","value":"0"},{"id":"se_ad_index","type":"String","value":"10","chainId":"_all_"},{"id":"pf_fuceng","type":"String","value":"1","chainId":"_all_"},{"id":"se_limit","type":"String","value":"0","chainId":"_all_"},{"id":"tsp_lastread","type":"String","value":"0","chainId":"_all_"},{"id":"top_root","type":"String","value":"0","chainId":"_all_"},{"id":"se_billboardsearch","type":"String","value":"1","chainId":"_all_"},{"id":"se_ios_spb309","type":"String","value":"1","chainId":"_all_"},{"id":"se_spb309","type":"String","value":"0","chainId":"_all_"},{"id":"se_webtimebox","type":"String","value":"1","chainId":"_all_"},{"id":"tp_header_style","type":"String","value":"1","chainId":"_all_"},{"id":"pf_noti_entry_num","type":"String","value":"0","chainId":"_all_"},{"id":"se_ltr_v002","type":"String","value":"1","chainId":"_all_"},{"id":"se_websearch","type":"String","value":"3","chainId":"_all_"},{"id":"se_zu_onebox","type":"String","value":"3","chainId":"_all_"},{"id":"zr_km_xgb_model","type":"String","value":"new_xgb_4_6","chainId":"_all_"},{"id":"ls_new_upload","type":"String","value":"0","chainId":"_all_"},{"id":"se_search_feed","type":"String","value":"N","chainId":"_all_"},{"id":"se_topic_express","type":"String","value":"0","chainId":"_all_"},{"id":"zr_infinity_a_u","type":"String","value":"close","chainId":"_all_"},{"id":"web_answer_update","type":"String","value":"1"},{"id":"web_question_invite","type":"String","value":"B"},{"id":"zr_km_style","type":"String","value":"base","chainId":"_all_"},{"id":"pf_feed","type":"String","value":"1","chainId":"_all_"},{"id":"se_famous","type":"String","value":"1","chainId":"_all_"},{"id":"top_rank","type":"String","value":"0","chainId":"_all_"},{"id":"ug_follow_answerer_0","type":"String","value":"0","chainId":"_all_"},{"id":"ug_follow_answerer","type":"String","value":"0","chainId":"_all_"},{"id":"web_column_auto_invite","type":"String","value":"0"},{"id":"zr_video_recall","type":"String","value":"current_recall","chainId":"_all_"},{"id":"li_hot_score_ab","type":"String","value":"0","chainId":"_all_"},{"id":"se_webrs","type":"String","value":"1","chainId":"_all_"},{"id":"top_hotcommerce","type":"String","value":"5","chainId":"_all_"},{"id":"zr_rel_search","type":"String","value":"base","chainId":"_all_"},{"id":"zr_article_rec_rank","type":"String","value":"close","chainId":"_all_"},{"id":"ls_videoad","type":"String","value":"0","chainId":"_all_"},{"id":"se_amovietab","type":"String","value":"1","chainId":"_all_"},{"id":"se_auto_syn","type":"String","value":"0","chainId":"_all_"},{"id":"web_heifetz_grow_ad","type":"String","value":"1"},{"id":"top_v_album","type":"String","value":"1","chainId":"_all_"},{"id":"tp_qa_toast","type":"String","value":"1","chainId":"_all_"},{"id":"gue_new_special_page","type":"String","value":"1"},{"id":"top_ebook","type":"String","value":"0","chainId":"_all_"},{"id":"top_recall_exp_v1","type":"String","value":"1","chainId":"_all_"},{"id":"top_universalebook","type":"String","value":"1","chainId":"_all_"},{"id":"ls_fmp4","type":"String","value":"0","chainId":"_all_"},{"id":"se_lottery","type":"String","value":"0","chainId":"_all_"},{"id":"se_p_slideshow","type":"String","value":"0","chainId":"_all_"},{"id":"tp_qa_metacard","type":"String","value":"1","chainId":"_all_"},{"id":"se_page_limit_20","type":"String","value":"1","chainId":"_all_"},{"id":"se_subtext","type":"String","value":"1","chainId":"_all_"},{"id":"web_sem_ab","type":"String","value":"0"},{"id":"li_qa_cover","type":"String","value":"old","chainId":"_all_"},{"id":"se_agency","type":"String","value":" 0","chainId":"_all_"},{"id":"se_go_ztext","type":"String","value":"0","chainId":"_all_"},{"id":"ug_follow_topic_1","type":"String","value":"2","chainId":"_all_"},{"id":"se_backsearch","type":"String","value":"1","chainId":"_all_"},{"id":"se_new_topic","type":"String","value":"0","chainId":"_all_"},{"id":"se_close_span","type":"String","value":"0","chainId":"_all_"},{"id":"se_movietab","type":"String","value":"1","chainId":"_all_"},{"id":"top_recall_deep_user","type":"String","value":"1","chainId":"_all_"},{"id":"web_wx_block","type":"String","value":"2"},{"id":"se_featured","type":"String","value":"1","chainId":"_all_"},{"id":"tp_sticky_android","type":"String","value":"2","chainId":"_all_"},{"id":"ug_goodcomment_0","type":"String","value":"1","chainId":"_all_"},{"id":"pf_foltopic_usernum","type":"String","value":"50","chainId":"_all_"},{"id":"soc_bignew","type":"String","value":"1","chainId":"_all_"},{"id":"tp_sft_v2","type":"String","value":"d","chainId":"_all_"},{"id":"web_n_web_msg","type":"String","value":"1"},{"id":"se_title_only","type":"String","value":"0","chainId":"_all_"},{"id":"ug_fw_answ_aut_1","type":"String","value":"0","chainId":"_all_"},{"id":"zr_search_xgb","type":"String","value":"0","chainId":"_all_"},{"id":"pf_newguide_vertical","type":"String","value":"0","chainId":"_all_"},{"id":"se_preset_tech","type":"String","value":"0","chainId":"_all_"},{"id":"se_site_onebox","type":"String","value":"0","chainId":"_all_"},{"id":"se_time_threshold","type":"String","value":"0","chainId":"_all_"},{"id":"top_test_4_liguangyi","type":"String","value":"1","chainId":"_all_"},{"id":"li_ebook_detail","type":"String","value":"2","chainId":"_all_"},{"id":"qa_answerlist_ad","type":"String","value":"0","chainId":"_all_"},{"id":"se_waterfall","type":"String","value":"0","chainId":"_all_"},{"id":"top_gr_ab","type":"String","value":"2","chainId":"_all_"},{"id":"se_whitelist","type":"String","value":"1","chainId":"_all_"},{"id":"tp_sft","type":"String","value":"a","chainId":"_all_"},{"id":"zr_video_rank_nn","type":"String","value":"current_rank","chainId":"_all_"},{"id":"se_ri","type":"String","value":"0","chainId":"_all_"},{"id":"se_zu_recommend","type":"String","value":"0","chainId":"_all_"},{"id":"top_new_feed","type":"String","value":"5","chainId":"_all_"},{"id":"top_ydyq","type":"String","value":"A","chainId":"_all_"},{"id":"qa_test","type":"String","value":"0","chainId":"_all_"},{"id":"top_quality","type":"String","value":"0","chainId":"_all_"},{"id":"web_answerlist_ad","type":"String","value":"0"},{"id":"zr_km_answer","type":"String","value":"open_cvr","chainId":"_all_"},{"id":"ug_zero_follow","type":"String","value":"0","chainId":"_all_"},{"id":"li_se_album_card","type":"String","value":"0","chainId":"_all_"},{"id":"li_tjys_ec_ab","type":"String","value":"0","chainId":"_all_"},{"id":"li_ts_sample","type":"String","value":"old","chainId":"_all_"},{"id":"se_college","type":"String","value":"default","chainId":"_all_"}],"chains":[{"chainId":"_all_"}]},"triggers":{}},"userAgent":{"Edge":false,"Wechat":false,"Weibo":false,"QQ":false,"MQQBrowser":false,"Qzone":false,"Mobile":false,"Android":false,"iOS":false,"isAppleDevice":false,"Zhihu":false,"ZhihuHybrid":false,"isBot":false,"Tablet":false,"UC":false,"Sogou":false,"Qihoo":false,"Baidu":false,"BaiduApp":false,"Safari":false,"GoogleBot":false,"isWebView":false,"origin":"Mozilla\u002F5.0 (Windows NT 6.1; WOW64) AppleWebKit\u002F537.36 (KHTML, like Gecko) Chrome\u002F65.0.3325.181 Safari\u002F537.36"},"ctx":{"path":"\u002Fquestion\u002F34652589"},"trafficSource":"production","edition":{"baidu":false,"sogou":false,"baiduBeijing":false,"sogouBeijing":false},"theme":"light","enableShortcut":true,"referer":"https:\u002F\u002Fwww.zhihu.com\u002Fquestion\u002F34652589","conf":{},"ipInfo":{},"logged":true,"tdkInfo":{}},"me":{"accountInfoLoadStatus":{},"organizationProfileStatus":{},"columnContributions":[]},"label":{"recognizerLists":{}},"ecommerce":{},"comments":{"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"parent":{}},"commentsV2":{"stickers":[],"commentWithPicPermission":{},"notificationsComments":{},"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"conversationMore":{},"parent":{}},"pushNotifications":{"default":{"isFetching":false,"isDrained":false,"ids":[]},"follow":{"isFetching":false,"isDrained":false,"ids":[]},"vote_thank":{"isFetching":false,"isDrained":false,"ids":[]},"currentTab":"default","notificationsCount":{"default":0,"follow":0,"vote_thank":0}},"messages":{"data":{},"currentTab":"common","messageCount":0},"register":{"registerValidateSucceeded":null,"registerValidateErrors":{},"registerConfirmError":null,"sendDigitsError":null,"registerConfirmSucceeded":null},"login":{"loginUnregisteredError":false,"loginBindWechatError":false,"loginConfirmError":null,"sendDigitsError":null,"validateDigitsError":false,"loginConfirmSucceeded":null,"qrcodeLoginToken":"","qrcodeLoginScanStatus":0,"qrcodeLoginError":null,"qrcodeLoginReturnNewToken":false},"active":{"sendDigitsError":null,"activeConfirmSucceeded":null,"activeConfirmError":null},"switches":{},"captcha":{"captchaNeeded":false,"captchaValidated":false,"captchaBase64String":null,"captchaValidationMessage":null,"loginCaptchaExpires":false},"sms":{"supportedCountries":[]},"chat":{"chats":{},"inbox":{"recents":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"strangers":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"friends":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"search":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"config":{"newCount":0,"strangerMessageSwitch":false,"strangerMessageUnread":false,"friendCount":0}},"global":{"isChatMqttExisted":false}},"emoticons":{"emoticonGroupList":[],"emoticonGroupDetail":{}},"question":{"followers":{},"concernedFollowers":{},"answers":{"34652589":{"isFetching":false,"isDrained":false,"ids":[90344494,157834250,59571257,59578531,59614987],"newIds":[90344494,157834250,59571257,59578531,59614987],"totals":45,"isPrevDrained":true,"previous":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fquestions\u002F34652589\u002Fanswers?include=data%5B%2A%5D.is_normal%2Cadmin_closed_comment%2Creward_info%2Cis_collapsed%2Cannotation_action%2Cannotation_detail%2Ccollapse_reason%2Cis_sticky%2Ccollapsed_by%2Csuggest_edit%2Ccomment_count%2Ccan_comment%2Ccontent%2Ceditable_content%2Cvoteup_count%2Creshipment_settings%2Ccomment_permission%2Ccreated_time%2Cupdated_time%2Creview_info%2Crelevant_info%2Cquestion%2Cexcerpt%2Crelationship.is_authorized%2Cis_author%2Cvoting%2Cis_thanked%2Cis_nothelp%2Cis_labeled%2Cis_recognized%2Cpaid_info%2Cpaid_info_content%3Bdata%5B%2A%5D.mark_infos%5B%2A%5D.url%3Bdata%5B%2A%5D.author.follower_count%2Cbadge%5B%2A%5D.topics&limit=5&offset=0&platform=desktop&sort_by=default","next":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Fquestions\u002F34652589\u002Fanswers?include=data%5B%2A%5D.is_normal%2Cadmin_closed_comment%2Creward_info%2Cis_collapsed%2Cannotation_action%2Cannotation_detail%2Ccollapse_reason%2Cis_sticky%2Ccollapsed_by%2Csuggest_edit%2Ccomment_count%2Ccan_comment%2Ccontent%2Ceditable_content%2Cvoteup_count%2Creshipment_settings%2Ccomment_permission%2Ccreated_time%2Cupdated_time%2Creview_info%2Crelevant_info%2Cquestion%2Cexcerpt%2Crelationship.is_authorized%2Cis_author%2Cvoting%2Cis_thanked%2Cis_nothelp%2Cis_labeled%2Cis_recognized%2Cpaid_info%2Cpaid_info_content%3Bdata%5B%2A%5D.mark_infos%5B%2A%5D.url%3Bdata%5B%2A%5D.author.follower_count%2Cbadge%5B%2A%5D.topics&limit=5&offset=5&platform=desktop&sort_by=default"}},"hiddenAnswers":{},"updatedAnswers":{},"collapsedAnswers":{},"notificationAnswers":{},"invitedQuestions":{"total":{"count":null,"isEnd":false,"isLoading":false,"questions":[]},"followees":{"count":null,"isEnd":false,"isLoading":false,"questions":[]}},"laterQuestions":{"count":null,"globalWriteAnimate":false,"isEnd":false,"isLoading":false,"questions":[]},"waitingQuestions":{"hot":{"isEnd":false,"isLoading":false,"questions":[]},"value":{"isEnd":false,"isLoading":false,"questions":[]},"newest":{"isEnd":false,"isLoading":false,"questions":[]},"easy":{"isEnd":false,"isLoading":false,"questions":[]}},"invitationCandidates":{},"inviters":{},"invitees":{},"similarQuestions":{},"relatedCommodities":{},"recommendReadings":{},"bio":{},"brand":{},"permission":{},"adverts":{},"advancedStyle":{},"commonAnswerCount":0,"hiddenAnswerCount":0,"meta":{},"autoInvitation":{},"simpleConcernedFollowers":{},"draftStatus":{},"disclaimers":{}},"shareTexts":{},"answers":{"voters":{},"copyrightApplicants":{},"favlists":{},"newAnswer":{},"concernedUpvoters":{},"simpleConcernedUpvoters":{},"paidContent":{},"settings":{}},"banner":{},"topic":{"bios":{},"hot":{},"newest":{},"top":{},"unanswered":{},"questions":{},"followers":{},"contributors":{},"parent":{},"children":{},"bestAnswerers":{},"wikiMeta":{},"index":{},"intro":{},"meta":{},"schema":{},"creatorWall":{},"wikiEditInfo":{},"committedWiki":{}},"explore":{"recommendations":{}},"articles":{"voters":{}},"favlists":{"relations":{}},"pins":{"voters":{}},"topstory":{"recommend":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"follow":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followWonderful":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"sidebar":null,"announcement":{},"hotListCategories":[],"hotList":[],"guestFeeds":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followExtra":{"isNewUser":null,"isFetched":false,"followCount":0,"followers":[]}},"upload":{},"video":{"data":{},"shareVideoDetail":{},"last":{}},"guide":{"guide":{"isFetching":false,"isShowGuide":false}},"reward":{"answer":{},"article":{},"question":{}},"search":{"recommendSearch":[],"topSearch":{},"searchValue":{},"suggestSearch":{},"attachedInfo":{},"nextOffset":{},"topicReview":{},"generalByQuery":{},"generalByQueryInADay":{},"generalByQueryInAWeek":{},"generalByQueryInThreeMonths":{},"peopleByQuery":{},"topicByQuery":{},"columnByQuery":{},"liveByQuery":{},"albumByQuery":{},"eBookByQuery":{}},"creator":{"currentCreatorUrlToken":null,"homeData":{"recommendQuestions":[]},"tools":{"question":{"invitationCount":{"questionFolloweeCount":0,"questionTotalCount":0},"goodatTopics":[]},"customPromotion":{"itemLists":{}},"recommend":{"recommendTimes":{}}},"explore":{"academy":{"tabs":[],"article":{}}},"rights":[],"rightsStatus":{},"levelUpperLimit":10,"account":{"growthLevel":{}}},"publicEditPermission":{},"readStatus":{},"draftHistory":{"history":{},"drafts":{}},"notifications":{"recent":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"history":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"notificationActors":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"recentNotificationEntry":"all"}},"subAppName":"main"}</script><script src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/vendor.a5c7906fc2334e5c2ad2.js.下载"></script><script src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/main.app.d95ecc660fbee5fd5b11.js.下载"></script><script src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/main.question-routes.e5cedb3074c942953b18.js.下载"></script><script src="./(1 封私信) Android中为什么主线程不会因为Looper.loop()里的死循环卡死？ - 知乎_files/zap.js.下载"></script><div><div style="display: none;">想来知乎工作？请发送邮件到 jobs@zhihu.com</div></div><div><div><div></div></div></div><div><div><div></div></div></div><div><div><div></div></div></div><div><div><div></div></div></div><div><div><div></div></div></div></body></html>